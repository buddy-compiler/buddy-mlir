#map = affine_map<(d0, d1, d2) -> (d0, d1, d2)>
#map1 = affine_map<(d0, d1, d2, d3) -> (d0, d1, d2, d3)>
module {
  func.func @subgraph0_decode(%arg0: tensor<151936x1536xf32>, %arg1: tensor<1x1xi64>, %arg2: tensor<1xi64>, %arg3: tensor<1xi64>, %arg4: tensor<64xf32>, %arg5: tensor<1536xf32>, %arg6: tensor<1536xf32>, %arg7: tensor<1536x1536xf32>, %arg8: tensor<256xf32>, %arg9: tensor<1536x256xf32>, %arg10: tensor<256xf32>, %arg11: tensor<1536x256xf32>, %arg12: tensor<1x2x1024x128xf32>, %arg13: tensor<1x2x1024x128xf32>, %arg14: tensor<1536x1536xf32>, %arg15: tensor<1536xf32>, %arg16: tensor<1536x8960xf32>, %arg17: tensor<1536x8960xf32>, %arg18: tensor<8960x1536xf32>, %arg19: tensor<1536xf32>, %arg20: tensor<1536xf32>, %arg21: tensor<1536x1536xf32>, %arg22: tensor<256xf32>, %arg23: tensor<1536x256xf32>, %arg24: tensor<256xf32>, %arg25: tensor<1536x256xf32>, %arg26: tensor<1x2x1024x128xf32>, %arg27: tensor<1x2x1024x128xf32>, %arg28: tensor<1536x1536xf32>, %arg29: tensor<1536xf32>, %arg30: tensor<1536x8960xf32>, %arg31: tensor<1536x8960xf32>, %arg32: tensor<8960x1536xf32>, %arg33: tensor<1536xf32>, %arg34: tensor<1536xf32>, %arg35: tensor<1536x1536xf32>, %arg36: tensor<256xf32>, %arg37: tensor<1536x256xf32>, %arg38: tensor<256xf32>, %arg39: tensor<1536x256xf32>, %arg40: tensor<1x2x1024x128xf32>, %arg41: tensor<1x2x1024x128xf32>, %arg42: tensor<1536x1536xf32>, %arg43: tensor<1536xf32>, %arg44: tensor<1536x8960xf32>, %arg45: tensor<1536x8960xf32>, %arg46: tensor<8960x1536xf32>, %arg47: tensor<1536xf32>, %arg48: tensor<1536xf32>, %arg49: tensor<1536x1536xf32>, %arg50: tensor<256xf32>, %arg51: tensor<1536x256xf32>, %arg52: tensor<256xf32>, %arg53: tensor<1536x256xf32>, %arg54: tensor<1x2x1024x128xf32>, %arg55: tensor<1x2x1024x128xf32>, %arg56: tensor<1536x1536xf32>, %arg57: tensor<1536xf32>, %arg58: tensor<1536x8960xf32>, %arg59: tensor<1536x8960xf32>, %arg60: tensor<8960x1536xf32>, %arg61: tensor<1536xf32>, %arg62: tensor<1536xf32>, %arg63: tensor<1536x1536xf32>, %arg64: tensor<256xf32>, %arg65: tensor<1536x256xf32>, %arg66: tensor<256xf32>, %arg67: tensor<1536x256xf32>, %arg68: tensor<1x2x1024x128xf32>, %arg69: tensor<1x2x1024x128xf32>, %arg70: tensor<1536x1536xf32>, %arg71: tensor<1536xf32>, %arg72: tensor<1536x8960xf32>, %arg73: tensor<1536x8960xf32>, %arg74: tensor<8960x1536xf32>, %arg75: tensor<1536xf32>, %arg76: tensor<1536xf32>, %arg77: tensor<1536x1536xf32>, %arg78: tensor<256xf32>, %arg79: tensor<1536x256xf32>, %arg80: tensor<256xf32>, %arg81: tensor<1536x256xf32>, %arg82: tensor<1x2x1024x128xf32>, %arg83: tensor<1x2x1024x128xf32>, %arg84: tensor<1536x1536xf32>, %arg85: tensor<1536xf32>, %arg86: tensor<1536x8960xf32>, %arg87: tensor<1536x8960xf32>, %arg88: tensor<8960x1536xf32>, %arg89: tensor<1536xf32>, %arg90: tensor<1536xf32>, %arg91: tensor<1536x1536xf32>, %arg92: tensor<256xf32>, %arg93: tensor<1536x256xf32>, %arg94: tensor<256xf32>, %arg95: tensor<1536x256xf32>, %arg96: tensor<1x2x1024x128xf32>, %arg97: tensor<1x2x1024x128xf32>, %arg98: tensor<1536x1536xf32>, %arg99: tensor<1536xf32>, %arg100: tensor<1536x8960xf32>, %arg101: tensor<1536x8960xf32>, %arg102: tensor<8960x1536xf32>, %arg103: tensor<1536xf32>, %arg104: tensor<1536xf32>, %arg105: tensor<1536x1536xf32>, %arg106: tensor<256xf32>, %arg107: tensor<1536x256xf32>, %arg108: tensor<256xf32>, %arg109: tensor<1536x256xf32>, %arg110: tensor<1x2x1024x128xf32>, %arg111: tensor<1x2x1024x128xf32>, %arg112: tensor<1536x1536xf32>, %arg113: tensor<1536xf32>, %arg114: tensor<1536x8960xf32>, %arg115: tensor<1536x8960xf32>, %arg116: tensor<8960x1536xf32>, %arg117: tensor<1536xf32>, %arg118: tensor<1536xf32>, %arg119: tensor<1536x1536xf32>, %arg120: tensor<256xf32>, %arg121: tensor<1536x256xf32>, %arg122: tensor<256xf32>, %arg123: tensor<1536x256xf32>, %arg124: tensor<1x2x1024x128xf32>, %arg125: tensor<1x2x1024x128xf32>, %arg126: tensor<1536x1536xf32>, %arg127: tensor<1536xf32>, %arg128: tensor<1536x8960xf32>, %arg129: tensor<1536x8960xf32>, %arg130: tensor<8960x1536xf32>, %arg131: tensor<1536xf32>, %arg132: tensor<1536xf32>, %arg133: tensor<1536x1536xf32>, %arg134: tensor<256xf32>, %arg135: tensor<1536x256xf32>, %arg136: tensor<256xf32>, %arg137: tensor<1536x256xf32>, %arg138: tensor<1x2x1024x128xf32>, %arg139: tensor<1x2x1024x128xf32>, %arg140: tensor<1536x1536xf32>, %arg141: tensor<1536xf32>, %arg142: tensor<1536x8960xf32>, %arg143: tensor<1536x8960xf32>, %arg144: tensor<8960x1536xf32>, %arg145: tensor<1536xf32>, %arg146: tensor<1536xf32>, %arg147: tensor<1536x1536xf32>, %arg148: tensor<256xf32>, %arg149: tensor<1536x256xf32>, %arg150: tensor<256xf32>, %arg151: tensor<1536x256xf32>, %arg152: tensor<1x2x1024x128xf32>, %arg153: tensor<1x2x1024x128xf32>, %arg154: tensor<1536x1536xf32>, %arg155: tensor<1536xf32>, %arg156: tensor<1536x8960xf32>, %arg157: tensor<1536x8960xf32>, %arg158: tensor<8960x1536xf32>, %arg159: tensor<1536xf32>, %arg160: tensor<1536xf32>, %arg161: tensor<1536x1536xf32>, %arg162: tensor<256xf32>, %arg163: tensor<1536x256xf32>, %arg164: tensor<256xf32>, %arg165: tensor<1536x256xf32>, %arg166: tensor<1x2x1024x128xf32>, %arg167: tensor<1x2x1024x128xf32>, %arg168: tensor<1536x1536xf32>, %arg169: tensor<1536xf32>, %arg170: tensor<1536x8960xf32>, %arg171: tensor<1536x8960xf32>, %arg172: tensor<8960x1536xf32>, %arg173: tensor<1536xf32>, %arg174: tensor<1536xf32>, %arg175: tensor<1536x1536xf32>, %arg176: tensor<256xf32>, %arg177: tensor<1536x256xf32>, %arg178: tensor<256xf32>, %arg179: tensor<1536x256xf32>, %arg180: tensor<1x2x1024x128xf32>, %arg181: tensor<1x2x1024x128xf32>, %arg182: tensor<1536x1536xf32>, %arg183: tensor<1536xf32>, %arg184: tensor<1536x8960xf32>, %arg185: tensor<1536x8960xf32>, %arg186: tensor<8960x1536xf32>, %arg187: tensor<1536xf32>, %arg188: tensor<1536xf32>, %arg189: tensor<1536x1536xf32>, %arg190: tensor<256xf32>, %arg191: tensor<1536x256xf32>, %arg192: tensor<256xf32>, %arg193: tensor<1536x256xf32>, %arg194: tensor<1x2x1024x128xf32>, %arg195: tensor<1x2x1024x128xf32>, %arg196: tensor<1536x1536xf32>, %arg197: tensor<1536xf32>, %arg198: tensor<1536x8960xf32>, %arg199: tensor<1536x8960xf32>, %arg200: tensor<8960x1536xf32>, %arg201: tensor<1536xf32>, %arg202: tensor<1536xf32>, %arg203: tensor<1536x1536xf32>, %arg204: tensor<256xf32>, %arg205: tensor<1536x256xf32>, %arg206: tensor<256xf32>, %arg207: tensor<1536x256xf32>, %arg208: tensor<1x2x1024x128xf32>, %arg209: tensor<1x2x1024x128xf32>, %arg210: tensor<1536x1536xf32>, %arg211: tensor<1536xf32>, %arg212: tensor<1536x8960xf32>, %arg213: tensor<1536x8960xf32>, %arg214: tensor<8960x1536xf32>, %arg215: tensor<1536xf32>, %arg216: tensor<1536xf32>, %arg217: tensor<1536x1536xf32>, %arg218: tensor<256xf32>, %arg219: tensor<1536x256xf32>, %arg220: tensor<256xf32>, %arg221: tensor<1536x256xf32>, %arg222: tensor<1x2x1024x128xf32>, %arg223: tensor<1x2x1024x128xf32>, %arg224: tensor<1536x1536xf32>, %arg225: tensor<1536xf32>, %arg226: tensor<1536x8960xf32>, %arg227: tensor<1536x8960xf32>, %arg228: tensor<8960x1536xf32>, %arg229: tensor<1536xf32>, %arg230: tensor<1536xf32>, %arg231: tensor<1536x1536xf32>, %arg232: tensor<256xf32>, %arg233: tensor<1536x256xf32>, %arg234: tensor<256xf32>, %arg235: tensor<1536x256xf32>, %arg236: tensor<1x2x1024x128xf32>, %arg237: tensor<1x2x1024x128xf32>, %arg238: tensor<1536x1536xf32>, %arg239: tensor<1536xf32>, %arg240: tensor<1536x8960xf32>, %arg241: tensor<1536x8960xf32>, %arg242: tensor<8960x1536xf32>, %arg243: tensor<1536xf32>, %arg244: tensor<1536xf32>, %arg245: tensor<1536x1536xf32>, %arg246: tensor<256xf32>, %arg247: tensor<1536x256xf32>, %arg248: tensor<256xf32>, %arg249: tensor<1536x256xf32>, %arg250: tensor<1x2x1024x128xf32>, %arg251: tensor<1x2x1024x128xf32>, %arg252: tensor<1536x1536xf32>, %arg253: tensor<1536xf32>, %arg254: tensor<1536x8960xf32>, %arg255: tensor<1536x8960xf32>, %arg256: tensor<8960x1536xf32>, %arg257: tensor<1536xf32>, %arg258: tensor<1536xf32>, %arg259: tensor<1536x1536xf32>, %arg260: tensor<256xf32>, %arg261: tensor<1536x256xf32>, %arg262: tensor<256xf32>, %arg263: tensor<1536x256xf32>, %arg264: tensor<1x2x1024x128xf32>, %arg265: tensor<1x2x1024x128xf32>, %arg266: tensor<1536x1536xf32>, %arg267: tensor<1536xf32>, %arg268: tensor<1536x8960xf32>, %arg269: tensor<1536x8960xf32>, %arg270: tensor<8960x1536xf32>, %arg271: tensor<1536xf32>, %arg272: tensor<1536xf32>, %arg273: tensor<1536x1536xf32>, %arg274: tensor<256xf32>, %arg275: tensor<1536x256xf32>, %arg276: tensor<256xf32>, %arg277: tensor<1536x256xf32>, %arg278: tensor<1x2x1024x128xf32>, %arg279: tensor<1x2x1024x128xf32>, %arg280: tensor<1536x1536xf32>, %arg281: tensor<1536xf32>, %arg282: tensor<1536x8960xf32>, %arg283: tensor<1536x8960xf32>, %arg284: tensor<8960x1536xf32>, %arg285: tensor<1536xf32>, %arg286: tensor<1536xf32>, %arg287: tensor<1536x1536xf32>, %arg288: tensor<256xf32>, %arg289: tensor<1536x256xf32>, %arg290: tensor<256xf32>, %arg291: tensor<1536x256xf32>, %arg292: tensor<1x2x1024x128xf32>, %arg293: tensor<1x2x1024x128xf32>, %arg294: tensor<1536x1536xf32>, %arg295: tensor<1536xf32>, %arg296: tensor<1536x8960xf32>, %arg297: tensor<1536x8960xf32>, %arg298: tensor<8960x1536xf32>, %arg299: tensor<1536xf32>, %arg300: tensor<1536xf32>, %arg301: tensor<1536x1536xf32>, %arg302: tensor<256xf32>, %arg303: tensor<1536x256xf32>, %arg304: tensor<256xf32>, %arg305: tensor<1536x256xf32>, %arg306: tensor<1x2x1024x128xf32>, %arg307: tensor<1x2x1024x128xf32>, %arg308: tensor<1536x1536xf32>, %arg309: tensor<1536xf32>, %arg310: tensor<1536x8960xf32>, %arg311: tensor<1536x8960xf32>, %arg312: tensor<8960x1536xf32>, %arg313: tensor<1536xf32>, %arg314: tensor<1536xf32>, %arg315: tensor<1536x1536xf32>, %arg316: tensor<256xf32>, %arg317: tensor<1536x256xf32>, %arg318: tensor<256xf32>, %arg319: tensor<1536x256xf32>, %arg320: tensor<1x2x1024x128xf32>, %arg321: tensor<1x2x1024x128xf32>, %arg322: tensor<1536x1536xf32>, %arg323: tensor<1536xf32>, %arg324: tensor<1536x8960xf32>, %arg325: tensor<1536x8960xf32>, %arg326: tensor<8960x1536xf32>, %arg327: tensor<1536xf32>, %arg328: tensor<1536xf32>, %arg329: tensor<1536x1536xf32>, %arg330: tensor<256xf32>, %arg331: tensor<1536x256xf32>, %arg332: tensor<256xf32>, %arg333: tensor<1536x256xf32>, %arg334: tensor<1x2x1024x128xf32>, %arg335: tensor<1x2x1024x128xf32>, %arg336: tensor<1536x1536xf32>, %arg337: tensor<1536xf32>, %arg338: tensor<1536x8960xf32>, %arg339: tensor<1536x8960xf32>, %arg340: tensor<8960x1536xf32>, %arg341: tensor<1536xf32>, %arg342: tensor<1536xf32>, %arg343: tensor<1536x1536xf32>, %arg344: tensor<256xf32>, %arg345: tensor<1536x256xf32>, %arg346: tensor<256xf32>, %arg347: tensor<1536x256xf32>, %arg348: tensor<1x2x1024x128xf32>, %arg349: tensor<1x2x1024x128xf32>, %arg350: tensor<1536x1536xf32>, %arg351: tensor<1536xf32>, %arg352: tensor<1536x8960xf32>, %arg353: tensor<1536x8960xf32>, %arg354: tensor<8960x1536xf32>, %arg355: tensor<1536xf32>, %arg356: tensor<1536xf32>, %arg357: tensor<1536x1536xf32>, %arg358: tensor<256xf32>, %arg359: tensor<1536x256xf32>, %arg360: tensor<256xf32>, %arg361: tensor<1536x256xf32>, %arg362: tensor<1x2x1024x128xf32>, %arg363: tensor<1x2x1024x128xf32>, %arg364: tensor<1536x1536xf32>, %arg365: tensor<1536xf32>, %arg366: tensor<1536x8960xf32>, %arg367: tensor<1536x8960xf32>, %arg368: tensor<8960x1536xf32>, %arg369: tensor<1536xf32>, %arg370: tensor<1536xf32>, %arg371: tensor<1536x1536xf32>, %arg372: tensor<256xf32>, %arg373: tensor<1536x256xf32>, %arg374: tensor<256xf32>, %arg375: tensor<1536x256xf32>, %arg376: tensor<1x2x1024x128xf32>, %arg377: tensor<1x2x1024x128xf32>, %arg378: tensor<1536x1536xf32>, %arg379: tensor<1536xf32>, %arg380: tensor<1536x8960xf32>, %arg381: tensor<1536x8960xf32>, %arg382: tensor<8960x1536xf32>, %arg383: tensor<1536xf32>, %arg384: tensor<1536xf32>, %arg385: tensor<1536x1536xf32>, %arg386: tensor<256xf32>, %arg387: tensor<1536x256xf32>, %arg388: tensor<256xf32>, %arg389: tensor<1536x256xf32>, %arg390: tensor<1x2x1024x128xf32>, %arg391: tensor<1x2x1024x128xf32>, %arg392: tensor<1536x1536xf32>, %arg393: tensor<1536xf32>, %arg394: tensor<1536x8960xf32>, %arg395: tensor<1536x8960xf32>, %arg396: tensor<8960x1536xf32>, %arg397: tensor<1536xf32>, %arg398: tensor<1536x151936xf32>) -> (tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x1x151936xf32>) {
    %cst = arith.constant dense<0.000000e+00> : vector<16xf32>
    %cst_0 = arith.constant dense<0xFF800000> : tensor<1x1x1x1024xf32>
    %cst_1 = arith.constant dense<0.000000e+00> : tensor<1x1x1x1024xf32>
    %0 = "tosa.const"() <{values = dense<6.51041686E-4> : tensor<1x1x1xf32>}> : () -> tensor<1x1x1xf32>
    %1 = "tosa.const"() <{values = dense<"0x00000000000000000100000000000000020000000000000003000000000000000400000000000000050000000000000006000000000000000700000000000000080000000000000009000000000000000A000000000000000B000000000000000C000000000000000D000000000000000E000000000000000F0000000000000010000000000000001100000000000000120000000000000013000000000000001400000000000000150000000000000016000000000000001700000000000000180000000000000019000000000000001A000000000000001B000000000000001C000000000000001D000000000000001E000000000000001F0000000000000020000000000000002100000000000000220000000000000023000000000000002400000000000000250000000000000026000000000000002700000000000000280000000000000029000000000000002A000000000000002B000000000000002C000000000000002D000000000000002E000000000000002F0000000000000030000000000000003100000000000000320000000000000033000000000000003400000000000000350000000000000036000000000000003700000000000000380000000000000039000000000000003A000000000000003B000000000000003C000000000000003D000000000000003E000000000000003F0000000000000040000000000000004100000000000000420000000000000043000000000000004400000000000000450000000000000046000000000000004700000000000000480000000000000049000000000000004A000000000000004B000000000000004C000000000000004D000000000000004E000000000000004F0000000000000050000000000000005100000000000000520000000000000053000000000000005400000000000000550000000000000056000000000000005700000000000000580000000000000059000000000000005A000000000000005B000000000000005C000000000000005D000000000000005E000000000000005F0000000000000060000000000000006100000000000000620000000000000063000000000000006400000000000000650000000000000066000000000000006700000000000000680000000000000069000000000000006A000000000000006B000000000000006C000000000000006D000000000000006E000000000000006F0000000000000070000000000000007100000000000000720000000000000073000000000000007400000000000000750000000000000076000000000000007700000000000000780000000000000079000000000000007A000000000000007B000000000000007C000000000000007D000000000000007E000000000000007F0000000000000080000000000000008100000000000000820000000000000083000000000000008400000000000000850000000000000086000000000000008700000000000000880000000000000089000000000000008A000000000000008B000000000000008C000000000000008D000000000000008E000000000000008F0000000000000090000000000000009100000000000000920000000000000093000000000000009400000000000000950000000000000096000000000000009700000000000000980000000000000099000000000000009A000000000000009B000000000000009C000000000000009D000000000000009E000000000000009F00000000000000A000000000000000A100000000000000A200000000000000A300000000000000A400000000000000A500000000000000A600000000000000A700000000000000A800000000000000A900000000000000AA00000000000000AB00000000000000AC00000000000000AD00000000000000AE00000000000000AF00000000000000B000000000000000B100000000000000B200000000000000B300000000000000B400000000000000B500000000000000B600000000000000B700000000000000B800000000000000B900000000000000BA00000000000000BB00000000000000BC00000000000000BD00000000000000BE00000000000000BF00000000000000C000000000000000C100000000000000C200000000000000C300000000000000C400000000000000C500000000000000C600000000000000C700000000000000C800000000000000C900000000000000CA00000000000000CB00000000000000CC00000000000000CD00000000000000CE00000000000000CF00000000000000D000000000000000D100000000000000D200000000000000D300000000000000D400000000000000D500000000000000D600000000000000D700000000000000D800000000000000D900000000000000DA00000000000000DB00000000000000DC00000000000000DD00000000000000DE00000000000000DF00000000000000E000000000000000E100000000000000E200000000000000E300000000000000E400000000000000E500000000000000E600000000000000E700000000000000E800000000000000E900000000000000EA00000000000000EB00000000000000EC00000000000000ED00000000000000EE00000000000000EF00000000000000F000000000000000F100000000000000F200000000000000F300000000000000F400000000000000F500000000000000F600000000000000F700000000000000F800000000000000F900000000000000FA00000000000000FB00000000000000FC00000000000000FD00000000000000FE00000000000000FF0000000000000000010000000000000101000000000000020100000000000003010000000000000401000000000000050100000000000006010000000000000701000000000000080100000000000009010000000000000A010000000000000B010000000000000C010000000000000D010000000000000E010000000000000F0100000000000010010000000000001101000000000000120100000000000013010000000000001401000000000000150100000000000016010000000000001701000000000000180100000000000019010000000000001A010000000000001B010000000000001C010000000000001D010000000000001E010000000000001F0100000000000020010000000000002101000000000000220100000000000023010000000000002401000000000000250100000000000026010000000000002701000000000000280100000000000029010000000000002A010000000000002B010000000000002C010000000000002D010000000000002E010000000000002F0100000000000030010000000000003101000000000000320100000000000033010000000000003401000000000000350100000000000036010000000000003701000000000000380100000000000039010000000000003A010000000000003B010000000000003C010000000000003D010000000000003E010000000000003F0100000000000040010000000000004101000000000000420100000000000043010000000000004401000000000000450100000000000046010000000000004701000000000000480100000000000049010000000000004A010000000000004B010000000000004C010000000000004D010000000000004E010000000000004F0100000000000050010000000000005101000000000000520100000000000053010000000000005401000000000000550100000000000056010000000000005701000000000000580100000000000059010000000000005A010000000000005B010000000000005C010000000000005D010000000000005E010000000000005F0100000000000060010000000000006101000000000000620100000000000063010000000000006401000000000000650100000000000066010000000000006701000000000000680100000000000069010000000000006A010000000000006B010000000000006C010000000000006D010000000000006E010000000000006F0100000000000070010000000000007101000000000000720100000000000073010000000000007401000000000000750100000000000076010000000000007701000000000000780100000000000079010000000000007A010000000000007B010000000000007C010000000000007D010000000000007E010000000000007F0100000000000080010000000000008101000000000000820100000000000083010000000000008401000000000000850100000000000086010000000000008701000000000000880100000000000089010000000000008A010000000000008B010000000000008C010000000000008D010000000000008E010000000000008F0100000000000090010000000000009101000000000000920100000000000093010000000000009401000000000000950100000000000096010000000000009701000000000000980100000000000099010000000000009A010000000000009B010000000000009C010000000000009D010000000000009E010000000000009F01000000000000A001000000000000A101000000000000A201000000000000A301000000000000A401000000000000A501000000000000A601000000000000A701000000000000A801000000000000A901000000000000AA01000000000000AB01000000000000AC01000000000000AD01000000000000AE01000000000000AF01000000000000B001000000000000B101000000000000B201000000000000B301000000000000B401000000000000B501000000000000B601000000000000B701000000000000B801000000000000B901000000000000BA01000000000000BB01000000000000BC01000000000000BD01000000000000BE01000000000000BF01000000000000C001000000000000C101000000000000C201000000000000C301000000000000C401000000000000C501000000000000C601000000000000C701000000000000C801000000000000C901000000000000CA01000000000000CB01000000000000CC01000000000000CD01000000000000CE01000000000000CF01000000000000D001000000000000D101000000000000D201000000000000D301000000000000D401000000000000D501000000000000D601000000000000D701000000000000D801000000000000D901000000000000DA01000000000000DB01000000000000DC01000000000000DD01000000000000DE01000000000000DF01000000000000E001000000000000E101000000000000E201000000000000E301000000000000E401000000000000E501000000000000E601000000000000E701000000000000E801000000000000E901000000000000EA01000000000000EB01000000000000EC01000000000000ED01000000000000EE01000000000000EF01000000000000F001000000000000F101000000000000F201000000000000F301000000000000F401000000000000F501000000000000F601000000000000F701000000000000F801000000000000F901000000000000FA01000000000000FB01000000000000FC01000000000000FD01000000000000FE01000000000000FF0100000000000000020000000000000102000000000000020200000000000003020000000000000402000000000000050200000000000006020000000000000702000000000000080200000000000009020000000000000A020000000000000B020000000000000C020000000000000D020000000000000E020000000000000F0200000000000010020000000000001102000000000000120200000000000013020000000000001402000000000000150200000000000016020000000000001702000000000000180200000000000019020000000000001A020000000000001B020000000000001C020000000000001D020000000000001E020000000000001F0200000000000020020000000000002102000000000000220200000000000023020000000000002402000000000000250200000000000026020000000000002702000000000000280200000000000029020000000000002A020000000000002B020000000000002C020000000000002D020000000000002E020000000000002F0200000000000030020000000000003102000000000000320200000000000033020000000000003402000000000000350200000000000036020000000000003702000000000000380200000000000039020000000000003A020000000000003B020000000000003C020000000000003D020000000000003E020000000000003F0200000000000040020000000000004102000000000000420200000000000043020000000000004402000000000000450200000000000046020000000000004702000000000000480200000000000049020000000000004A020000000000004B020000000000004C020000000000004D020000000000004E020000000000004F0200000000000050020000000000005102000000000000520200000000000053020000000000005402000000000000550200000000000056020000000000005702000000000000580200000000000059020000000000005A020000000000005B020000000000005C020000000000005D020000000000005E020000000000005F0200000000000060020000000000006102000000000000620200000000000063020000000000006402000000000000650200000000000066020000000000006702000000000000680200000000000069020000000000006A020000000000006B020000000000006C020000000000006D020000000000006E020000000000006F0200000000000070020000000000007102000000000000720200000000000073020000000000007402000000000000750200000000000076020000000000007702000000000000780200000000000079020000000000007A020000000000007B020000000000007C020000000000007D020000000000007E020000000000007F0200000000000080020000000000008102000000000000820200000000000083020000000000008402000000000000850200000000000086020000000000008702000000000000880200000000000089020000000000008A020000000000008B020000000000008C020000000000008D020000000000008E020000000000008F0200000000000090020000000000009102000000000000920200000000000093020000000000009402000000000000950200000000000096020000000000009702000000000000980200000000000099020000000000009A020000000000009B020000000000009C020000000000009D020000000000009E020000000000009F02000000000000A002000000000000A102000000000000A202000000000000A302000000000000A402000000000000A502000000000000A602000000000000A702000000000000A802000000000000A902000000000000AA02000000000000AB02000000000000AC02000000000000AD02000000000000AE02000000000000AF02000000000000B002000000000000B102000000000000B202000000000000B302000000000000B402000000000000B502000000000000B602000000000000B702000000000000B802000000000000B902000000000000BA02000000000000BB02000000000000BC02000000000000BD02000000000000BE02000000000000BF02000000000000C002000000000000C102000000000000C202000000000000C302000000000000C402000000000000C502000000000000C602000000000000C702000000000000C802000000000000C902000000000000CA02000000000000CB02000000000000CC02000000000000CD02000000000000CE02000000000000CF02000000000000D002000000000000D102000000000000D202000000000000D302000000000000D402000000000000D502000000000000D602000000000000D702000000000000D802000000000000D902000000000000DA02000000000000DB02000000000000DC02000000000000DD02000000000000DE02000000000000DF02000000000000E002000000000000E102000000000000E202000000000000E302000000000000E402000000000000E502000000000000E602000000000000E702000000000000E802000000000000E902000000000000EA02000000000000EB02000000000000EC02000000000000ED02000000000000EE02000000000000EF02000000000000F002000000000000F102000000000000F202000000000000F302000000000000F402000000000000F502000000000000F602000000000000F702000000000000F802000000000000F902000000000000FA02000000000000FB02000000000000FC02000000000000FD02000000000000FE02000000000000FF0200000000000000030000000000000103000000000000020300000000000003030000000000000403000000000000050300000000000006030000000000000703000000000000080300000000000009030000000000000A030000000000000B030000000000000C030000000000000D030000000000000E030000000000000F0300000000000010030000000000001103000000000000120300000000000013030000000000001403000000000000150300000000000016030000000000001703000000000000180300000000000019030000000000001A030000000000001B030000000000001C030000000000001D030000000000001E030000000000001F0300000000000020030000000000002103000000000000220300000000000023030000000000002403000000000000250300000000000026030000000000002703000000000000280300000000000029030000000000002A030000000000002B030000000000002C030000000000002D030000000000002E030000000000002F0300000000000030030000000000003103000000000000320300000000000033030000000000003403000000000000350300000000000036030000000000003703000000000000380300000000000039030000000000003A030000000000003B030000000000003C030000000000003D030000000000003E030000000000003F0300000000000040030000000000004103000000000000420300000000000043030000000000004403000000000000450300000000000046030000000000004703000000000000480300000000000049030000000000004A030000000000004B030000000000004C030000000000004D030000000000004E030000000000004F0300000000000050030000000000005103000000000000520300000000000053030000000000005403000000000000550300000000000056030000000000005703000000000000580300000000000059030000000000005A030000000000005B030000000000005C030000000000005D030000000000005E030000000000005F0300000000000060030000000000006103000000000000620300000000000063030000000000006403000000000000650300000000000066030000000000006703000000000000680300000000000069030000000000006A030000000000006B030000000000006C030000000000006D030000000000006E030000000000006F0300000000000070030000000000007103000000000000720300000000000073030000000000007403000000000000750300000000000076030000000000007703000000000000780300000000000079030000000000007A030000000000007B030000000000007C030000000000007D030000000000007E030000000000007F0300000000000080030000000000008103000000000000820300000000000083030000000000008403000000000000850300000000000086030000000000008703000000000000880300000000000089030000000000008A030000000000008B030000000000008C030000000000008D030000000000008E030000000000008F0300000000000090030000000000009103000000000000920300000000000093030000000000009403000000000000950300000000000096030000000000009703000000000000980300000000000099030000000000009A030000000000009B030000000000009C030000000000009D030000000000009E030000000000009F03000000000000A003000000000000A103000000000000A203000000000000A303000000000000A403000000000000A503000000000000A603000000000000A703000000000000A803000000000000A903000000000000AA03000000000000AB03000000000000AC03000000000000AD03000000000000AE03000000000000AF03000000000000B003000000000000B103000000000000B203000000000000B303000000000000B403000000000000B503000000000000B603000000000000B703000000000000B803000000000000B903000000000000BA03000000000000BB03000000000000BC03000000000000BD03000000000000BE03000000000000BF03000000000000C003000000000000C103000000000000C203000000000000C303000000000000C403000000000000C503000000000000C603000000000000C703000000000000C803000000000000C903000000000000CA03000000000000CB03000000000000CC03000000000000CD03000000000000CE03000000000000CF03000000000000D003000000000000D103000000000000D203000000000000D303000000000000D403000000000000D503000000000000D603000000000000D703000000000000D803000000000000D903000000000000DA03000000000000DB03000000000000DC03000000000000DD03000000000000DE03000000000000DF03000000000000E003000000000000E103000000000000E203000000000000E303000000000000E403000000000000E503000000000000E603000000000000E703000000000000E803000000000000E903000000000000EA03000000000000EB03000000000000EC03000000000000ED03000000000000EE03000000000000EF03000000000000F003000000000000F103000000000000F203000000000000F303000000000000F403000000000000F503000000000000F603000000000000F703000000000000F803000000000000F903000000000000FA03000000000000FB03000000000000FC03000000000000FD03000000000000FE03000000000000FF03000000000000"> : tensor<1x1024xi64>}> : () -> tensor<1x1024xi64>
    %2 = tosa.const_shape  {values = dense<[1, 1, 151936]> : tensor<3xindex>} : () -> !tosa.shape<3>
    %cst_2 = arith.constant dense<0.000000e+00> : tensor<1x151936xf32>
    %3 = tosa.const_shape  {values = dense<[1, 8960]> : tensor<2xindex>} : () -> !tosa.shape<2>
    %4 = tosa.const_shape  {values = dense<[1, 1, 8960]> : tensor<3xindex>} : () -> !tosa.shape<3>
    %cst_3 = arith.constant dense<0.000000e+00> : tensor<1x8960xf32>
    %c6 = arith.constant 6 : index
    %cst_4 = arith.constant -1.000000e+30 : f32
    %cst_5 = arith.constant 0.0883883461 : f32
    %cst_6 = arith.constant 1.000000e+00 : f32
    %cst_7 = arith.constant 0.000000e+00 : f32
    %5 = tosa.const_shape  {values = dense<[1, 1, 1, 1024]> : tensor<4xindex>} : () -> !tosa.shape<4>
    %c128 = arith.constant 128 : index
    %c2 = arith.constant 2 : index
    %c1 = arith.constant 1 : index
    %c0 = arith.constant 0 : index
    %6 = "tosa.const"() <{values = dense<0> : tensor<1x2x1x128xi64>}> : () -> tensor<1x2x1x128xi64>
    %7 = tosa.const_shape  {values = dense<1> : tensor<4xindex>} : () -> !tosa.shape<4>
    %8 = tosa.const_shape  {values = dense<[1, 1, 1, 128]> : tensor<4xindex>} : () -> !tosa.shape<4>
    %9 = tosa.const_shape  {values = dense<[1, 2, 1, 128]> : tensor<4xindex>} : () -> !tosa.shape<4>
    %10 = tosa.const_shape  {values = dense<[1, 256]> : tensor<2xindex>} : () -> !tosa.shape<2>
    %cst_8 = arith.constant dense<0.000000e+00> : tensor<1x256xf32>
    %11 = tosa.const_shape  {values = dense<[1, 12, 1, 128]> : tensor<4xindex>} : () -> !tosa.shape<4>
    %cst_9 = arith.constant dense<0.000000e+00> : tensor<1x1536xf32>
    %12 = tosa.const_shape  {values = dense<[1, 1536]> : tensor<2xindex>} : () -> !tosa.shape<2>
    %13 = tosa.const_shape  {values = dense<[1, 1, 1536]> : tensor<3xindex>} : () -> !tosa.shape<3>
    %14 = "tosa.const"() <{values = dense<9.99999997E-7> : tensor<1x1x1xf32>}> : () -> tensor<1x1x1xf32>
    %c2_i32 = arith.constant 2 : i32
    %15 = "tosa.const"() <{values = dense<0> : tensor<1xi8>}> : () -> tensor<1xi8>
    %16 = tosa.const_shape  {values = dense<[1, 1, 128]> : tensor<3xindex>} : () -> !tosa.shape<3>
    %17 = "tosa.const"() <{values = dense<0.000000e+00> : tensor<1x1x2x64xf32>}> : () -> tensor<1x1x2x64xf32>
    %18 = tosa.const_shape  {values = dense<[1, 1, 1, 64]> : tensor<4xindex>} : () -> !tosa.shape<4>
    %19 = "tosa.const"() <{values = dense<0.000000e+00> : tensor<1xf32>}> : () -> tensor<1xf32>
    %20 = tosa.const_shape  {values = dense<1> : tensor<3xindex>} : () -> !tosa.shape<3>
    %21 = tosa.const_shape  {values = dense<[1, 64, 1]> : tensor<3xindex>} : () -> !tosa.shape<3>
    %22 = tosa.const_shape  {values = dense<1> : tensor<2xindex>} : () -> !tosa.shape<2>
    %23 = tosa.const_shape  {values = dense<[1, 151936, 1536]> : tensor<3xindex>} : () -> !tosa.shape<3>
    %24 = tosa.cast %arg1 : (tensor<1x1xi64>) -> tensor<1x1xi32>
    %25 = tosa.reshape %arg0, %23 : (tensor<151936x1536xf32>, !tosa.shape<3>) -> tensor<1x151936x1536xf32>
    %26 = tosa.gather %25, %24 : (tensor<1x151936x1536xf32>, tensor<1x1xi32>) -> tensor<1x1x1536xf32>
    %27 = tosa.reshape %arg3, %22 : (tensor<1xi64>, !tosa.shape<2>) -> tensor<1x1xi64>
    %28 = tosa.greater_equal %27, %1 : (tensor<1x1xi64>, tensor<1x1024xi64>) -> tensor<1x1024xi1>
    %29 = tosa.reshape %arg4, %21 : (tensor<64xf32>, !tosa.shape<3>) -> tensor<1x64x1xf32>
    %30 = tosa.reshape %arg3, %20 : (tensor<1xi64>, !tosa.shape<3>) -> tensor<1x1x1xi64>
    %31 = tosa.cast %30 : (tensor<1x1x1xi64>) -> tensor<1x1x1xf32>
    %32 = tosa.mul %29, %31, %15 : (tensor<1x64x1xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x64x1xf32>
    %33 = tosa.reshape %32, %18 : (tensor<1x64x1xf32>, !tosa.shape<4>) -> tensor<1x1x1x64xf32>
    %34 = tosa.add %33, %17 : (tensor<1x1x1x64xf32>, tensor<1x1x2x64xf32>) -> tensor<1x1x2x64xf32>
    %35 = tosa.reshape %34, %16 : (tensor<1x1x2x64xf32>, !tosa.shape<3>) -> tensor<1x1x128xf32>
    %36 = math.cos %35 : tensor<1x1x128xf32>
    %37 = math.sin %35 : tensor<1x1x128xf32>
    %38 = tensor.empty() : tensor<1x1x1536xf32>
    %39 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%26 : tensor<1x1x1536xf32>) outs(%38 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2290 = math.fpowi %in, %c2_i32 : f32, i32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1536xf32>
    %40 = tosa.reduce_sum %39 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %41 = tosa.mul %40, %0, %15 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1xf32>
    %42 = tosa.add %41, %14 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %43 = tosa.rsqrt %42 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %44 = tosa.mul %26, %43, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %45 = tosa.reshape %arg5, %13 : (tensor<1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %46 = tosa.mul %45, %44, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %47 = tosa.reshape %46, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %48 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%47, %arg7 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %49 = tosa.reshape %arg6, %12 : (tensor<1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %50 = tosa.add %49, %48 : (tensor<1x1536xf32>, tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %51 = tosa.reshape %50, %11 : (tensor<1x1536xf32>, !tosa.shape<4>) -> tensor<1x12x1x128xf32>
    %52 = tosa.reshape %46, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %53 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%52, %arg9 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_8 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %54 = tosa.reshape %arg8, %10 : (tensor<256xf32>, !tosa.shape<2>) -> tensor<1x256xf32>
    %55 = tosa.add %54, %53 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %56 = tosa.reshape %55, %9 : (tensor<1x256xf32>, !tosa.shape<4>) -> tensor<1x2x1x128xf32>
    %57 = tosa.reshape %46, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %58 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%57, %arg11 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_8 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %59 = tosa.reshape %arg10, %10 : (tensor<256xf32>, !tosa.shape<2>) -> tensor<1x256xf32>
    %60 = tosa.add %59, %58 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %61 = tosa.reshape %60, %9 : (tensor<1x256xf32>, !tosa.shape<4>) -> tensor<1x2x1x128xf32>
    %62 = tosa.reshape %36, %8 : (tensor<1x1x128xf32>, !tosa.shape<4>) -> tensor<1x1x1x128xf32>
    %63 = tosa.reshape %37, %8 : (tensor<1x1x128xf32>, !tosa.shape<4>) -> tensor<1x1x1x128xf32>
    %64 = tosa.mul %51, %62, %15 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x12x1x128xf32>
    %extracted_slice = tensor.extract_slice %51[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %extracted_slice_10 = tensor.extract_slice %51[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %65 = tosa.negate %extracted_slice_10, %19, %19 : (tensor<1x12x1x64xf32>, tensor<1xf32>, tensor<1xf32>) -> tensor<1x12x1x64xf32>
    %66 = tensor.empty() : tensor<1x12x1x128xf32>
    %inserted_slice = tensor.insert_slice %65 into %66[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %inserted_slice_11 = tensor.insert_slice %extracted_slice into %inserted_slice[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %67 = tosa.mul %inserted_slice_11, %63, %15 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x12x1x128xf32>
    %68 = tosa.add %64, %67 : (tensor<1x12x1x128xf32>, tensor<1x12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %69 = tosa.mul %56, %62, %15 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x2x1x128xf32>
    %extracted_slice_12 = tensor.extract_slice %56[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %extracted_slice_13 = tensor.extract_slice %56[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %70 = tosa.negate %extracted_slice_13, %19, %19 : (tensor<1x2x1x64xf32>, tensor<1xf32>, tensor<1xf32>) -> tensor<1x2x1x64xf32>
    %71 = tensor.empty() : tensor<1x2x1x128xf32>
    %inserted_slice_14 = tensor.insert_slice %70 into %71[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %inserted_slice_15 = tensor.insert_slice %extracted_slice_12 into %inserted_slice_14[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %72 = tosa.mul %inserted_slice_15, %63, %15 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x2x1x128xf32>
    %73 = tosa.add %69, %72 : (tensor<1x2x1x128xf32>, tensor<1x2x1x128xf32>) -> tensor<1x2x1x128xf32>
    %74 = bufferization.to_buffer %arg12 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %75 = tosa.reshape %arg3, %7 : (tensor<1xi64>, !tosa.shape<4>) -> tensor<1x1x1x1xi64>
    %76 = tosa.add %75, %6 : (tensor<1x1x1x1xi64>, tensor<1x2x1x128xi64>) -> tensor<1x2x1x128xi64>
    %77 = bufferization.to_buffer %76 : tensor<1x2x1x128xi64> to memref<1x2x1x128xi64>
    %78 = bufferization.to_buffer %73 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    scf.for %arg399 = %c0 to %c1 step %c1 {
      scf.for %arg400 = %c0 to %c2 step %c1 {
        scf.for %arg401 = %c0 to %c1 step %c1 {
          scf.for %arg402 = %c0 to %c128 step %c1 {
            %2290 = memref.load %78[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            %2291 = memref.load %77[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xi64>
            %2292 = arith.index_cast %2291 : i64 to index
            memref.store %2290, %74[%arg399, %arg400, %2292, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %79 = bufferization.to_tensor %74 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %80 = bufferization.to_buffer %arg13 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %81 = tosa.reshape %arg3, %7 : (tensor<1xi64>, !tosa.shape<4>) -> tensor<1x1x1x1xi64>
    %82 = tosa.add %81, %6 : (tensor<1x1x1x1xi64>, tensor<1x2x1x128xi64>) -> tensor<1x2x1x128xi64>
    %83 = bufferization.to_buffer %82 : tensor<1x2x1x128xi64> to memref<1x2x1x128xi64>
    %84 = bufferization.to_buffer %61 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    scf.for %arg399 = %c0 to %c1 step %c1 {
      scf.for %arg400 = %c0 to %c2 step %c1 {
        scf.for %arg401 = %c0 to %c1 step %c1 {
          scf.for %arg402 = %c0 to %c128 step %c1 {
            %2290 = memref.load %84[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            %2291 = memref.load %83[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xi64>
            %2292 = arith.index_cast %2291 : i64 to index
            memref.store %2290, %80[%arg399, %arg400, %2292, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %85 = bufferization.to_tensor %80 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %86 = tosa.reshape %28, %5 : (tensor<1x1024xi1>, !tosa.shape<4>) -> tensor<1x1x1x1024xi1>
    %87 = tensor.empty() : tensor<1x1x1x1024xf32>
    %88 = linalg.generic {indexing_maps = [#map1, #map1, #map1, #map1], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%86, %cst_1, %cst_0 : tensor<1x1x1x1024xi1>, tensor<1x1x1x1024xf32>, tensor<1x1x1x1024xf32>) outs(%87 : tensor<1x1x1x1024xf32>) {
    ^bb0(%in: i1, %in_315: f32, %in_316: f32, %out: f32):
      %2290 = arith.select %in, %in_315, %in_316 : f32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1x1024xf32>
    %89 = bufferization.to_buffer %68 : tensor<1x12x1x128xf32> to memref<1x12x1x128xf32>
    %90 = bufferization.to_buffer %88 : tensor<1x1x1x1024xf32> to memref<1x1x1x1024xf32>
    %alloc = memref.alloc() : memref<1x12x1x128xf32>
    %alloc_16 = memref.alloc() : memref<1x12x1xf32>
    %alloc_17 = memref.alloc() : memref<128xf32>
    affine.for %arg399 = 0 to 1 {
      affine.for %arg400 = 0 to 12 {
        %2290 = arith.divsi %arg400, %c6 : index
        affine.for %arg401 = 0 to 1 {
          affine.for %arg402 = 0 to 128 {
            memref.store %cst_7, %alloc_17[%arg402] : memref<128xf32>
          }
          %2291:2 = affine.for %arg402 = 0 to 1024 iter_args(%arg403 = %cst_4, %arg404 = %cst_7) -> (f32, f32) {
            %2292 = affine.for %arg405 = 0 to 128 step 16 iter_args(%arg406 = %cst) -> (vector<16xf32>) {
              %2307 = vector.load %89[%arg399, %arg400, %arg401, %arg405] : memref<1x12x1x128xf32>, vector<16xf32>
              %2308 = vector.load %74[%arg399, %2290, %arg402, %arg405] : memref<1x2x1024x128xf32>, vector<16xf32>
              %2309 = vector.fma %2307, %2308, %arg406 : vector<16xf32>
              affine.yield %2309 : vector<16xf32>
            }
            %2293 = vector.reduction <add>, %2292 : vector<16xf32> into f32
            %2294 = arith.mulf %2293, %cst_5 : f32
            %2295 = memref.load %90[%arg399, %c0, %arg401, %arg402] : memref<1x1x1x1024xf32>
            %2296 = arith.addf %2294, %2295 : f32
            %2297 = arith.cmpf ogt, %2296, %arg403 : f32
            %2298 = arith.select %2297, %2296, %arg403 : f32
            %2299 = arith.subf %arg403, %2296 : f32
            %2300 = math.exp %2299 : f32
            %2301 = arith.mulf %2300, %arg404 : f32
            %2302 = arith.addf %2301, %cst_6 : f32
            %2303 = arith.subf %2296, %arg403 : f32
            %2304 = math.exp %2303 : f32
            %2305 = arith.addf %arg404, %2304 : f32
            %2306 = arith.select %2297, %2302, %2305 : f32
            affine.for %arg405 = 0 to 128 {
              %2307 = memref.load %80[%arg399, %2290, %arg402, %arg405] : memref<1x2x1024x128xf32>
              %2308 = memref.load %alloc_17[%arg405] : memref<128xf32>
              %2309 = arith.mulf %2308, %2300 : f32
              %2310 = arith.addf %2309, %2307 : f32
              %2311 = arith.mulf %2304, %2307 : f32
              %2312 = arith.addf %2311, %2308 : f32
              %2313 = arith.select %2297, %2310, %2312 : f32
              memref.store %2313, %alloc_17[%arg405] : memref<128xf32>
            }
            affine.yield %2298, %2306 : f32, f32
          }
          memref.store %2291#1, %alloc_16[%arg399, %arg400, %arg401] : memref<1x12x1xf32>
          affine.for %arg402 = 0 to 128 {
            %2292 = memref.load %alloc_17[%arg402] : memref<128xf32>
            %2293 = arith.divf %2292, %2291#1 : f32
            memref.store %2293, %alloc[%arg399, %arg400, %arg401, %arg402] : memref<1x12x1x128xf32>
          }
        }
      }
    }
    %91 = bufferization.to_tensor %alloc restrict : memref<1x12x1x128xf32> to tensor<1x12x1x128xf32>
    %92 = tosa.reshape %91, %12 : (tensor<1x12x1x128xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %93 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%92, %arg14 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %94 = tosa.reshape %93, %13 : (tensor<1x1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %95 = tosa.add %26, %94 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %96 = tensor.empty() : tensor<1x1x1536xf32>
    %97 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%95 : tensor<1x1x1536xf32>) outs(%96 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2290 = math.fpowi %in, %c2_i32 : f32, i32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1536xf32>
    %98 = tosa.reduce_sum %97 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %99 = tosa.mul %98, %0, %15 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1xf32>
    %100 = tosa.add %99, %14 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %101 = tosa.rsqrt %100 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %102 = tosa.mul %95, %101, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %103 = tosa.reshape %arg15, %13 : (tensor<1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %104 = tosa.mul %103, %102, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %105 = tosa.reshape %104, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %106 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%105, %arg16 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_3 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %107 = tosa.reshape %106, %4 : (tensor<1x8960xf32>, !tosa.shape<3>) -> tensor<1x1x8960xf32>
    %108 = tosa.sigmoid %107 : (tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %109 = tosa.mul %107, %108, %15 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>, tensor<1xi8>) -> tensor<1x1x8960xf32>
    %110 = tosa.reshape %104, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %111 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%110, %arg17 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_3 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %112 = tosa.reshape %111, %4 : (tensor<1x8960xf32>, !tosa.shape<3>) -> tensor<1x1x8960xf32>
    %113 = tosa.mul %109, %112, %15 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>, tensor<1xi8>) -> tensor<1x1x8960xf32>
    %114 = tosa.reshape %113, %3 : (tensor<1x1x8960xf32>, !tosa.shape<2>) -> tensor<1x8960xf32>
    %115 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%114, %arg18 : tensor<1x8960xf32>, tensor<8960x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %116 = tosa.reshape %115, %13 : (tensor<1x1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %117 = tosa.add %95, %116 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %118 = tensor.empty() : tensor<1x1x1536xf32>
    %119 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%117 : tensor<1x1x1536xf32>) outs(%118 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2290 = math.fpowi %in, %c2_i32 : f32, i32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1536xf32>
    %120 = tosa.reduce_sum %119 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %121 = tosa.mul %120, %0, %15 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1xf32>
    %122 = tosa.add %121, %14 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %123 = tosa.rsqrt %122 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %124 = tosa.mul %117, %123, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %125 = tosa.reshape %arg19, %13 : (tensor<1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %126 = tosa.mul %125, %124, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %127 = tosa.reshape %126, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %128 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%127, %arg21 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %129 = tosa.reshape %arg20, %12 : (tensor<1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %130 = tosa.add %129, %128 : (tensor<1x1536xf32>, tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %131 = tosa.reshape %130, %11 : (tensor<1x1536xf32>, !tosa.shape<4>) -> tensor<1x12x1x128xf32>
    %132 = tosa.reshape %126, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %133 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%132, %arg23 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_8 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %134 = tosa.reshape %arg22, %10 : (tensor<256xf32>, !tosa.shape<2>) -> tensor<1x256xf32>
    %135 = tosa.add %134, %133 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %136 = tosa.reshape %135, %9 : (tensor<1x256xf32>, !tosa.shape<4>) -> tensor<1x2x1x128xf32>
    %137 = tosa.reshape %126, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %138 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%137, %arg25 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_8 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %139 = tosa.reshape %arg24, %10 : (tensor<256xf32>, !tosa.shape<2>) -> tensor<1x256xf32>
    %140 = tosa.add %139, %138 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %141 = tosa.reshape %140, %9 : (tensor<1x256xf32>, !tosa.shape<4>) -> tensor<1x2x1x128xf32>
    %142 = tosa.reshape %36, %8 : (tensor<1x1x128xf32>, !tosa.shape<4>) -> tensor<1x1x1x128xf32>
    %143 = tosa.reshape %37, %8 : (tensor<1x1x128xf32>, !tosa.shape<4>) -> tensor<1x1x1x128xf32>
    %144 = tosa.mul %131, %142, %15 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x12x1x128xf32>
    %extracted_slice_18 = tensor.extract_slice %131[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %extracted_slice_19 = tensor.extract_slice %131[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %145 = tosa.negate %extracted_slice_19, %19, %19 : (tensor<1x12x1x64xf32>, tensor<1xf32>, tensor<1xf32>) -> tensor<1x12x1x64xf32>
    %146 = tensor.empty() : tensor<1x12x1x128xf32>
    %inserted_slice_20 = tensor.insert_slice %145 into %146[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %inserted_slice_21 = tensor.insert_slice %extracted_slice_18 into %inserted_slice_20[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %147 = tosa.mul %inserted_slice_21, %143, %15 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x12x1x128xf32>
    %148 = tosa.add %144, %147 : (tensor<1x12x1x128xf32>, tensor<1x12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %149 = tosa.mul %136, %142, %15 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x2x1x128xf32>
    %extracted_slice_22 = tensor.extract_slice %136[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %extracted_slice_23 = tensor.extract_slice %136[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %150 = tosa.negate %extracted_slice_23, %19, %19 : (tensor<1x2x1x64xf32>, tensor<1xf32>, tensor<1xf32>) -> tensor<1x2x1x64xf32>
    %151 = tensor.empty() : tensor<1x2x1x128xf32>
    %inserted_slice_24 = tensor.insert_slice %150 into %151[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %inserted_slice_25 = tensor.insert_slice %extracted_slice_22 into %inserted_slice_24[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %152 = tosa.mul %inserted_slice_25, %143, %15 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x2x1x128xf32>
    %153 = tosa.add %149, %152 : (tensor<1x2x1x128xf32>, tensor<1x2x1x128xf32>) -> tensor<1x2x1x128xf32>
    %154 = bufferization.to_buffer %arg26 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %155 = tosa.reshape %arg3, %7 : (tensor<1xi64>, !tosa.shape<4>) -> tensor<1x1x1x1xi64>
    %156 = tosa.add %155, %6 : (tensor<1x1x1x1xi64>, tensor<1x2x1x128xi64>) -> tensor<1x2x1x128xi64>
    %157 = bufferization.to_buffer %156 : tensor<1x2x1x128xi64> to memref<1x2x1x128xi64>
    %158 = bufferization.to_buffer %153 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    scf.for %arg399 = %c0 to %c1 step %c1 {
      scf.for %arg400 = %c0 to %c2 step %c1 {
        scf.for %arg401 = %c0 to %c1 step %c1 {
          scf.for %arg402 = %c0 to %c128 step %c1 {
            %2290 = memref.load %158[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            %2291 = memref.load %157[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xi64>
            %2292 = arith.index_cast %2291 : i64 to index
            memref.store %2290, %154[%arg399, %arg400, %2292, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %159 = bufferization.to_tensor %154 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %160 = bufferization.to_buffer %arg27 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %161 = tosa.reshape %arg3, %7 : (tensor<1xi64>, !tosa.shape<4>) -> tensor<1x1x1x1xi64>
    %162 = tosa.add %161, %6 : (tensor<1x1x1x1xi64>, tensor<1x2x1x128xi64>) -> tensor<1x2x1x128xi64>
    %163 = bufferization.to_buffer %162 : tensor<1x2x1x128xi64> to memref<1x2x1x128xi64>
    %164 = bufferization.to_buffer %141 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    scf.for %arg399 = %c0 to %c1 step %c1 {
      scf.for %arg400 = %c0 to %c2 step %c1 {
        scf.for %arg401 = %c0 to %c1 step %c1 {
          scf.for %arg402 = %c0 to %c128 step %c1 {
            %2290 = memref.load %164[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            %2291 = memref.load %163[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xi64>
            %2292 = arith.index_cast %2291 : i64 to index
            memref.store %2290, %160[%arg399, %arg400, %2292, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %165 = bufferization.to_tensor %160 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %166 = tosa.reshape %28, %5 : (tensor<1x1024xi1>, !tosa.shape<4>) -> tensor<1x1x1x1024xi1>
    %167 = tensor.empty() : tensor<1x1x1x1024xf32>
    %168 = linalg.generic {indexing_maps = [#map1, #map1, #map1, #map1], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%166, %cst_1, %cst_0 : tensor<1x1x1x1024xi1>, tensor<1x1x1x1024xf32>, tensor<1x1x1x1024xf32>) outs(%167 : tensor<1x1x1x1024xf32>) {
    ^bb0(%in: i1, %in_315: f32, %in_316: f32, %out: f32):
      %2290 = arith.select %in, %in_315, %in_316 : f32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1x1024xf32>
    %169 = bufferization.to_buffer %148 : tensor<1x12x1x128xf32> to memref<1x12x1x128xf32>
    %170 = bufferization.to_buffer %168 : tensor<1x1x1x1024xf32> to memref<1x1x1x1024xf32>
    %alloc_26 = memref.alloc() : memref<1x12x1x128xf32>
    %alloc_27 = memref.alloc() : memref<1x12x1xf32>
    %alloc_28 = memref.alloc() : memref<128xf32>
    affine.for %arg399 = 0 to 1 {
      affine.for %arg400 = 0 to 12 {
        %2290 = arith.divsi %arg400, %c6 : index
        affine.for %arg401 = 0 to 1 {
          affine.for %arg402 = 0 to 128 {
            memref.store %cst_7, %alloc_28[%arg402] : memref<128xf32>
          }
          %2291:2 = affine.for %arg402 = 0 to 1024 iter_args(%arg403 = %cst_4, %arg404 = %cst_7) -> (f32, f32) {
            %2292 = affine.for %arg405 = 0 to 128 step 16 iter_args(%arg406 = %cst) -> (vector<16xf32>) {
              %2307 = vector.load %169[%arg399, %arg400, %arg401, %arg405] : memref<1x12x1x128xf32>, vector<16xf32>
              %2308 = vector.load %154[%arg399, %2290, %arg402, %arg405] : memref<1x2x1024x128xf32>, vector<16xf32>
              %2309 = vector.fma %2307, %2308, %arg406 : vector<16xf32>
              affine.yield %2309 : vector<16xf32>
            }
            %2293 = vector.reduction <add>, %2292 : vector<16xf32> into f32
            %2294 = arith.mulf %2293, %cst_5 : f32
            %2295 = memref.load %170[%arg399, %c0, %arg401, %arg402] : memref<1x1x1x1024xf32>
            %2296 = arith.addf %2294, %2295 : f32
            %2297 = arith.cmpf ogt, %2296, %arg403 : f32
            %2298 = arith.select %2297, %2296, %arg403 : f32
            %2299 = arith.subf %arg403, %2296 : f32
            %2300 = math.exp %2299 : f32
            %2301 = arith.mulf %2300, %arg404 : f32
            %2302 = arith.addf %2301, %cst_6 : f32
            %2303 = arith.subf %2296, %arg403 : f32
            %2304 = math.exp %2303 : f32
            %2305 = arith.addf %arg404, %2304 : f32
            %2306 = arith.select %2297, %2302, %2305 : f32
            affine.for %arg405 = 0 to 128 {
              %2307 = memref.load %160[%arg399, %2290, %arg402, %arg405] : memref<1x2x1024x128xf32>
              %2308 = memref.load %alloc_28[%arg405] : memref<128xf32>
              %2309 = arith.mulf %2308, %2300 : f32
              %2310 = arith.addf %2309, %2307 : f32
              %2311 = arith.mulf %2304, %2307 : f32
              %2312 = arith.addf %2311, %2308 : f32
              %2313 = arith.select %2297, %2310, %2312 : f32
              memref.store %2313, %alloc_28[%arg405] : memref<128xf32>
            }
            affine.yield %2298, %2306 : f32, f32
          }
          memref.store %2291#1, %alloc_27[%arg399, %arg400, %arg401] : memref<1x12x1xf32>
          affine.for %arg402 = 0 to 128 {
            %2292 = memref.load %alloc_28[%arg402] : memref<128xf32>
            %2293 = arith.divf %2292, %2291#1 : f32
            memref.store %2293, %alloc_26[%arg399, %arg400, %arg401, %arg402] : memref<1x12x1x128xf32>
          }
        }
      }
    }
    %171 = bufferization.to_tensor %alloc_26 restrict : memref<1x12x1x128xf32> to tensor<1x12x1x128xf32>
    %172 = tosa.reshape %171, %12 : (tensor<1x12x1x128xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %173 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%172, %arg28 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %174 = tosa.reshape %173, %13 : (tensor<1x1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %175 = tosa.add %117, %174 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %176 = tensor.empty() : tensor<1x1x1536xf32>
    %177 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%175 : tensor<1x1x1536xf32>) outs(%176 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2290 = math.fpowi %in, %c2_i32 : f32, i32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1536xf32>
    %178 = tosa.reduce_sum %177 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %179 = tosa.mul %178, %0, %15 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1xf32>
    %180 = tosa.add %179, %14 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %181 = tosa.rsqrt %180 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %182 = tosa.mul %175, %181, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %183 = tosa.reshape %arg29, %13 : (tensor<1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %184 = tosa.mul %183, %182, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %185 = tosa.reshape %184, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %186 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%185, %arg30 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_3 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %187 = tosa.reshape %186, %4 : (tensor<1x8960xf32>, !tosa.shape<3>) -> tensor<1x1x8960xf32>
    %188 = tosa.sigmoid %187 : (tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %189 = tosa.mul %187, %188, %15 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>, tensor<1xi8>) -> tensor<1x1x8960xf32>
    %190 = tosa.reshape %184, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %191 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%190, %arg31 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_3 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %192 = tosa.reshape %191, %4 : (tensor<1x8960xf32>, !tosa.shape<3>) -> tensor<1x1x8960xf32>
    %193 = tosa.mul %189, %192, %15 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>, tensor<1xi8>) -> tensor<1x1x8960xf32>
    %194 = tosa.reshape %193, %3 : (tensor<1x1x8960xf32>, !tosa.shape<2>) -> tensor<1x8960xf32>
    %195 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%194, %arg32 : tensor<1x8960xf32>, tensor<8960x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %196 = tosa.reshape %195, %13 : (tensor<1x1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %197 = tosa.add %175, %196 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %198 = tensor.empty() : tensor<1x1x1536xf32>
    %199 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%197 : tensor<1x1x1536xf32>) outs(%198 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2290 = math.fpowi %in, %c2_i32 : f32, i32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1536xf32>
    %200 = tosa.reduce_sum %199 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %201 = tosa.mul %200, %0, %15 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1xf32>
    %202 = tosa.add %201, %14 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %203 = tosa.rsqrt %202 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %204 = tosa.mul %197, %203, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %205 = tosa.reshape %arg33, %13 : (tensor<1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %206 = tosa.mul %205, %204, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %207 = tosa.reshape %206, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %208 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%207, %arg35 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %209 = tosa.reshape %arg34, %12 : (tensor<1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %210 = tosa.add %209, %208 : (tensor<1x1536xf32>, tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %211 = tosa.reshape %210, %11 : (tensor<1x1536xf32>, !tosa.shape<4>) -> tensor<1x12x1x128xf32>
    %212 = tosa.reshape %206, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %213 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%212, %arg37 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_8 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %214 = tosa.reshape %arg36, %10 : (tensor<256xf32>, !tosa.shape<2>) -> tensor<1x256xf32>
    %215 = tosa.add %214, %213 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %216 = tosa.reshape %215, %9 : (tensor<1x256xf32>, !tosa.shape<4>) -> tensor<1x2x1x128xf32>
    %217 = tosa.reshape %206, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %218 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%217, %arg39 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_8 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %219 = tosa.reshape %arg38, %10 : (tensor<256xf32>, !tosa.shape<2>) -> tensor<1x256xf32>
    %220 = tosa.add %219, %218 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %221 = tosa.reshape %220, %9 : (tensor<1x256xf32>, !tosa.shape<4>) -> tensor<1x2x1x128xf32>
    %222 = tosa.reshape %36, %8 : (tensor<1x1x128xf32>, !tosa.shape<4>) -> tensor<1x1x1x128xf32>
    %223 = tosa.reshape %37, %8 : (tensor<1x1x128xf32>, !tosa.shape<4>) -> tensor<1x1x1x128xf32>
    %224 = tosa.mul %211, %222, %15 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x12x1x128xf32>
    %extracted_slice_29 = tensor.extract_slice %211[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %extracted_slice_30 = tensor.extract_slice %211[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %225 = tosa.negate %extracted_slice_30, %19, %19 : (tensor<1x12x1x64xf32>, tensor<1xf32>, tensor<1xf32>) -> tensor<1x12x1x64xf32>
    %226 = tensor.empty() : tensor<1x12x1x128xf32>
    %inserted_slice_31 = tensor.insert_slice %225 into %226[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %inserted_slice_32 = tensor.insert_slice %extracted_slice_29 into %inserted_slice_31[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %227 = tosa.mul %inserted_slice_32, %223, %15 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x12x1x128xf32>
    %228 = tosa.add %224, %227 : (tensor<1x12x1x128xf32>, tensor<1x12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %229 = tosa.mul %216, %222, %15 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x2x1x128xf32>
    %extracted_slice_33 = tensor.extract_slice %216[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %extracted_slice_34 = tensor.extract_slice %216[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %230 = tosa.negate %extracted_slice_34, %19, %19 : (tensor<1x2x1x64xf32>, tensor<1xf32>, tensor<1xf32>) -> tensor<1x2x1x64xf32>
    %231 = tensor.empty() : tensor<1x2x1x128xf32>
    %inserted_slice_35 = tensor.insert_slice %230 into %231[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %inserted_slice_36 = tensor.insert_slice %extracted_slice_33 into %inserted_slice_35[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %232 = tosa.mul %inserted_slice_36, %223, %15 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x2x1x128xf32>
    %233 = tosa.add %229, %232 : (tensor<1x2x1x128xf32>, tensor<1x2x1x128xf32>) -> tensor<1x2x1x128xf32>
    %234 = bufferization.to_buffer %arg40 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %235 = tosa.reshape %arg3, %7 : (tensor<1xi64>, !tosa.shape<4>) -> tensor<1x1x1x1xi64>
    %236 = tosa.add %235, %6 : (tensor<1x1x1x1xi64>, tensor<1x2x1x128xi64>) -> tensor<1x2x1x128xi64>
    %237 = bufferization.to_buffer %236 : tensor<1x2x1x128xi64> to memref<1x2x1x128xi64>
    %238 = bufferization.to_buffer %233 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    scf.for %arg399 = %c0 to %c1 step %c1 {
      scf.for %arg400 = %c0 to %c2 step %c1 {
        scf.for %arg401 = %c0 to %c1 step %c1 {
          scf.for %arg402 = %c0 to %c128 step %c1 {
            %2290 = memref.load %238[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            %2291 = memref.load %237[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xi64>
            %2292 = arith.index_cast %2291 : i64 to index
            memref.store %2290, %234[%arg399, %arg400, %2292, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %239 = bufferization.to_tensor %234 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %240 = bufferization.to_buffer %arg41 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %241 = tosa.reshape %arg3, %7 : (tensor<1xi64>, !tosa.shape<4>) -> tensor<1x1x1x1xi64>
    %242 = tosa.add %241, %6 : (tensor<1x1x1x1xi64>, tensor<1x2x1x128xi64>) -> tensor<1x2x1x128xi64>
    %243 = bufferization.to_buffer %242 : tensor<1x2x1x128xi64> to memref<1x2x1x128xi64>
    %244 = bufferization.to_buffer %221 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    scf.for %arg399 = %c0 to %c1 step %c1 {
      scf.for %arg400 = %c0 to %c2 step %c1 {
        scf.for %arg401 = %c0 to %c1 step %c1 {
          scf.for %arg402 = %c0 to %c128 step %c1 {
            %2290 = memref.load %244[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            %2291 = memref.load %243[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xi64>
            %2292 = arith.index_cast %2291 : i64 to index
            memref.store %2290, %240[%arg399, %arg400, %2292, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %245 = bufferization.to_tensor %240 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %246 = tosa.reshape %28, %5 : (tensor<1x1024xi1>, !tosa.shape<4>) -> tensor<1x1x1x1024xi1>
    %247 = tensor.empty() : tensor<1x1x1x1024xf32>
    %248 = linalg.generic {indexing_maps = [#map1, #map1, #map1, #map1], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%246, %cst_1, %cst_0 : tensor<1x1x1x1024xi1>, tensor<1x1x1x1024xf32>, tensor<1x1x1x1024xf32>) outs(%247 : tensor<1x1x1x1024xf32>) {
    ^bb0(%in: i1, %in_315: f32, %in_316: f32, %out: f32):
      %2290 = arith.select %in, %in_315, %in_316 : f32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1x1024xf32>
    %249 = bufferization.to_buffer %228 : tensor<1x12x1x128xf32> to memref<1x12x1x128xf32>
    %250 = bufferization.to_buffer %248 : tensor<1x1x1x1024xf32> to memref<1x1x1x1024xf32>
    %alloc_37 = memref.alloc() : memref<1x12x1x128xf32>
    %alloc_38 = memref.alloc() : memref<1x12x1xf32>
    %alloc_39 = memref.alloc() : memref<128xf32>
    affine.for %arg399 = 0 to 1 {
      affine.for %arg400 = 0 to 12 {
        %2290 = arith.divsi %arg400, %c6 : index
        affine.for %arg401 = 0 to 1 {
          affine.for %arg402 = 0 to 128 {
            memref.store %cst_7, %alloc_39[%arg402] : memref<128xf32>
          }
          %2291:2 = affine.for %arg402 = 0 to 1024 iter_args(%arg403 = %cst_4, %arg404 = %cst_7) -> (f32, f32) {
            %2292 = affine.for %arg405 = 0 to 128 step 16 iter_args(%arg406 = %cst) -> (vector<16xf32>) {
              %2307 = vector.load %249[%arg399, %arg400, %arg401, %arg405] : memref<1x12x1x128xf32>, vector<16xf32>
              %2308 = vector.load %234[%arg399, %2290, %arg402, %arg405] : memref<1x2x1024x128xf32>, vector<16xf32>
              %2309 = vector.fma %2307, %2308, %arg406 : vector<16xf32>
              affine.yield %2309 : vector<16xf32>
            }
            %2293 = vector.reduction <add>, %2292 : vector<16xf32> into f32
            %2294 = arith.mulf %2293, %cst_5 : f32
            %2295 = memref.load %250[%arg399, %c0, %arg401, %arg402] : memref<1x1x1x1024xf32>
            %2296 = arith.addf %2294, %2295 : f32
            %2297 = arith.cmpf ogt, %2296, %arg403 : f32
            %2298 = arith.select %2297, %2296, %arg403 : f32
            %2299 = arith.subf %arg403, %2296 : f32
            %2300 = math.exp %2299 : f32
            %2301 = arith.mulf %2300, %arg404 : f32
            %2302 = arith.addf %2301, %cst_6 : f32
            %2303 = arith.subf %2296, %arg403 : f32
            %2304 = math.exp %2303 : f32
            %2305 = arith.addf %arg404, %2304 : f32
            %2306 = arith.select %2297, %2302, %2305 : f32
            affine.for %arg405 = 0 to 128 {
              %2307 = memref.load %240[%arg399, %2290, %arg402, %arg405] : memref<1x2x1024x128xf32>
              %2308 = memref.load %alloc_39[%arg405] : memref<128xf32>
              %2309 = arith.mulf %2308, %2300 : f32
              %2310 = arith.addf %2309, %2307 : f32
              %2311 = arith.mulf %2304, %2307 : f32
              %2312 = arith.addf %2311, %2308 : f32
              %2313 = arith.select %2297, %2310, %2312 : f32
              memref.store %2313, %alloc_39[%arg405] : memref<128xf32>
            }
            affine.yield %2298, %2306 : f32, f32
          }
          memref.store %2291#1, %alloc_38[%arg399, %arg400, %arg401] : memref<1x12x1xf32>
          affine.for %arg402 = 0 to 128 {
            %2292 = memref.load %alloc_39[%arg402] : memref<128xf32>
            %2293 = arith.divf %2292, %2291#1 : f32
            memref.store %2293, %alloc_37[%arg399, %arg400, %arg401, %arg402] : memref<1x12x1x128xf32>
          }
        }
      }
    }
    %251 = bufferization.to_tensor %alloc_37 restrict : memref<1x12x1x128xf32> to tensor<1x12x1x128xf32>
    %252 = tosa.reshape %251, %12 : (tensor<1x12x1x128xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %253 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%252, %arg42 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %254 = tosa.reshape %253, %13 : (tensor<1x1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %255 = tosa.add %197, %254 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %256 = tensor.empty() : tensor<1x1x1536xf32>
    %257 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%255 : tensor<1x1x1536xf32>) outs(%256 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2290 = math.fpowi %in, %c2_i32 : f32, i32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1536xf32>
    %258 = tosa.reduce_sum %257 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %259 = tosa.mul %258, %0, %15 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1xf32>
    %260 = tosa.add %259, %14 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %261 = tosa.rsqrt %260 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %262 = tosa.mul %255, %261, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %263 = tosa.reshape %arg43, %13 : (tensor<1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %264 = tosa.mul %263, %262, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %265 = tosa.reshape %264, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %266 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%265, %arg44 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_3 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %267 = tosa.reshape %266, %4 : (tensor<1x8960xf32>, !tosa.shape<3>) -> tensor<1x1x8960xf32>
    %268 = tosa.sigmoid %267 : (tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %269 = tosa.mul %267, %268, %15 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>, tensor<1xi8>) -> tensor<1x1x8960xf32>
    %270 = tosa.reshape %264, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %271 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%270, %arg45 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_3 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %272 = tosa.reshape %271, %4 : (tensor<1x8960xf32>, !tosa.shape<3>) -> tensor<1x1x8960xf32>
    %273 = tosa.mul %269, %272, %15 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>, tensor<1xi8>) -> tensor<1x1x8960xf32>
    %274 = tosa.reshape %273, %3 : (tensor<1x1x8960xf32>, !tosa.shape<2>) -> tensor<1x8960xf32>
    %275 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%274, %arg46 : tensor<1x8960xf32>, tensor<8960x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %276 = tosa.reshape %275, %13 : (tensor<1x1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %277 = tosa.add %255, %276 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %278 = tensor.empty() : tensor<1x1x1536xf32>
    %279 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%277 : tensor<1x1x1536xf32>) outs(%278 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2290 = math.fpowi %in, %c2_i32 : f32, i32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1536xf32>
    %280 = tosa.reduce_sum %279 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %281 = tosa.mul %280, %0, %15 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1xf32>
    %282 = tosa.add %281, %14 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %283 = tosa.rsqrt %282 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %284 = tosa.mul %277, %283, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %285 = tosa.reshape %arg47, %13 : (tensor<1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %286 = tosa.mul %285, %284, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %287 = tosa.reshape %286, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %288 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%287, %arg49 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %289 = tosa.reshape %arg48, %12 : (tensor<1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %290 = tosa.add %289, %288 : (tensor<1x1536xf32>, tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %291 = tosa.reshape %290, %11 : (tensor<1x1536xf32>, !tosa.shape<4>) -> tensor<1x12x1x128xf32>
    %292 = tosa.reshape %286, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %293 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%292, %arg51 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_8 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %294 = tosa.reshape %arg50, %10 : (tensor<256xf32>, !tosa.shape<2>) -> tensor<1x256xf32>
    %295 = tosa.add %294, %293 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %296 = tosa.reshape %295, %9 : (tensor<1x256xf32>, !tosa.shape<4>) -> tensor<1x2x1x128xf32>
    %297 = tosa.reshape %286, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %298 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%297, %arg53 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_8 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %299 = tosa.reshape %arg52, %10 : (tensor<256xf32>, !tosa.shape<2>) -> tensor<1x256xf32>
    %300 = tosa.add %299, %298 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %301 = tosa.reshape %300, %9 : (tensor<1x256xf32>, !tosa.shape<4>) -> tensor<1x2x1x128xf32>
    %302 = tosa.reshape %36, %8 : (tensor<1x1x128xf32>, !tosa.shape<4>) -> tensor<1x1x1x128xf32>
    %303 = tosa.reshape %37, %8 : (tensor<1x1x128xf32>, !tosa.shape<4>) -> tensor<1x1x1x128xf32>
    %304 = tosa.mul %291, %302, %15 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x12x1x128xf32>
    %extracted_slice_40 = tensor.extract_slice %291[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %extracted_slice_41 = tensor.extract_slice %291[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %305 = tosa.negate %extracted_slice_41, %19, %19 : (tensor<1x12x1x64xf32>, tensor<1xf32>, tensor<1xf32>) -> tensor<1x12x1x64xf32>
    %306 = tensor.empty() : tensor<1x12x1x128xf32>
    %inserted_slice_42 = tensor.insert_slice %305 into %306[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %inserted_slice_43 = tensor.insert_slice %extracted_slice_40 into %inserted_slice_42[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %307 = tosa.mul %inserted_slice_43, %303, %15 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x12x1x128xf32>
    %308 = tosa.add %304, %307 : (tensor<1x12x1x128xf32>, tensor<1x12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %309 = tosa.mul %296, %302, %15 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x2x1x128xf32>
    %extracted_slice_44 = tensor.extract_slice %296[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %extracted_slice_45 = tensor.extract_slice %296[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %310 = tosa.negate %extracted_slice_45, %19, %19 : (tensor<1x2x1x64xf32>, tensor<1xf32>, tensor<1xf32>) -> tensor<1x2x1x64xf32>
    %311 = tensor.empty() : tensor<1x2x1x128xf32>
    %inserted_slice_46 = tensor.insert_slice %310 into %311[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %inserted_slice_47 = tensor.insert_slice %extracted_slice_44 into %inserted_slice_46[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %312 = tosa.mul %inserted_slice_47, %303, %15 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x2x1x128xf32>
    %313 = tosa.add %309, %312 : (tensor<1x2x1x128xf32>, tensor<1x2x1x128xf32>) -> tensor<1x2x1x128xf32>
    %314 = bufferization.to_buffer %arg54 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %315 = tosa.reshape %arg3, %7 : (tensor<1xi64>, !tosa.shape<4>) -> tensor<1x1x1x1xi64>
    %316 = tosa.add %315, %6 : (tensor<1x1x1x1xi64>, tensor<1x2x1x128xi64>) -> tensor<1x2x1x128xi64>
    %317 = bufferization.to_buffer %316 : tensor<1x2x1x128xi64> to memref<1x2x1x128xi64>
    %318 = bufferization.to_buffer %313 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    scf.for %arg399 = %c0 to %c1 step %c1 {
      scf.for %arg400 = %c0 to %c2 step %c1 {
        scf.for %arg401 = %c0 to %c1 step %c1 {
          scf.for %arg402 = %c0 to %c128 step %c1 {
            %2290 = memref.load %318[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            %2291 = memref.load %317[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xi64>
            %2292 = arith.index_cast %2291 : i64 to index
            memref.store %2290, %314[%arg399, %arg400, %2292, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %319 = bufferization.to_tensor %314 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %320 = bufferization.to_buffer %arg55 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %321 = tosa.reshape %arg3, %7 : (tensor<1xi64>, !tosa.shape<4>) -> tensor<1x1x1x1xi64>
    %322 = tosa.add %321, %6 : (tensor<1x1x1x1xi64>, tensor<1x2x1x128xi64>) -> tensor<1x2x1x128xi64>
    %323 = bufferization.to_buffer %322 : tensor<1x2x1x128xi64> to memref<1x2x1x128xi64>
    %324 = bufferization.to_buffer %301 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    scf.for %arg399 = %c0 to %c1 step %c1 {
      scf.for %arg400 = %c0 to %c2 step %c1 {
        scf.for %arg401 = %c0 to %c1 step %c1 {
          scf.for %arg402 = %c0 to %c128 step %c1 {
            %2290 = memref.load %324[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            %2291 = memref.load %323[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xi64>
            %2292 = arith.index_cast %2291 : i64 to index
            memref.store %2290, %320[%arg399, %arg400, %2292, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %325 = bufferization.to_tensor %320 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %326 = tosa.reshape %28, %5 : (tensor<1x1024xi1>, !tosa.shape<4>) -> tensor<1x1x1x1024xi1>
    %327 = tensor.empty() : tensor<1x1x1x1024xf32>
    %328 = linalg.generic {indexing_maps = [#map1, #map1, #map1, #map1], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%326, %cst_1, %cst_0 : tensor<1x1x1x1024xi1>, tensor<1x1x1x1024xf32>, tensor<1x1x1x1024xf32>) outs(%327 : tensor<1x1x1x1024xf32>) {
    ^bb0(%in: i1, %in_315: f32, %in_316: f32, %out: f32):
      %2290 = arith.select %in, %in_315, %in_316 : f32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1x1024xf32>
    %329 = bufferization.to_buffer %308 : tensor<1x12x1x128xf32> to memref<1x12x1x128xf32>
    %330 = bufferization.to_buffer %328 : tensor<1x1x1x1024xf32> to memref<1x1x1x1024xf32>
    %alloc_48 = memref.alloc() : memref<1x12x1x128xf32>
    %alloc_49 = memref.alloc() : memref<1x12x1xf32>
    %alloc_50 = memref.alloc() : memref<128xf32>
    affine.for %arg399 = 0 to 1 {
      affine.for %arg400 = 0 to 12 {
        %2290 = arith.divsi %arg400, %c6 : index
        affine.for %arg401 = 0 to 1 {
          affine.for %arg402 = 0 to 128 {
            memref.store %cst_7, %alloc_50[%arg402] : memref<128xf32>
          }
          %2291:2 = affine.for %arg402 = 0 to 1024 iter_args(%arg403 = %cst_4, %arg404 = %cst_7) -> (f32, f32) {
            %2292 = affine.for %arg405 = 0 to 128 step 16 iter_args(%arg406 = %cst) -> (vector<16xf32>) {
              %2307 = vector.load %329[%arg399, %arg400, %arg401, %arg405] : memref<1x12x1x128xf32>, vector<16xf32>
              %2308 = vector.load %314[%arg399, %2290, %arg402, %arg405] : memref<1x2x1024x128xf32>, vector<16xf32>
              %2309 = vector.fma %2307, %2308, %arg406 : vector<16xf32>
              affine.yield %2309 : vector<16xf32>
            }
            %2293 = vector.reduction <add>, %2292 : vector<16xf32> into f32
            %2294 = arith.mulf %2293, %cst_5 : f32
            %2295 = memref.load %330[%arg399, %c0, %arg401, %arg402] : memref<1x1x1x1024xf32>
            %2296 = arith.addf %2294, %2295 : f32
            %2297 = arith.cmpf ogt, %2296, %arg403 : f32
            %2298 = arith.select %2297, %2296, %arg403 : f32
            %2299 = arith.subf %arg403, %2296 : f32
            %2300 = math.exp %2299 : f32
            %2301 = arith.mulf %2300, %arg404 : f32
            %2302 = arith.addf %2301, %cst_6 : f32
            %2303 = arith.subf %2296, %arg403 : f32
            %2304 = math.exp %2303 : f32
            %2305 = arith.addf %arg404, %2304 : f32
            %2306 = arith.select %2297, %2302, %2305 : f32
            affine.for %arg405 = 0 to 128 {
              %2307 = memref.load %320[%arg399, %2290, %arg402, %arg405] : memref<1x2x1024x128xf32>
              %2308 = memref.load %alloc_50[%arg405] : memref<128xf32>
              %2309 = arith.mulf %2308, %2300 : f32
              %2310 = arith.addf %2309, %2307 : f32
              %2311 = arith.mulf %2304, %2307 : f32
              %2312 = arith.addf %2311, %2308 : f32
              %2313 = arith.select %2297, %2310, %2312 : f32
              memref.store %2313, %alloc_50[%arg405] : memref<128xf32>
            }
            affine.yield %2298, %2306 : f32, f32
          }
          memref.store %2291#1, %alloc_49[%arg399, %arg400, %arg401] : memref<1x12x1xf32>
          affine.for %arg402 = 0 to 128 {
            %2292 = memref.load %alloc_50[%arg402] : memref<128xf32>
            %2293 = arith.divf %2292, %2291#1 : f32
            memref.store %2293, %alloc_48[%arg399, %arg400, %arg401, %arg402] : memref<1x12x1x128xf32>
          }
        }
      }
    }
    %331 = bufferization.to_tensor %alloc_48 restrict : memref<1x12x1x128xf32> to tensor<1x12x1x128xf32>
    %332 = tosa.reshape %331, %12 : (tensor<1x12x1x128xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %333 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%332, %arg56 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %334 = tosa.reshape %333, %13 : (tensor<1x1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %335 = tosa.add %277, %334 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %336 = tensor.empty() : tensor<1x1x1536xf32>
    %337 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%335 : tensor<1x1x1536xf32>) outs(%336 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2290 = math.fpowi %in, %c2_i32 : f32, i32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1536xf32>
    %338 = tosa.reduce_sum %337 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %339 = tosa.mul %338, %0, %15 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1xf32>
    %340 = tosa.add %339, %14 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %341 = tosa.rsqrt %340 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %342 = tosa.mul %335, %341, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %343 = tosa.reshape %arg57, %13 : (tensor<1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %344 = tosa.mul %343, %342, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %345 = tosa.reshape %344, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %346 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%345, %arg58 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_3 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %347 = tosa.reshape %346, %4 : (tensor<1x8960xf32>, !tosa.shape<3>) -> tensor<1x1x8960xf32>
    %348 = tosa.sigmoid %347 : (tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %349 = tosa.mul %347, %348, %15 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>, tensor<1xi8>) -> tensor<1x1x8960xf32>
    %350 = tosa.reshape %344, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %351 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%350, %arg59 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_3 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %352 = tosa.reshape %351, %4 : (tensor<1x8960xf32>, !tosa.shape<3>) -> tensor<1x1x8960xf32>
    %353 = tosa.mul %349, %352, %15 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>, tensor<1xi8>) -> tensor<1x1x8960xf32>
    %354 = tosa.reshape %353, %3 : (tensor<1x1x8960xf32>, !tosa.shape<2>) -> tensor<1x8960xf32>
    %355 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%354, %arg60 : tensor<1x8960xf32>, tensor<8960x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %356 = tosa.reshape %355, %13 : (tensor<1x1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %357 = tosa.add %335, %356 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %358 = tensor.empty() : tensor<1x1x1536xf32>
    %359 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%357 : tensor<1x1x1536xf32>) outs(%358 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2290 = math.fpowi %in, %c2_i32 : f32, i32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1536xf32>
    %360 = tosa.reduce_sum %359 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %361 = tosa.mul %360, %0, %15 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1xf32>
    %362 = tosa.add %361, %14 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %363 = tosa.rsqrt %362 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %364 = tosa.mul %357, %363, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %365 = tosa.reshape %arg61, %13 : (tensor<1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %366 = tosa.mul %365, %364, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %367 = tosa.reshape %366, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %368 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%367, %arg63 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %369 = tosa.reshape %arg62, %12 : (tensor<1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %370 = tosa.add %369, %368 : (tensor<1x1536xf32>, tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %371 = tosa.reshape %370, %11 : (tensor<1x1536xf32>, !tosa.shape<4>) -> tensor<1x12x1x128xf32>
    %372 = tosa.reshape %366, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %373 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%372, %arg65 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_8 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %374 = tosa.reshape %arg64, %10 : (tensor<256xf32>, !tosa.shape<2>) -> tensor<1x256xf32>
    %375 = tosa.add %374, %373 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %376 = tosa.reshape %375, %9 : (tensor<1x256xf32>, !tosa.shape<4>) -> tensor<1x2x1x128xf32>
    %377 = tosa.reshape %366, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %378 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%377, %arg67 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_8 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %379 = tosa.reshape %arg66, %10 : (tensor<256xf32>, !tosa.shape<2>) -> tensor<1x256xf32>
    %380 = tosa.add %379, %378 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %381 = tosa.reshape %380, %9 : (tensor<1x256xf32>, !tosa.shape<4>) -> tensor<1x2x1x128xf32>
    %382 = tosa.reshape %36, %8 : (tensor<1x1x128xf32>, !tosa.shape<4>) -> tensor<1x1x1x128xf32>
    %383 = tosa.reshape %37, %8 : (tensor<1x1x128xf32>, !tosa.shape<4>) -> tensor<1x1x1x128xf32>
    %384 = tosa.mul %371, %382, %15 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x12x1x128xf32>
    %extracted_slice_51 = tensor.extract_slice %371[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %extracted_slice_52 = tensor.extract_slice %371[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %385 = tosa.negate %extracted_slice_52, %19, %19 : (tensor<1x12x1x64xf32>, tensor<1xf32>, tensor<1xf32>) -> tensor<1x12x1x64xf32>
    %386 = tensor.empty() : tensor<1x12x1x128xf32>
    %inserted_slice_53 = tensor.insert_slice %385 into %386[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %inserted_slice_54 = tensor.insert_slice %extracted_slice_51 into %inserted_slice_53[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %387 = tosa.mul %inserted_slice_54, %383, %15 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x12x1x128xf32>
    %388 = tosa.add %384, %387 : (tensor<1x12x1x128xf32>, tensor<1x12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %389 = tosa.mul %376, %382, %15 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x2x1x128xf32>
    %extracted_slice_55 = tensor.extract_slice %376[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %extracted_slice_56 = tensor.extract_slice %376[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %390 = tosa.negate %extracted_slice_56, %19, %19 : (tensor<1x2x1x64xf32>, tensor<1xf32>, tensor<1xf32>) -> tensor<1x2x1x64xf32>
    %391 = tensor.empty() : tensor<1x2x1x128xf32>
    %inserted_slice_57 = tensor.insert_slice %390 into %391[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %inserted_slice_58 = tensor.insert_slice %extracted_slice_55 into %inserted_slice_57[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %392 = tosa.mul %inserted_slice_58, %383, %15 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x2x1x128xf32>
    %393 = tosa.add %389, %392 : (tensor<1x2x1x128xf32>, tensor<1x2x1x128xf32>) -> tensor<1x2x1x128xf32>
    %394 = bufferization.to_buffer %arg68 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %395 = tosa.reshape %arg3, %7 : (tensor<1xi64>, !tosa.shape<4>) -> tensor<1x1x1x1xi64>
    %396 = tosa.add %395, %6 : (tensor<1x1x1x1xi64>, tensor<1x2x1x128xi64>) -> tensor<1x2x1x128xi64>
    %397 = bufferization.to_buffer %396 : tensor<1x2x1x128xi64> to memref<1x2x1x128xi64>
    %398 = bufferization.to_buffer %393 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    scf.for %arg399 = %c0 to %c1 step %c1 {
      scf.for %arg400 = %c0 to %c2 step %c1 {
        scf.for %arg401 = %c0 to %c1 step %c1 {
          scf.for %arg402 = %c0 to %c128 step %c1 {
            %2290 = memref.load %398[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            %2291 = memref.load %397[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xi64>
            %2292 = arith.index_cast %2291 : i64 to index
            memref.store %2290, %394[%arg399, %arg400, %2292, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %399 = bufferization.to_tensor %394 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %400 = bufferization.to_buffer %arg69 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %401 = tosa.reshape %arg3, %7 : (tensor<1xi64>, !tosa.shape<4>) -> tensor<1x1x1x1xi64>
    %402 = tosa.add %401, %6 : (tensor<1x1x1x1xi64>, tensor<1x2x1x128xi64>) -> tensor<1x2x1x128xi64>
    %403 = bufferization.to_buffer %402 : tensor<1x2x1x128xi64> to memref<1x2x1x128xi64>
    %404 = bufferization.to_buffer %381 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    scf.for %arg399 = %c0 to %c1 step %c1 {
      scf.for %arg400 = %c0 to %c2 step %c1 {
        scf.for %arg401 = %c0 to %c1 step %c1 {
          scf.for %arg402 = %c0 to %c128 step %c1 {
            %2290 = memref.load %404[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            %2291 = memref.load %403[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xi64>
            %2292 = arith.index_cast %2291 : i64 to index
            memref.store %2290, %400[%arg399, %arg400, %2292, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %405 = bufferization.to_tensor %400 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %406 = tosa.reshape %28, %5 : (tensor<1x1024xi1>, !tosa.shape<4>) -> tensor<1x1x1x1024xi1>
    %407 = tensor.empty() : tensor<1x1x1x1024xf32>
    %408 = linalg.generic {indexing_maps = [#map1, #map1, #map1, #map1], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%406, %cst_1, %cst_0 : tensor<1x1x1x1024xi1>, tensor<1x1x1x1024xf32>, tensor<1x1x1x1024xf32>) outs(%407 : tensor<1x1x1x1024xf32>) {
    ^bb0(%in: i1, %in_315: f32, %in_316: f32, %out: f32):
      %2290 = arith.select %in, %in_315, %in_316 : f32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1x1024xf32>
    %409 = bufferization.to_buffer %388 : tensor<1x12x1x128xf32> to memref<1x12x1x128xf32>
    %410 = bufferization.to_buffer %408 : tensor<1x1x1x1024xf32> to memref<1x1x1x1024xf32>
    %alloc_59 = memref.alloc() : memref<1x12x1x128xf32>
    %alloc_60 = memref.alloc() : memref<1x12x1xf32>
    %alloc_61 = memref.alloc() : memref<128xf32>
    affine.for %arg399 = 0 to 1 {
      affine.for %arg400 = 0 to 12 {
        %2290 = arith.divsi %arg400, %c6 : index
        affine.for %arg401 = 0 to 1 {
          affine.for %arg402 = 0 to 128 {
            memref.store %cst_7, %alloc_61[%arg402] : memref<128xf32>
          }
          %2291:2 = affine.for %arg402 = 0 to 1024 iter_args(%arg403 = %cst_4, %arg404 = %cst_7) -> (f32, f32) {
            %2292 = affine.for %arg405 = 0 to 128 step 16 iter_args(%arg406 = %cst) -> (vector<16xf32>) {
              %2307 = vector.load %409[%arg399, %arg400, %arg401, %arg405] : memref<1x12x1x128xf32>, vector<16xf32>
              %2308 = vector.load %394[%arg399, %2290, %arg402, %arg405] : memref<1x2x1024x128xf32>, vector<16xf32>
              %2309 = vector.fma %2307, %2308, %arg406 : vector<16xf32>
              affine.yield %2309 : vector<16xf32>
            }
            %2293 = vector.reduction <add>, %2292 : vector<16xf32> into f32
            %2294 = arith.mulf %2293, %cst_5 : f32
            %2295 = memref.load %410[%arg399, %c0, %arg401, %arg402] : memref<1x1x1x1024xf32>
            %2296 = arith.addf %2294, %2295 : f32
            %2297 = arith.cmpf ogt, %2296, %arg403 : f32
            %2298 = arith.select %2297, %2296, %arg403 : f32
            %2299 = arith.subf %arg403, %2296 : f32
            %2300 = math.exp %2299 : f32
            %2301 = arith.mulf %2300, %arg404 : f32
            %2302 = arith.addf %2301, %cst_6 : f32
            %2303 = arith.subf %2296, %arg403 : f32
            %2304 = math.exp %2303 : f32
            %2305 = arith.addf %arg404, %2304 : f32
            %2306 = arith.select %2297, %2302, %2305 : f32
            affine.for %arg405 = 0 to 128 {
              %2307 = memref.load %400[%arg399, %2290, %arg402, %arg405] : memref<1x2x1024x128xf32>
              %2308 = memref.load %alloc_61[%arg405] : memref<128xf32>
              %2309 = arith.mulf %2308, %2300 : f32
              %2310 = arith.addf %2309, %2307 : f32
              %2311 = arith.mulf %2304, %2307 : f32
              %2312 = arith.addf %2311, %2308 : f32
              %2313 = arith.select %2297, %2310, %2312 : f32
              memref.store %2313, %alloc_61[%arg405] : memref<128xf32>
            }
            affine.yield %2298, %2306 : f32, f32
          }
          memref.store %2291#1, %alloc_60[%arg399, %arg400, %arg401] : memref<1x12x1xf32>
          affine.for %arg402 = 0 to 128 {
            %2292 = memref.load %alloc_61[%arg402] : memref<128xf32>
            %2293 = arith.divf %2292, %2291#1 : f32
            memref.store %2293, %alloc_59[%arg399, %arg400, %arg401, %arg402] : memref<1x12x1x128xf32>
          }
        }
      }
    }
    %411 = bufferization.to_tensor %alloc_59 restrict : memref<1x12x1x128xf32> to tensor<1x12x1x128xf32>
    %412 = tosa.reshape %411, %12 : (tensor<1x12x1x128xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %413 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%412, %arg70 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %414 = tosa.reshape %413, %13 : (tensor<1x1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %415 = tosa.add %357, %414 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %416 = tensor.empty() : tensor<1x1x1536xf32>
    %417 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%415 : tensor<1x1x1536xf32>) outs(%416 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2290 = math.fpowi %in, %c2_i32 : f32, i32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1536xf32>
    %418 = tosa.reduce_sum %417 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %419 = tosa.mul %418, %0, %15 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1xf32>
    %420 = tosa.add %419, %14 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %421 = tosa.rsqrt %420 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %422 = tosa.mul %415, %421, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %423 = tosa.reshape %arg71, %13 : (tensor<1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %424 = tosa.mul %423, %422, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %425 = tosa.reshape %424, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %426 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%425, %arg72 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_3 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %427 = tosa.reshape %426, %4 : (tensor<1x8960xf32>, !tosa.shape<3>) -> tensor<1x1x8960xf32>
    %428 = tosa.sigmoid %427 : (tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %429 = tosa.mul %427, %428, %15 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>, tensor<1xi8>) -> tensor<1x1x8960xf32>
    %430 = tosa.reshape %424, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %431 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%430, %arg73 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_3 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %432 = tosa.reshape %431, %4 : (tensor<1x8960xf32>, !tosa.shape<3>) -> tensor<1x1x8960xf32>
    %433 = tosa.mul %429, %432, %15 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>, tensor<1xi8>) -> tensor<1x1x8960xf32>
    %434 = tosa.reshape %433, %3 : (tensor<1x1x8960xf32>, !tosa.shape<2>) -> tensor<1x8960xf32>
    %435 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%434, %arg74 : tensor<1x8960xf32>, tensor<8960x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %436 = tosa.reshape %435, %13 : (tensor<1x1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %437 = tosa.add %415, %436 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %438 = tensor.empty() : tensor<1x1x1536xf32>
    %439 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%437 : tensor<1x1x1536xf32>) outs(%438 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2290 = math.fpowi %in, %c2_i32 : f32, i32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1536xf32>
    %440 = tosa.reduce_sum %439 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %441 = tosa.mul %440, %0, %15 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1xf32>
    %442 = tosa.add %441, %14 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %443 = tosa.rsqrt %442 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %444 = tosa.mul %437, %443, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %445 = tosa.reshape %arg75, %13 : (tensor<1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %446 = tosa.mul %445, %444, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %447 = tosa.reshape %446, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %448 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%447, %arg77 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %449 = tosa.reshape %arg76, %12 : (tensor<1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %450 = tosa.add %449, %448 : (tensor<1x1536xf32>, tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %451 = tosa.reshape %450, %11 : (tensor<1x1536xf32>, !tosa.shape<4>) -> tensor<1x12x1x128xf32>
    %452 = tosa.reshape %446, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %453 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%452, %arg79 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_8 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %454 = tosa.reshape %arg78, %10 : (tensor<256xf32>, !tosa.shape<2>) -> tensor<1x256xf32>
    %455 = tosa.add %454, %453 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %456 = tosa.reshape %455, %9 : (tensor<1x256xf32>, !tosa.shape<4>) -> tensor<1x2x1x128xf32>
    %457 = tosa.reshape %446, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %458 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%457, %arg81 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_8 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %459 = tosa.reshape %arg80, %10 : (tensor<256xf32>, !tosa.shape<2>) -> tensor<1x256xf32>
    %460 = tosa.add %459, %458 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %461 = tosa.reshape %460, %9 : (tensor<1x256xf32>, !tosa.shape<4>) -> tensor<1x2x1x128xf32>
    %462 = tosa.reshape %36, %8 : (tensor<1x1x128xf32>, !tosa.shape<4>) -> tensor<1x1x1x128xf32>
    %463 = tosa.reshape %37, %8 : (tensor<1x1x128xf32>, !tosa.shape<4>) -> tensor<1x1x1x128xf32>
    %464 = tosa.mul %451, %462, %15 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x12x1x128xf32>
    %extracted_slice_62 = tensor.extract_slice %451[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %extracted_slice_63 = tensor.extract_slice %451[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %465 = tosa.negate %extracted_slice_63, %19, %19 : (tensor<1x12x1x64xf32>, tensor<1xf32>, tensor<1xf32>) -> tensor<1x12x1x64xf32>
    %466 = tensor.empty() : tensor<1x12x1x128xf32>
    %inserted_slice_64 = tensor.insert_slice %465 into %466[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %inserted_slice_65 = tensor.insert_slice %extracted_slice_62 into %inserted_slice_64[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %467 = tosa.mul %inserted_slice_65, %463, %15 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x12x1x128xf32>
    %468 = tosa.add %464, %467 : (tensor<1x12x1x128xf32>, tensor<1x12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %469 = tosa.mul %456, %462, %15 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x2x1x128xf32>
    %extracted_slice_66 = tensor.extract_slice %456[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %extracted_slice_67 = tensor.extract_slice %456[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %470 = tosa.negate %extracted_slice_67, %19, %19 : (tensor<1x2x1x64xf32>, tensor<1xf32>, tensor<1xf32>) -> tensor<1x2x1x64xf32>
    %471 = tensor.empty() : tensor<1x2x1x128xf32>
    %inserted_slice_68 = tensor.insert_slice %470 into %471[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %inserted_slice_69 = tensor.insert_slice %extracted_slice_66 into %inserted_slice_68[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %472 = tosa.mul %inserted_slice_69, %463, %15 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x2x1x128xf32>
    %473 = tosa.add %469, %472 : (tensor<1x2x1x128xf32>, tensor<1x2x1x128xf32>) -> tensor<1x2x1x128xf32>
    %474 = bufferization.to_buffer %arg82 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %475 = tosa.reshape %arg3, %7 : (tensor<1xi64>, !tosa.shape<4>) -> tensor<1x1x1x1xi64>
    %476 = tosa.add %475, %6 : (tensor<1x1x1x1xi64>, tensor<1x2x1x128xi64>) -> tensor<1x2x1x128xi64>
    %477 = bufferization.to_buffer %476 : tensor<1x2x1x128xi64> to memref<1x2x1x128xi64>
    %478 = bufferization.to_buffer %473 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    scf.for %arg399 = %c0 to %c1 step %c1 {
      scf.for %arg400 = %c0 to %c2 step %c1 {
        scf.for %arg401 = %c0 to %c1 step %c1 {
          scf.for %arg402 = %c0 to %c128 step %c1 {
            %2290 = memref.load %478[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            %2291 = memref.load %477[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xi64>
            %2292 = arith.index_cast %2291 : i64 to index
            memref.store %2290, %474[%arg399, %arg400, %2292, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %479 = bufferization.to_tensor %474 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %480 = bufferization.to_buffer %arg83 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %481 = tosa.reshape %arg3, %7 : (tensor<1xi64>, !tosa.shape<4>) -> tensor<1x1x1x1xi64>
    %482 = tosa.add %481, %6 : (tensor<1x1x1x1xi64>, tensor<1x2x1x128xi64>) -> tensor<1x2x1x128xi64>
    %483 = bufferization.to_buffer %482 : tensor<1x2x1x128xi64> to memref<1x2x1x128xi64>
    %484 = bufferization.to_buffer %461 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    scf.for %arg399 = %c0 to %c1 step %c1 {
      scf.for %arg400 = %c0 to %c2 step %c1 {
        scf.for %arg401 = %c0 to %c1 step %c1 {
          scf.for %arg402 = %c0 to %c128 step %c1 {
            %2290 = memref.load %484[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            %2291 = memref.load %483[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xi64>
            %2292 = arith.index_cast %2291 : i64 to index
            memref.store %2290, %480[%arg399, %arg400, %2292, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %485 = bufferization.to_tensor %480 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %486 = tosa.reshape %28, %5 : (tensor<1x1024xi1>, !tosa.shape<4>) -> tensor<1x1x1x1024xi1>
    %487 = tensor.empty() : tensor<1x1x1x1024xf32>
    %488 = linalg.generic {indexing_maps = [#map1, #map1, #map1, #map1], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%486, %cst_1, %cst_0 : tensor<1x1x1x1024xi1>, tensor<1x1x1x1024xf32>, tensor<1x1x1x1024xf32>) outs(%487 : tensor<1x1x1x1024xf32>) {
    ^bb0(%in: i1, %in_315: f32, %in_316: f32, %out: f32):
      %2290 = arith.select %in, %in_315, %in_316 : f32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1x1024xf32>
    %489 = bufferization.to_buffer %468 : tensor<1x12x1x128xf32> to memref<1x12x1x128xf32>
    %490 = bufferization.to_buffer %488 : tensor<1x1x1x1024xf32> to memref<1x1x1x1024xf32>
    %alloc_70 = memref.alloc() : memref<1x12x1x128xf32>
    %alloc_71 = memref.alloc() : memref<1x12x1xf32>
    %alloc_72 = memref.alloc() : memref<128xf32>
    affine.for %arg399 = 0 to 1 {
      affine.for %arg400 = 0 to 12 {
        %2290 = arith.divsi %arg400, %c6 : index
        affine.for %arg401 = 0 to 1 {
          affine.for %arg402 = 0 to 128 {
            memref.store %cst_7, %alloc_72[%arg402] : memref<128xf32>
          }
          %2291:2 = affine.for %arg402 = 0 to 1024 iter_args(%arg403 = %cst_4, %arg404 = %cst_7) -> (f32, f32) {
            %2292 = affine.for %arg405 = 0 to 128 step 16 iter_args(%arg406 = %cst) -> (vector<16xf32>) {
              %2307 = vector.load %489[%arg399, %arg400, %arg401, %arg405] : memref<1x12x1x128xf32>, vector<16xf32>
              %2308 = vector.load %474[%arg399, %2290, %arg402, %arg405] : memref<1x2x1024x128xf32>, vector<16xf32>
              %2309 = vector.fma %2307, %2308, %arg406 : vector<16xf32>
              affine.yield %2309 : vector<16xf32>
            }
            %2293 = vector.reduction <add>, %2292 : vector<16xf32> into f32
            %2294 = arith.mulf %2293, %cst_5 : f32
            %2295 = memref.load %490[%arg399, %c0, %arg401, %arg402] : memref<1x1x1x1024xf32>
            %2296 = arith.addf %2294, %2295 : f32
            %2297 = arith.cmpf ogt, %2296, %arg403 : f32
            %2298 = arith.select %2297, %2296, %arg403 : f32
            %2299 = arith.subf %arg403, %2296 : f32
            %2300 = math.exp %2299 : f32
            %2301 = arith.mulf %2300, %arg404 : f32
            %2302 = arith.addf %2301, %cst_6 : f32
            %2303 = arith.subf %2296, %arg403 : f32
            %2304 = math.exp %2303 : f32
            %2305 = arith.addf %arg404, %2304 : f32
            %2306 = arith.select %2297, %2302, %2305 : f32
            affine.for %arg405 = 0 to 128 {
              %2307 = memref.load %480[%arg399, %2290, %arg402, %arg405] : memref<1x2x1024x128xf32>
              %2308 = memref.load %alloc_72[%arg405] : memref<128xf32>
              %2309 = arith.mulf %2308, %2300 : f32
              %2310 = arith.addf %2309, %2307 : f32
              %2311 = arith.mulf %2304, %2307 : f32
              %2312 = arith.addf %2311, %2308 : f32
              %2313 = arith.select %2297, %2310, %2312 : f32
              memref.store %2313, %alloc_72[%arg405] : memref<128xf32>
            }
            affine.yield %2298, %2306 : f32, f32
          }
          memref.store %2291#1, %alloc_71[%arg399, %arg400, %arg401] : memref<1x12x1xf32>
          affine.for %arg402 = 0 to 128 {
            %2292 = memref.load %alloc_72[%arg402] : memref<128xf32>
            %2293 = arith.divf %2292, %2291#1 : f32
            memref.store %2293, %alloc_70[%arg399, %arg400, %arg401, %arg402] : memref<1x12x1x128xf32>
          }
        }
      }
    }
    %491 = bufferization.to_tensor %alloc_70 restrict : memref<1x12x1x128xf32> to tensor<1x12x1x128xf32>
    %492 = tosa.reshape %491, %12 : (tensor<1x12x1x128xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %493 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%492, %arg84 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %494 = tosa.reshape %493, %13 : (tensor<1x1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %495 = tosa.add %437, %494 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %496 = tensor.empty() : tensor<1x1x1536xf32>
    %497 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%495 : tensor<1x1x1536xf32>) outs(%496 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2290 = math.fpowi %in, %c2_i32 : f32, i32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1536xf32>
    %498 = tosa.reduce_sum %497 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %499 = tosa.mul %498, %0, %15 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1xf32>
    %500 = tosa.add %499, %14 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %501 = tosa.rsqrt %500 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %502 = tosa.mul %495, %501, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %503 = tosa.reshape %arg85, %13 : (tensor<1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %504 = tosa.mul %503, %502, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %505 = tosa.reshape %504, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %506 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%505, %arg86 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_3 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %507 = tosa.reshape %506, %4 : (tensor<1x8960xf32>, !tosa.shape<3>) -> tensor<1x1x8960xf32>
    %508 = tosa.sigmoid %507 : (tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %509 = tosa.mul %507, %508, %15 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>, tensor<1xi8>) -> tensor<1x1x8960xf32>
    %510 = tosa.reshape %504, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %511 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%510, %arg87 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_3 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %512 = tosa.reshape %511, %4 : (tensor<1x8960xf32>, !tosa.shape<3>) -> tensor<1x1x8960xf32>
    %513 = tosa.mul %509, %512, %15 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>, tensor<1xi8>) -> tensor<1x1x8960xf32>
    %514 = tosa.reshape %513, %3 : (tensor<1x1x8960xf32>, !tosa.shape<2>) -> tensor<1x8960xf32>
    %515 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%514, %arg88 : tensor<1x8960xf32>, tensor<8960x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %516 = tosa.reshape %515, %13 : (tensor<1x1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %517 = tosa.add %495, %516 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %518 = tensor.empty() : tensor<1x1x1536xf32>
    %519 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%517 : tensor<1x1x1536xf32>) outs(%518 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2290 = math.fpowi %in, %c2_i32 : f32, i32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1536xf32>
    %520 = tosa.reduce_sum %519 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %521 = tosa.mul %520, %0, %15 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1xf32>
    %522 = tosa.add %521, %14 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %523 = tosa.rsqrt %522 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %524 = tosa.mul %517, %523, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %525 = tosa.reshape %arg89, %13 : (tensor<1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %526 = tosa.mul %525, %524, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %527 = tosa.reshape %526, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %528 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%527, %arg91 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %529 = tosa.reshape %arg90, %12 : (tensor<1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %530 = tosa.add %529, %528 : (tensor<1x1536xf32>, tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %531 = tosa.reshape %530, %11 : (tensor<1x1536xf32>, !tosa.shape<4>) -> tensor<1x12x1x128xf32>
    %532 = tosa.reshape %526, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %533 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%532, %arg93 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_8 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %534 = tosa.reshape %arg92, %10 : (tensor<256xf32>, !tosa.shape<2>) -> tensor<1x256xf32>
    %535 = tosa.add %534, %533 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %536 = tosa.reshape %535, %9 : (tensor<1x256xf32>, !tosa.shape<4>) -> tensor<1x2x1x128xf32>
    %537 = tosa.reshape %526, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %538 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%537, %arg95 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_8 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %539 = tosa.reshape %arg94, %10 : (tensor<256xf32>, !tosa.shape<2>) -> tensor<1x256xf32>
    %540 = tosa.add %539, %538 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %541 = tosa.reshape %540, %9 : (tensor<1x256xf32>, !tosa.shape<4>) -> tensor<1x2x1x128xf32>
    %542 = tosa.reshape %36, %8 : (tensor<1x1x128xf32>, !tosa.shape<4>) -> tensor<1x1x1x128xf32>
    %543 = tosa.reshape %37, %8 : (tensor<1x1x128xf32>, !tosa.shape<4>) -> tensor<1x1x1x128xf32>
    %544 = tosa.mul %531, %542, %15 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x12x1x128xf32>
    %extracted_slice_73 = tensor.extract_slice %531[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %extracted_slice_74 = tensor.extract_slice %531[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %545 = tosa.negate %extracted_slice_74, %19, %19 : (tensor<1x12x1x64xf32>, tensor<1xf32>, tensor<1xf32>) -> tensor<1x12x1x64xf32>
    %546 = tensor.empty() : tensor<1x12x1x128xf32>
    %inserted_slice_75 = tensor.insert_slice %545 into %546[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %inserted_slice_76 = tensor.insert_slice %extracted_slice_73 into %inserted_slice_75[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %547 = tosa.mul %inserted_slice_76, %543, %15 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x12x1x128xf32>
    %548 = tosa.add %544, %547 : (tensor<1x12x1x128xf32>, tensor<1x12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %549 = tosa.mul %536, %542, %15 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x2x1x128xf32>
    %extracted_slice_77 = tensor.extract_slice %536[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %extracted_slice_78 = tensor.extract_slice %536[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %550 = tosa.negate %extracted_slice_78, %19, %19 : (tensor<1x2x1x64xf32>, tensor<1xf32>, tensor<1xf32>) -> tensor<1x2x1x64xf32>
    %551 = tensor.empty() : tensor<1x2x1x128xf32>
    %inserted_slice_79 = tensor.insert_slice %550 into %551[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %inserted_slice_80 = tensor.insert_slice %extracted_slice_77 into %inserted_slice_79[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %552 = tosa.mul %inserted_slice_80, %543, %15 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x2x1x128xf32>
    %553 = tosa.add %549, %552 : (tensor<1x2x1x128xf32>, tensor<1x2x1x128xf32>) -> tensor<1x2x1x128xf32>
    %554 = bufferization.to_buffer %arg96 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %555 = tosa.reshape %arg3, %7 : (tensor<1xi64>, !tosa.shape<4>) -> tensor<1x1x1x1xi64>
    %556 = tosa.add %555, %6 : (tensor<1x1x1x1xi64>, tensor<1x2x1x128xi64>) -> tensor<1x2x1x128xi64>
    %557 = bufferization.to_buffer %556 : tensor<1x2x1x128xi64> to memref<1x2x1x128xi64>
    %558 = bufferization.to_buffer %553 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    scf.for %arg399 = %c0 to %c1 step %c1 {
      scf.for %arg400 = %c0 to %c2 step %c1 {
        scf.for %arg401 = %c0 to %c1 step %c1 {
          scf.for %arg402 = %c0 to %c128 step %c1 {
            %2290 = memref.load %558[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            %2291 = memref.load %557[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xi64>
            %2292 = arith.index_cast %2291 : i64 to index
            memref.store %2290, %554[%arg399, %arg400, %2292, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %559 = bufferization.to_tensor %554 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %560 = bufferization.to_buffer %arg97 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %561 = tosa.reshape %arg3, %7 : (tensor<1xi64>, !tosa.shape<4>) -> tensor<1x1x1x1xi64>
    %562 = tosa.add %561, %6 : (tensor<1x1x1x1xi64>, tensor<1x2x1x128xi64>) -> tensor<1x2x1x128xi64>
    %563 = bufferization.to_buffer %562 : tensor<1x2x1x128xi64> to memref<1x2x1x128xi64>
    %564 = bufferization.to_buffer %541 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    scf.for %arg399 = %c0 to %c1 step %c1 {
      scf.for %arg400 = %c0 to %c2 step %c1 {
        scf.for %arg401 = %c0 to %c1 step %c1 {
          scf.for %arg402 = %c0 to %c128 step %c1 {
            %2290 = memref.load %564[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            %2291 = memref.load %563[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xi64>
            %2292 = arith.index_cast %2291 : i64 to index
            memref.store %2290, %560[%arg399, %arg400, %2292, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %565 = bufferization.to_tensor %560 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %566 = tosa.reshape %28, %5 : (tensor<1x1024xi1>, !tosa.shape<4>) -> tensor<1x1x1x1024xi1>
    %567 = tensor.empty() : tensor<1x1x1x1024xf32>
    %568 = linalg.generic {indexing_maps = [#map1, #map1, #map1, #map1], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%566, %cst_1, %cst_0 : tensor<1x1x1x1024xi1>, tensor<1x1x1x1024xf32>, tensor<1x1x1x1024xf32>) outs(%567 : tensor<1x1x1x1024xf32>) {
    ^bb0(%in: i1, %in_315: f32, %in_316: f32, %out: f32):
      %2290 = arith.select %in, %in_315, %in_316 : f32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1x1024xf32>
    %569 = bufferization.to_buffer %548 : tensor<1x12x1x128xf32> to memref<1x12x1x128xf32>
    %570 = bufferization.to_buffer %568 : tensor<1x1x1x1024xf32> to memref<1x1x1x1024xf32>
    %alloc_81 = memref.alloc() : memref<1x12x1x128xf32>
    %alloc_82 = memref.alloc() : memref<1x12x1xf32>
    %alloc_83 = memref.alloc() : memref<128xf32>
    affine.for %arg399 = 0 to 1 {
      affine.for %arg400 = 0 to 12 {
        %2290 = arith.divsi %arg400, %c6 : index
        affine.for %arg401 = 0 to 1 {
          affine.for %arg402 = 0 to 128 {
            memref.store %cst_7, %alloc_83[%arg402] : memref<128xf32>
          }
          %2291:2 = affine.for %arg402 = 0 to 1024 iter_args(%arg403 = %cst_4, %arg404 = %cst_7) -> (f32, f32) {
            %2292 = affine.for %arg405 = 0 to 128 step 16 iter_args(%arg406 = %cst) -> (vector<16xf32>) {
              %2307 = vector.load %569[%arg399, %arg400, %arg401, %arg405] : memref<1x12x1x128xf32>, vector<16xf32>
              %2308 = vector.load %554[%arg399, %2290, %arg402, %arg405] : memref<1x2x1024x128xf32>, vector<16xf32>
              %2309 = vector.fma %2307, %2308, %arg406 : vector<16xf32>
              affine.yield %2309 : vector<16xf32>
            }
            %2293 = vector.reduction <add>, %2292 : vector<16xf32> into f32
            %2294 = arith.mulf %2293, %cst_5 : f32
            %2295 = memref.load %570[%arg399, %c0, %arg401, %arg402] : memref<1x1x1x1024xf32>
            %2296 = arith.addf %2294, %2295 : f32
            %2297 = arith.cmpf ogt, %2296, %arg403 : f32
            %2298 = arith.select %2297, %2296, %arg403 : f32
            %2299 = arith.subf %arg403, %2296 : f32
            %2300 = math.exp %2299 : f32
            %2301 = arith.mulf %2300, %arg404 : f32
            %2302 = arith.addf %2301, %cst_6 : f32
            %2303 = arith.subf %2296, %arg403 : f32
            %2304 = math.exp %2303 : f32
            %2305 = arith.addf %arg404, %2304 : f32
            %2306 = arith.select %2297, %2302, %2305 : f32
            affine.for %arg405 = 0 to 128 {
              %2307 = memref.load %560[%arg399, %2290, %arg402, %arg405] : memref<1x2x1024x128xf32>
              %2308 = memref.load %alloc_83[%arg405] : memref<128xf32>
              %2309 = arith.mulf %2308, %2300 : f32
              %2310 = arith.addf %2309, %2307 : f32
              %2311 = arith.mulf %2304, %2307 : f32
              %2312 = arith.addf %2311, %2308 : f32
              %2313 = arith.select %2297, %2310, %2312 : f32
              memref.store %2313, %alloc_83[%arg405] : memref<128xf32>
            }
            affine.yield %2298, %2306 : f32, f32
          }
          memref.store %2291#1, %alloc_82[%arg399, %arg400, %arg401] : memref<1x12x1xf32>
          affine.for %arg402 = 0 to 128 {
            %2292 = memref.load %alloc_83[%arg402] : memref<128xf32>
            %2293 = arith.divf %2292, %2291#1 : f32
            memref.store %2293, %alloc_81[%arg399, %arg400, %arg401, %arg402] : memref<1x12x1x128xf32>
          }
        }
      }
    }
    %571 = bufferization.to_tensor %alloc_81 restrict : memref<1x12x1x128xf32> to tensor<1x12x1x128xf32>
    %572 = tosa.reshape %571, %12 : (tensor<1x12x1x128xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %573 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%572, %arg98 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %574 = tosa.reshape %573, %13 : (tensor<1x1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %575 = tosa.add %517, %574 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %576 = tensor.empty() : tensor<1x1x1536xf32>
    %577 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%575 : tensor<1x1x1536xf32>) outs(%576 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2290 = math.fpowi %in, %c2_i32 : f32, i32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1536xf32>
    %578 = tosa.reduce_sum %577 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %579 = tosa.mul %578, %0, %15 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1xf32>
    %580 = tosa.add %579, %14 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %581 = tosa.rsqrt %580 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %582 = tosa.mul %575, %581, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %583 = tosa.reshape %arg99, %13 : (tensor<1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %584 = tosa.mul %583, %582, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %585 = tosa.reshape %584, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %586 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%585, %arg100 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_3 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %587 = tosa.reshape %586, %4 : (tensor<1x8960xf32>, !tosa.shape<3>) -> tensor<1x1x8960xf32>
    %588 = tosa.sigmoid %587 : (tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %589 = tosa.mul %587, %588, %15 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>, tensor<1xi8>) -> tensor<1x1x8960xf32>
    %590 = tosa.reshape %584, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %591 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%590, %arg101 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_3 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %592 = tosa.reshape %591, %4 : (tensor<1x8960xf32>, !tosa.shape<3>) -> tensor<1x1x8960xf32>
    %593 = tosa.mul %589, %592, %15 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>, tensor<1xi8>) -> tensor<1x1x8960xf32>
    %594 = tosa.reshape %593, %3 : (tensor<1x1x8960xf32>, !tosa.shape<2>) -> tensor<1x8960xf32>
    %595 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%594, %arg102 : tensor<1x8960xf32>, tensor<8960x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %596 = tosa.reshape %595, %13 : (tensor<1x1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %597 = tosa.add %575, %596 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %598 = tensor.empty() : tensor<1x1x1536xf32>
    %599 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%597 : tensor<1x1x1536xf32>) outs(%598 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2290 = math.fpowi %in, %c2_i32 : f32, i32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1536xf32>
    %600 = tosa.reduce_sum %599 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %601 = tosa.mul %600, %0, %15 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1xf32>
    %602 = tosa.add %601, %14 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %603 = tosa.rsqrt %602 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %604 = tosa.mul %597, %603, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %605 = tosa.reshape %arg103, %13 : (tensor<1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %606 = tosa.mul %605, %604, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %607 = tosa.reshape %606, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %608 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%607, %arg105 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %609 = tosa.reshape %arg104, %12 : (tensor<1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %610 = tosa.add %609, %608 : (tensor<1x1536xf32>, tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %611 = tosa.reshape %610, %11 : (tensor<1x1536xf32>, !tosa.shape<4>) -> tensor<1x12x1x128xf32>
    %612 = tosa.reshape %606, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %613 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%612, %arg107 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_8 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %614 = tosa.reshape %arg106, %10 : (tensor<256xf32>, !tosa.shape<2>) -> tensor<1x256xf32>
    %615 = tosa.add %614, %613 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %616 = tosa.reshape %615, %9 : (tensor<1x256xf32>, !tosa.shape<4>) -> tensor<1x2x1x128xf32>
    %617 = tosa.reshape %606, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %618 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%617, %arg109 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_8 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %619 = tosa.reshape %arg108, %10 : (tensor<256xf32>, !tosa.shape<2>) -> tensor<1x256xf32>
    %620 = tosa.add %619, %618 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %621 = tosa.reshape %620, %9 : (tensor<1x256xf32>, !tosa.shape<4>) -> tensor<1x2x1x128xf32>
    %622 = tosa.reshape %36, %8 : (tensor<1x1x128xf32>, !tosa.shape<4>) -> tensor<1x1x1x128xf32>
    %623 = tosa.reshape %37, %8 : (tensor<1x1x128xf32>, !tosa.shape<4>) -> tensor<1x1x1x128xf32>
    %624 = tosa.mul %611, %622, %15 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x12x1x128xf32>
    %extracted_slice_84 = tensor.extract_slice %611[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %extracted_slice_85 = tensor.extract_slice %611[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %625 = tosa.negate %extracted_slice_85, %19, %19 : (tensor<1x12x1x64xf32>, tensor<1xf32>, tensor<1xf32>) -> tensor<1x12x1x64xf32>
    %626 = tensor.empty() : tensor<1x12x1x128xf32>
    %inserted_slice_86 = tensor.insert_slice %625 into %626[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %inserted_slice_87 = tensor.insert_slice %extracted_slice_84 into %inserted_slice_86[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %627 = tosa.mul %inserted_slice_87, %623, %15 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x12x1x128xf32>
    %628 = tosa.add %624, %627 : (tensor<1x12x1x128xf32>, tensor<1x12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %629 = tosa.mul %616, %622, %15 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x2x1x128xf32>
    %extracted_slice_88 = tensor.extract_slice %616[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %extracted_slice_89 = tensor.extract_slice %616[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %630 = tosa.negate %extracted_slice_89, %19, %19 : (tensor<1x2x1x64xf32>, tensor<1xf32>, tensor<1xf32>) -> tensor<1x2x1x64xf32>
    %631 = tensor.empty() : tensor<1x2x1x128xf32>
    %inserted_slice_90 = tensor.insert_slice %630 into %631[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %inserted_slice_91 = tensor.insert_slice %extracted_slice_88 into %inserted_slice_90[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %632 = tosa.mul %inserted_slice_91, %623, %15 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x2x1x128xf32>
    %633 = tosa.add %629, %632 : (tensor<1x2x1x128xf32>, tensor<1x2x1x128xf32>) -> tensor<1x2x1x128xf32>
    %634 = bufferization.to_buffer %arg110 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %635 = tosa.reshape %arg3, %7 : (tensor<1xi64>, !tosa.shape<4>) -> tensor<1x1x1x1xi64>
    %636 = tosa.add %635, %6 : (tensor<1x1x1x1xi64>, tensor<1x2x1x128xi64>) -> tensor<1x2x1x128xi64>
    %637 = bufferization.to_buffer %636 : tensor<1x2x1x128xi64> to memref<1x2x1x128xi64>
    %638 = bufferization.to_buffer %633 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    scf.for %arg399 = %c0 to %c1 step %c1 {
      scf.for %arg400 = %c0 to %c2 step %c1 {
        scf.for %arg401 = %c0 to %c1 step %c1 {
          scf.for %arg402 = %c0 to %c128 step %c1 {
            %2290 = memref.load %638[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            %2291 = memref.load %637[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xi64>
            %2292 = arith.index_cast %2291 : i64 to index
            memref.store %2290, %634[%arg399, %arg400, %2292, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %639 = bufferization.to_tensor %634 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %640 = bufferization.to_buffer %arg111 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %641 = tosa.reshape %arg3, %7 : (tensor<1xi64>, !tosa.shape<4>) -> tensor<1x1x1x1xi64>
    %642 = tosa.add %641, %6 : (tensor<1x1x1x1xi64>, tensor<1x2x1x128xi64>) -> tensor<1x2x1x128xi64>
    %643 = bufferization.to_buffer %642 : tensor<1x2x1x128xi64> to memref<1x2x1x128xi64>
    %644 = bufferization.to_buffer %621 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    scf.for %arg399 = %c0 to %c1 step %c1 {
      scf.for %arg400 = %c0 to %c2 step %c1 {
        scf.for %arg401 = %c0 to %c1 step %c1 {
          scf.for %arg402 = %c0 to %c128 step %c1 {
            %2290 = memref.load %644[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            %2291 = memref.load %643[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xi64>
            %2292 = arith.index_cast %2291 : i64 to index
            memref.store %2290, %640[%arg399, %arg400, %2292, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %645 = bufferization.to_tensor %640 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %646 = tosa.reshape %28, %5 : (tensor<1x1024xi1>, !tosa.shape<4>) -> tensor<1x1x1x1024xi1>
    %647 = tensor.empty() : tensor<1x1x1x1024xf32>
    %648 = linalg.generic {indexing_maps = [#map1, #map1, #map1, #map1], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%646, %cst_1, %cst_0 : tensor<1x1x1x1024xi1>, tensor<1x1x1x1024xf32>, tensor<1x1x1x1024xf32>) outs(%647 : tensor<1x1x1x1024xf32>) {
    ^bb0(%in: i1, %in_315: f32, %in_316: f32, %out: f32):
      %2290 = arith.select %in, %in_315, %in_316 : f32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1x1024xf32>
    %649 = bufferization.to_buffer %628 : tensor<1x12x1x128xf32> to memref<1x12x1x128xf32>
    %650 = bufferization.to_buffer %648 : tensor<1x1x1x1024xf32> to memref<1x1x1x1024xf32>
    %alloc_92 = memref.alloc() : memref<1x12x1x128xf32>
    %alloc_93 = memref.alloc() : memref<1x12x1xf32>
    %alloc_94 = memref.alloc() : memref<128xf32>
    affine.for %arg399 = 0 to 1 {
      affine.for %arg400 = 0 to 12 {
        %2290 = arith.divsi %arg400, %c6 : index
        affine.for %arg401 = 0 to 1 {
          affine.for %arg402 = 0 to 128 {
            memref.store %cst_7, %alloc_94[%arg402] : memref<128xf32>
          }
          %2291:2 = affine.for %arg402 = 0 to 1024 iter_args(%arg403 = %cst_4, %arg404 = %cst_7) -> (f32, f32) {
            %2292 = affine.for %arg405 = 0 to 128 step 16 iter_args(%arg406 = %cst) -> (vector<16xf32>) {
              %2307 = vector.load %649[%arg399, %arg400, %arg401, %arg405] : memref<1x12x1x128xf32>, vector<16xf32>
              %2308 = vector.load %634[%arg399, %2290, %arg402, %arg405] : memref<1x2x1024x128xf32>, vector<16xf32>
              %2309 = vector.fma %2307, %2308, %arg406 : vector<16xf32>
              affine.yield %2309 : vector<16xf32>
            }
            %2293 = vector.reduction <add>, %2292 : vector<16xf32> into f32
            %2294 = arith.mulf %2293, %cst_5 : f32
            %2295 = memref.load %650[%arg399, %c0, %arg401, %arg402] : memref<1x1x1x1024xf32>
            %2296 = arith.addf %2294, %2295 : f32
            %2297 = arith.cmpf ogt, %2296, %arg403 : f32
            %2298 = arith.select %2297, %2296, %arg403 : f32
            %2299 = arith.subf %arg403, %2296 : f32
            %2300 = math.exp %2299 : f32
            %2301 = arith.mulf %2300, %arg404 : f32
            %2302 = arith.addf %2301, %cst_6 : f32
            %2303 = arith.subf %2296, %arg403 : f32
            %2304 = math.exp %2303 : f32
            %2305 = arith.addf %arg404, %2304 : f32
            %2306 = arith.select %2297, %2302, %2305 : f32
            affine.for %arg405 = 0 to 128 {
              %2307 = memref.load %640[%arg399, %2290, %arg402, %arg405] : memref<1x2x1024x128xf32>
              %2308 = memref.load %alloc_94[%arg405] : memref<128xf32>
              %2309 = arith.mulf %2308, %2300 : f32
              %2310 = arith.addf %2309, %2307 : f32
              %2311 = arith.mulf %2304, %2307 : f32
              %2312 = arith.addf %2311, %2308 : f32
              %2313 = arith.select %2297, %2310, %2312 : f32
              memref.store %2313, %alloc_94[%arg405] : memref<128xf32>
            }
            affine.yield %2298, %2306 : f32, f32
          }
          memref.store %2291#1, %alloc_93[%arg399, %arg400, %arg401] : memref<1x12x1xf32>
          affine.for %arg402 = 0 to 128 {
            %2292 = memref.load %alloc_94[%arg402] : memref<128xf32>
            %2293 = arith.divf %2292, %2291#1 : f32
            memref.store %2293, %alloc_92[%arg399, %arg400, %arg401, %arg402] : memref<1x12x1x128xf32>
          }
        }
      }
    }
    %651 = bufferization.to_tensor %alloc_92 restrict : memref<1x12x1x128xf32> to tensor<1x12x1x128xf32>
    %652 = tosa.reshape %651, %12 : (tensor<1x12x1x128xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %653 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%652, %arg112 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %654 = tosa.reshape %653, %13 : (tensor<1x1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %655 = tosa.add %597, %654 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %656 = tensor.empty() : tensor<1x1x1536xf32>
    %657 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%655 : tensor<1x1x1536xf32>) outs(%656 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2290 = math.fpowi %in, %c2_i32 : f32, i32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1536xf32>
    %658 = tosa.reduce_sum %657 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %659 = tosa.mul %658, %0, %15 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1xf32>
    %660 = tosa.add %659, %14 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %661 = tosa.rsqrt %660 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %662 = tosa.mul %655, %661, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %663 = tosa.reshape %arg113, %13 : (tensor<1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %664 = tosa.mul %663, %662, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %665 = tosa.reshape %664, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %666 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%665, %arg114 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_3 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %667 = tosa.reshape %666, %4 : (tensor<1x8960xf32>, !tosa.shape<3>) -> tensor<1x1x8960xf32>
    %668 = tosa.sigmoid %667 : (tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %669 = tosa.mul %667, %668, %15 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>, tensor<1xi8>) -> tensor<1x1x8960xf32>
    %670 = tosa.reshape %664, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %671 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%670, %arg115 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_3 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %672 = tosa.reshape %671, %4 : (tensor<1x8960xf32>, !tosa.shape<3>) -> tensor<1x1x8960xf32>
    %673 = tosa.mul %669, %672, %15 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>, tensor<1xi8>) -> tensor<1x1x8960xf32>
    %674 = tosa.reshape %673, %3 : (tensor<1x1x8960xf32>, !tosa.shape<2>) -> tensor<1x8960xf32>
    %675 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%674, %arg116 : tensor<1x8960xf32>, tensor<8960x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %676 = tosa.reshape %675, %13 : (tensor<1x1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %677 = tosa.add %655, %676 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %678 = tensor.empty() : tensor<1x1x1536xf32>
    %679 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%677 : tensor<1x1x1536xf32>) outs(%678 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2290 = math.fpowi %in, %c2_i32 : f32, i32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1536xf32>
    %680 = tosa.reduce_sum %679 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %681 = tosa.mul %680, %0, %15 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1xf32>
    %682 = tosa.add %681, %14 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %683 = tosa.rsqrt %682 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %684 = tosa.mul %677, %683, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %685 = tosa.reshape %arg117, %13 : (tensor<1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %686 = tosa.mul %685, %684, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %687 = tosa.reshape %686, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %688 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%687, %arg119 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %689 = tosa.reshape %arg118, %12 : (tensor<1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %690 = tosa.add %689, %688 : (tensor<1x1536xf32>, tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %691 = tosa.reshape %690, %11 : (tensor<1x1536xf32>, !tosa.shape<4>) -> tensor<1x12x1x128xf32>
    %692 = tosa.reshape %686, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %693 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%692, %arg121 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_8 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %694 = tosa.reshape %arg120, %10 : (tensor<256xf32>, !tosa.shape<2>) -> tensor<1x256xf32>
    %695 = tosa.add %694, %693 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %696 = tosa.reshape %695, %9 : (tensor<1x256xf32>, !tosa.shape<4>) -> tensor<1x2x1x128xf32>
    %697 = tosa.reshape %686, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %698 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%697, %arg123 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_8 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %699 = tosa.reshape %arg122, %10 : (tensor<256xf32>, !tosa.shape<2>) -> tensor<1x256xf32>
    %700 = tosa.add %699, %698 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %701 = tosa.reshape %700, %9 : (tensor<1x256xf32>, !tosa.shape<4>) -> tensor<1x2x1x128xf32>
    %702 = tosa.reshape %36, %8 : (tensor<1x1x128xf32>, !tosa.shape<4>) -> tensor<1x1x1x128xf32>
    %703 = tosa.reshape %37, %8 : (tensor<1x1x128xf32>, !tosa.shape<4>) -> tensor<1x1x1x128xf32>
    %704 = tosa.mul %691, %702, %15 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x12x1x128xf32>
    %extracted_slice_95 = tensor.extract_slice %691[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %extracted_slice_96 = tensor.extract_slice %691[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %705 = tosa.negate %extracted_slice_96, %19, %19 : (tensor<1x12x1x64xf32>, tensor<1xf32>, tensor<1xf32>) -> tensor<1x12x1x64xf32>
    %706 = tensor.empty() : tensor<1x12x1x128xf32>
    %inserted_slice_97 = tensor.insert_slice %705 into %706[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %inserted_slice_98 = tensor.insert_slice %extracted_slice_95 into %inserted_slice_97[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %707 = tosa.mul %inserted_slice_98, %703, %15 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x12x1x128xf32>
    %708 = tosa.add %704, %707 : (tensor<1x12x1x128xf32>, tensor<1x12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %709 = tosa.mul %696, %702, %15 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x2x1x128xf32>
    %extracted_slice_99 = tensor.extract_slice %696[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %extracted_slice_100 = tensor.extract_slice %696[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %710 = tosa.negate %extracted_slice_100, %19, %19 : (tensor<1x2x1x64xf32>, tensor<1xf32>, tensor<1xf32>) -> tensor<1x2x1x64xf32>
    %711 = tensor.empty() : tensor<1x2x1x128xf32>
    %inserted_slice_101 = tensor.insert_slice %710 into %711[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %inserted_slice_102 = tensor.insert_slice %extracted_slice_99 into %inserted_slice_101[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %712 = tosa.mul %inserted_slice_102, %703, %15 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x2x1x128xf32>
    %713 = tosa.add %709, %712 : (tensor<1x2x1x128xf32>, tensor<1x2x1x128xf32>) -> tensor<1x2x1x128xf32>
    %714 = bufferization.to_buffer %arg124 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %715 = tosa.reshape %arg3, %7 : (tensor<1xi64>, !tosa.shape<4>) -> tensor<1x1x1x1xi64>
    %716 = tosa.add %715, %6 : (tensor<1x1x1x1xi64>, tensor<1x2x1x128xi64>) -> tensor<1x2x1x128xi64>
    %717 = bufferization.to_buffer %716 : tensor<1x2x1x128xi64> to memref<1x2x1x128xi64>
    %718 = bufferization.to_buffer %713 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    scf.for %arg399 = %c0 to %c1 step %c1 {
      scf.for %arg400 = %c0 to %c2 step %c1 {
        scf.for %arg401 = %c0 to %c1 step %c1 {
          scf.for %arg402 = %c0 to %c128 step %c1 {
            %2290 = memref.load %718[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            %2291 = memref.load %717[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xi64>
            %2292 = arith.index_cast %2291 : i64 to index
            memref.store %2290, %714[%arg399, %arg400, %2292, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %719 = bufferization.to_tensor %714 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %720 = bufferization.to_buffer %arg125 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %721 = tosa.reshape %arg3, %7 : (tensor<1xi64>, !tosa.shape<4>) -> tensor<1x1x1x1xi64>
    %722 = tosa.add %721, %6 : (tensor<1x1x1x1xi64>, tensor<1x2x1x128xi64>) -> tensor<1x2x1x128xi64>
    %723 = bufferization.to_buffer %722 : tensor<1x2x1x128xi64> to memref<1x2x1x128xi64>
    %724 = bufferization.to_buffer %701 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    scf.for %arg399 = %c0 to %c1 step %c1 {
      scf.for %arg400 = %c0 to %c2 step %c1 {
        scf.for %arg401 = %c0 to %c1 step %c1 {
          scf.for %arg402 = %c0 to %c128 step %c1 {
            %2290 = memref.load %724[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            %2291 = memref.load %723[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xi64>
            %2292 = arith.index_cast %2291 : i64 to index
            memref.store %2290, %720[%arg399, %arg400, %2292, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %725 = bufferization.to_tensor %720 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %726 = tosa.reshape %28, %5 : (tensor<1x1024xi1>, !tosa.shape<4>) -> tensor<1x1x1x1024xi1>
    %727 = tensor.empty() : tensor<1x1x1x1024xf32>
    %728 = linalg.generic {indexing_maps = [#map1, #map1, #map1, #map1], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%726, %cst_1, %cst_0 : tensor<1x1x1x1024xi1>, tensor<1x1x1x1024xf32>, tensor<1x1x1x1024xf32>) outs(%727 : tensor<1x1x1x1024xf32>) {
    ^bb0(%in: i1, %in_315: f32, %in_316: f32, %out: f32):
      %2290 = arith.select %in, %in_315, %in_316 : f32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1x1024xf32>
    %729 = bufferization.to_buffer %708 : tensor<1x12x1x128xf32> to memref<1x12x1x128xf32>
    %730 = bufferization.to_buffer %728 : tensor<1x1x1x1024xf32> to memref<1x1x1x1024xf32>
    %alloc_103 = memref.alloc() : memref<1x12x1x128xf32>
    %alloc_104 = memref.alloc() : memref<1x12x1xf32>
    %alloc_105 = memref.alloc() : memref<128xf32>
    affine.for %arg399 = 0 to 1 {
      affine.for %arg400 = 0 to 12 {
        %2290 = arith.divsi %arg400, %c6 : index
        affine.for %arg401 = 0 to 1 {
          affine.for %arg402 = 0 to 128 {
            memref.store %cst_7, %alloc_105[%arg402] : memref<128xf32>
          }
          %2291:2 = affine.for %arg402 = 0 to 1024 iter_args(%arg403 = %cst_4, %arg404 = %cst_7) -> (f32, f32) {
            %2292 = affine.for %arg405 = 0 to 128 step 16 iter_args(%arg406 = %cst) -> (vector<16xf32>) {
              %2307 = vector.load %729[%arg399, %arg400, %arg401, %arg405] : memref<1x12x1x128xf32>, vector<16xf32>
              %2308 = vector.load %714[%arg399, %2290, %arg402, %arg405] : memref<1x2x1024x128xf32>, vector<16xf32>
              %2309 = vector.fma %2307, %2308, %arg406 : vector<16xf32>
              affine.yield %2309 : vector<16xf32>
            }
            %2293 = vector.reduction <add>, %2292 : vector<16xf32> into f32
            %2294 = arith.mulf %2293, %cst_5 : f32
            %2295 = memref.load %730[%arg399, %c0, %arg401, %arg402] : memref<1x1x1x1024xf32>
            %2296 = arith.addf %2294, %2295 : f32
            %2297 = arith.cmpf ogt, %2296, %arg403 : f32
            %2298 = arith.select %2297, %2296, %arg403 : f32
            %2299 = arith.subf %arg403, %2296 : f32
            %2300 = math.exp %2299 : f32
            %2301 = arith.mulf %2300, %arg404 : f32
            %2302 = arith.addf %2301, %cst_6 : f32
            %2303 = arith.subf %2296, %arg403 : f32
            %2304 = math.exp %2303 : f32
            %2305 = arith.addf %arg404, %2304 : f32
            %2306 = arith.select %2297, %2302, %2305 : f32
            affine.for %arg405 = 0 to 128 {
              %2307 = memref.load %720[%arg399, %2290, %arg402, %arg405] : memref<1x2x1024x128xf32>
              %2308 = memref.load %alloc_105[%arg405] : memref<128xf32>
              %2309 = arith.mulf %2308, %2300 : f32
              %2310 = arith.addf %2309, %2307 : f32
              %2311 = arith.mulf %2304, %2307 : f32
              %2312 = arith.addf %2311, %2308 : f32
              %2313 = arith.select %2297, %2310, %2312 : f32
              memref.store %2313, %alloc_105[%arg405] : memref<128xf32>
            }
            affine.yield %2298, %2306 : f32, f32
          }
          memref.store %2291#1, %alloc_104[%arg399, %arg400, %arg401] : memref<1x12x1xf32>
          affine.for %arg402 = 0 to 128 {
            %2292 = memref.load %alloc_105[%arg402] : memref<128xf32>
            %2293 = arith.divf %2292, %2291#1 : f32
            memref.store %2293, %alloc_103[%arg399, %arg400, %arg401, %arg402] : memref<1x12x1x128xf32>
          }
        }
      }
    }
    %731 = bufferization.to_tensor %alloc_103 restrict : memref<1x12x1x128xf32> to tensor<1x12x1x128xf32>
    %732 = tosa.reshape %731, %12 : (tensor<1x12x1x128xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %733 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%732, %arg126 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %734 = tosa.reshape %733, %13 : (tensor<1x1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %735 = tosa.add %677, %734 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %736 = tensor.empty() : tensor<1x1x1536xf32>
    %737 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%735 : tensor<1x1x1536xf32>) outs(%736 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2290 = math.fpowi %in, %c2_i32 : f32, i32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1536xf32>
    %738 = tosa.reduce_sum %737 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %739 = tosa.mul %738, %0, %15 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1xf32>
    %740 = tosa.add %739, %14 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %741 = tosa.rsqrt %740 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %742 = tosa.mul %735, %741, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %743 = tosa.reshape %arg127, %13 : (tensor<1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %744 = tosa.mul %743, %742, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %745 = tosa.reshape %744, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %746 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%745, %arg128 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_3 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %747 = tosa.reshape %746, %4 : (tensor<1x8960xf32>, !tosa.shape<3>) -> tensor<1x1x8960xf32>
    %748 = tosa.sigmoid %747 : (tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %749 = tosa.mul %747, %748, %15 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>, tensor<1xi8>) -> tensor<1x1x8960xf32>
    %750 = tosa.reshape %744, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %751 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%750, %arg129 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_3 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %752 = tosa.reshape %751, %4 : (tensor<1x8960xf32>, !tosa.shape<3>) -> tensor<1x1x8960xf32>
    %753 = tosa.mul %749, %752, %15 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>, tensor<1xi8>) -> tensor<1x1x8960xf32>
    %754 = tosa.reshape %753, %3 : (tensor<1x1x8960xf32>, !tosa.shape<2>) -> tensor<1x8960xf32>
    %755 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%754, %arg130 : tensor<1x8960xf32>, tensor<8960x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %756 = tosa.reshape %755, %13 : (tensor<1x1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %757 = tosa.add %735, %756 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %758 = tensor.empty() : tensor<1x1x1536xf32>
    %759 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%757 : tensor<1x1x1536xf32>) outs(%758 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2290 = math.fpowi %in, %c2_i32 : f32, i32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1536xf32>
    %760 = tosa.reduce_sum %759 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %761 = tosa.mul %760, %0, %15 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1xf32>
    %762 = tosa.add %761, %14 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %763 = tosa.rsqrt %762 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %764 = tosa.mul %757, %763, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %765 = tosa.reshape %arg131, %13 : (tensor<1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %766 = tosa.mul %765, %764, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %767 = tosa.reshape %766, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %768 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%767, %arg133 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %769 = tosa.reshape %arg132, %12 : (tensor<1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %770 = tosa.add %769, %768 : (tensor<1x1536xf32>, tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %771 = tosa.reshape %770, %11 : (tensor<1x1536xf32>, !tosa.shape<4>) -> tensor<1x12x1x128xf32>
    %772 = tosa.reshape %766, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %773 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%772, %arg135 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_8 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %774 = tosa.reshape %arg134, %10 : (tensor<256xf32>, !tosa.shape<2>) -> tensor<1x256xf32>
    %775 = tosa.add %774, %773 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %776 = tosa.reshape %775, %9 : (tensor<1x256xf32>, !tosa.shape<4>) -> tensor<1x2x1x128xf32>
    %777 = tosa.reshape %766, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %778 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%777, %arg137 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_8 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %779 = tosa.reshape %arg136, %10 : (tensor<256xf32>, !tosa.shape<2>) -> tensor<1x256xf32>
    %780 = tosa.add %779, %778 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %781 = tosa.reshape %780, %9 : (tensor<1x256xf32>, !tosa.shape<4>) -> tensor<1x2x1x128xf32>
    %782 = tosa.reshape %36, %8 : (tensor<1x1x128xf32>, !tosa.shape<4>) -> tensor<1x1x1x128xf32>
    %783 = tosa.reshape %37, %8 : (tensor<1x1x128xf32>, !tosa.shape<4>) -> tensor<1x1x1x128xf32>
    %784 = tosa.mul %771, %782, %15 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x12x1x128xf32>
    %extracted_slice_106 = tensor.extract_slice %771[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %extracted_slice_107 = tensor.extract_slice %771[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %785 = tosa.negate %extracted_slice_107, %19, %19 : (tensor<1x12x1x64xf32>, tensor<1xf32>, tensor<1xf32>) -> tensor<1x12x1x64xf32>
    %786 = tensor.empty() : tensor<1x12x1x128xf32>
    %inserted_slice_108 = tensor.insert_slice %785 into %786[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %inserted_slice_109 = tensor.insert_slice %extracted_slice_106 into %inserted_slice_108[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %787 = tosa.mul %inserted_slice_109, %783, %15 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x12x1x128xf32>
    %788 = tosa.add %784, %787 : (tensor<1x12x1x128xf32>, tensor<1x12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %789 = tosa.mul %776, %782, %15 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x2x1x128xf32>
    %extracted_slice_110 = tensor.extract_slice %776[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %extracted_slice_111 = tensor.extract_slice %776[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %790 = tosa.negate %extracted_slice_111, %19, %19 : (tensor<1x2x1x64xf32>, tensor<1xf32>, tensor<1xf32>) -> tensor<1x2x1x64xf32>
    %791 = tensor.empty() : tensor<1x2x1x128xf32>
    %inserted_slice_112 = tensor.insert_slice %790 into %791[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %inserted_slice_113 = tensor.insert_slice %extracted_slice_110 into %inserted_slice_112[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %792 = tosa.mul %inserted_slice_113, %783, %15 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x2x1x128xf32>
    %793 = tosa.add %789, %792 : (tensor<1x2x1x128xf32>, tensor<1x2x1x128xf32>) -> tensor<1x2x1x128xf32>
    %794 = bufferization.to_buffer %arg138 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %795 = tosa.reshape %arg3, %7 : (tensor<1xi64>, !tosa.shape<4>) -> tensor<1x1x1x1xi64>
    %796 = tosa.add %795, %6 : (tensor<1x1x1x1xi64>, tensor<1x2x1x128xi64>) -> tensor<1x2x1x128xi64>
    %797 = bufferization.to_buffer %796 : tensor<1x2x1x128xi64> to memref<1x2x1x128xi64>
    %798 = bufferization.to_buffer %793 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    scf.for %arg399 = %c0 to %c1 step %c1 {
      scf.for %arg400 = %c0 to %c2 step %c1 {
        scf.for %arg401 = %c0 to %c1 step %c1 {
          scf.for %arg402 = %c0 to %c128 step %c1 {
            %2290 = memref.load %798[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            %2291 = memref.load %797[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xi64>
            %2292 = arith.index_cast %2291 : i64 to index
            memref.store %2290, %794[%arg399, %arg400, %2292, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %799 = bufferization.to_tensor %794 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %800 = bufferization.to_buffer %arg139 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %801 = tosa.reshape %arg3, %7 : (tensor<1xi64>, !tosa.shape<4>) -> tensor<1x1x1x1xi64>
    %802 = tosa.add %801, %6 : (tensor<1x1x1x1xi64>, tensor<1x2x1x128xi64>) -> tensor<1x2x1x128xi64>
    %803 = bufferization.to_buffer %802 : tensor<1x2x1x128xi64> to memref<1x2x1x128xi64>
    %804 = bufferization.to_buffer %781 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    scf.for %arg399 = %c0 to %c1 step %c1 {
      scf.for %arg400 = %c0 to %c2 step %c1 {
        scf.for %arg401 = %c0 to %c1 step %c1 {
          scf.for %arg402 = %c0 to %c128 step %c1 {
            %2290 = memref.load %804[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            %2291 = memref.load %803[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xi64>
            %2292 = arith.index_cast %2291 : i64 to index
            memref.store %2290, %800[%arg399, %arg400, %2292, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %805 = bufferization.to_tensor %800 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %806 = tosa.reshape %28, %5 : (tensor<1x1024xi1>, !tosa.shape<4>) -> tensor<1x1x1x1024xi1>
    %807 = tensor.empty() : tensor<1x1x1x1024xf32>
    %808 = linalg.generic {indexing_maps = [#map1, #map1, #map1, #map1], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%806, %cst_1, %cst_0 : tensor<1x1x1x1024xi1>, tensor<1x1x1x1024xf32>, tensor<1x1x1x1024xf32>) outs(%807 : tensor<1x1x1x1024xf32>) {
    ^bb0(%in: i1, %in_315: f32, %in_316: f32, %out: f32):
      %2290 = arith.select %in, %in_315, %in_316 : f32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1x1024xf32>
    %809 = bufferization.to_buffer %788 : tensor<1x12x1x128xf32> to memref<1x12x1x128xf32>
    %810 = bufferization.to_buffer %808 : tensor<1x1x1x1024xf32> to memref<1x1x1x1024xf32>
    %alloc_114 = memref.alloc() : memref<1x12x1x128xf32>
    %alloc_115 = memref.alloc() : memref<1x12x1xf32>
    %alloc_116 = memref.alloc() : memref<128xf32>
    affine.for %arg399 = 0 to 1 {
      affine.for %arg400 = 0 to 12 {
        %2290 = arith.divsi %arg400, %c6 : index
        affine.for %arg401 = 0 to 1 {
          affine.for %arg402 = 0 to 128 {
            memref.store %cst_7, %alloc_116[%arg402] : memref<128xf32>
          }
          %2291:2 = affine.for %arg402 = 0 to 1024 iter_args(%arg403 = %cst_4, %arg404 = %cst_7) -> (f32, f32) {
            %2292 = affine.for %arg405 = 0 to 128 step 16 iter_args(%arg406 = %cst) -> (vector<16xf32>) {
              %2307 = vector.load %809[%arg399, %arg400, %arg401, %arg405] : memref<1x12x1x128xf32>, vector<16xf32>
              %2308 = vector.load %794[%arg399, %2290, %arg402, %arg405] : memref<1x2x1024x128xf32>, vector<16xf32>
              %2309 = vector.fma %2307, %2308, %arg406 : vector<16xf32>
              affine.yield %2309 : vector<16xf32>
            }
            %2293 = vector.reduction <add>, %2292 : vector<16xf32> into f32
            %2294 = arith.mulf %2293, %cst_5 : f32
            %2295 = memref.load %810[%arg399, %c0, %arg401, %arg402] : memref<1x1x1x1024xf32>
            %2296 = arith.addf %2294, %2295 : f32
            %2297 = arith.cmpf ogt, %2296, %arg403 : f32
            %2298 = arith.select %2297, %2296, %arg403 : f32
            %2299 = arith.subf %arg403, %2296 : f32
            %2300 = math.exp %2299 : f32
            %2301 = arith.mulf %2300, %arg404 : f32
            %2302 = arith.addf %2301, %cst_6 : f32
            %2303 = arith.subf %2296, %arg403 : f32
            %2304 = math.exp %2303 : f32
            %2305 = arith.addf %arg404, %2304 : f32
            %2306 = arith.select %2297, %2302, %2305 : f32
            affine.for %arg405 = 0 to 128 {
              %2307 = memref.load %800[%arg399, %2290, %arg402, %arg405] : memref<1x2x1024x128xf32>
              %2308 = memref.load %alloc_116[%arg405] : memref<128xf32>
              %2309 = arith.mulf %2308, %2300 : f32
              %2310 = arith.addf %2309, %2307 : f32
              %2311 = arith.mulf %2304, %2307 : f32
              %2312 = arith.addf %2311, %2308 : f32
              %2313 = arith.select %2297, %2310, %2312 : f32
              memref.store %2313, %alloc_116[%arg405] : memref<128xf32>
            }
            affine.yield %2298, %2306 : f32, f32
          }
          memref.store %2291#1, %alloc_115[%arg399, %arg400, %arg401] : memref<1x12x1xf32>
          affine.for %arg402 = 0 to 128 {
            %2292 = memref.load %alloc_116[%arg402] : memref<128xf32>
            %2293 = arith.divf %2292, %2291#1 : f32
            memref.store %2293, %alloc_114[%arg399, %arg400, %arg401, %arg402] : memref<1x12x1x128xf32>
          }
        }
      }
    }
    %811 = bufferization.to_tensor %alloc_114 restrict : memref<1x12x1x128xf32> to tensor<1x12x1x128xf32>
    %812 = tosa.reshape %811, %12 : (tensor<1x12x1x128xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %813 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%812, %arg140 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %814 = tosa.reshape %813, %13 : (tensor<1x1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %815 = tosa.add %757, %814 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %816 = tensor.empty() : tensor<1x1x1536xf32>
    %817 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%815 : tensor<1x1x1536xf32>) outs(%816 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2290 = math.fpowi %in, %c2_i32 : f32, i32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1536xf32>
    %818 = tosa.reduce_sum %817 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %819 = tosa.mul %818, %0, %15 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1xf32>
    %820 = tosa.add %819, %14 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %821 = tosa.rsqrt %820 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %822 = tosa.mul %815, %821, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %823 = tosa.reshape %arg141, %13 : (tensor<1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %824 = tosa.mul %823, %822, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %825 = tosa.reshape %824, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %826 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%825, %arg142 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_3 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %827 = tosa.reshape %826, %4 : (tensor<1x8960xf32>, !tosa.shape<3>) -> tensor<1x1x8960xf32>
    %828 = tosa.sigmoid %827 : (tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %829 = tosa.mul %827, %828, %15 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>, tensor<1xi8>) -> tensor<1x1x8960xf32>
    %830 = tosa.reshape %824, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %831 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%830, %arg143 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_3 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %832 = tosa.reshape %831, %4 : (tensor<1x8960xf32>, !tosa.shape<3>) -> tensor<1x1x8960xf32>
    %833 = tosa.mul %829, %832, %15 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>, tensor<1xi8>) -> tensor<1x1x8960xf32>
    %834 = tosa.reshape %833, %3 : (tensor<1x1x8960xf32>, !tosa.shape<2>) -> tensor<1x8960xf32>
    %835 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%834, %arg144 : tensor<1x8960xf32>, tensor<8960x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %836 = tosa.reshape %835, %13 : (tensor<1x1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %837 = tosa.add %815, %836 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %838 = tensor.empty() : tensor<1x1x1536xf32>
    %839 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%837 : tensor<1x1x1536xf32>) outs(%838 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2290 = math.fpowi %in, %c2_i32 : f32, i32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1536xf32>
    %840 = tosa.reduce_sum %839 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %841 = tosa.mul %840, %0, %15 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1xf32>
    %842 = tosa.add %841, %14 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %843 = tosa.rsqrt %842 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %844 = tosa.mul %837, %843, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %845 = tosa.reshape %arg145, %13 : (tensor<1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %846 = tosa.mul %845, %844, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %847 = tosa.reshape %846, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %848 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%847, %arg147 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %849 = tosa.reshape %arg146, %12 : (tensor<1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %850 = tosa.add %849, %848 : (tensor<1x1536xf32>, tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %851 = tosa.reshape %850, %11 : (tensor<1x1536xf32>, !tosa.shape<4>) -> tensor<1x12x1x128xf32>
    %852 = tosa.reshape %846, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %853 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%852, %arg149 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_8 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %854 = tosa.reshape %arg148, %10 : (tensor<256xf32>, !tosa.shape<2>) -> tensor<1x256xf32>
    %855 = tosa.add %854, %853 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %856 = tosa.reshape %855, %9 : (tensor<1x256xf32>, !tosa.shape<4>) -> tensor<1x2x1x128xf32>
    %857 = tosa.reshape %846, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %858 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%857, %arg151 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_8 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %859 = tosa.reshape %arg150, %10 : (tensor<256xf32>, !tosa.shape<2>) -> tensor<1x256xf32>
    %860 = tosa.add %859, %858 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %861 = tosa.reshape %860, %9 : (tensor<1x256xf32>, !tosa.shape<4>) -> tensor<1x2x1x128xf32>
    %862 = tosa.reshape %36, %8 : (tensor<1x1x128xf32>, !tosa.shape<4>) -> tensor<1x1x1x128xf32>
    %863 = tosa.reshape %37, %8 : (tensor<1x1x128xf32>, !tosa.shape<4>) -> tensor<1x1x1x128xf32>
    %864 = tosa.mul %851, %862, %15 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x12x1x128xf32>
    %extracted_slice_117 = tensor.extract_slice %851[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %extracted_slice_118 = tensor.extract_slice %851[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %865 = tosa.negate %extracted_slice_118, %19, %19 : (tensor<1x12x1x64xf32>, tensor<1xf32>, tensor<1xf32>) -> tensor<1x12x1x64xf32>
    %866 = tensor.empty() : tensor<1x12x1x128xf32>
    %inserted_slice_119 = tensor.insert_slice %865 into %866[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %inserted_slice_120 = tensor.insert_slice %extracted_slice_117 into %inserted_slice_119[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %867 = tosa.mul %inserted_slice_120, %863, %15 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x12x1x128xf32>
    %868 = tosa.add %864, %867 : (tensor<1x12x1x128xf32>, tensor<1x12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %869 = tosa.mul %856, %862, %15 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x2x1x128xf32>
    %extracted_slice_121 = tensor.extract_slice %856[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %extracted_slice_122 = tensor.extract_slice %856[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %870 = tosa.negate %extracted_slice_122, %19, %19 : (tensor<1x2x1x64xf32>, tensor<1xf32>, tensor<1xf32>) -> tensor<1x2x1x64xf32>
    %871 = tensor.empty() : tensor<1x2x1x128xf32>
    %inserted_slice_123 = tensor.insert_slice %870 into %871[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %inserted_slice_124 = tensor.insert_slice %extracted_slice_121 into %inserted_slice_123[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %872 = tosa.mul %inserted_slice_124, %863, %15 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x2x1x128xf32>
    %873 = tosa.add %869, %872 : (tensor<1x2x1x128xf32>, tensor<1x2x1x128xf32>) -> tensor<1x2x1x128xf32>
    %874 = bufferization.to_buffer %arg152 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %875 = tosa.reshape %arg3, %7 : (tensor<1xi64>, !tosa.shape<4>) -> tensor<1x1x1x1xi64>
    %876 = tosa.add %875, %6 : (tensor<1x1x1x1xi64>, tensor<1x2x1x128xi64>) -> tensor<1x2x1x128xi64>
    %877 = bufferization.to_buffer %876 : tensor<1x2x1x128xi64> to memref<1x2x1x128xi64>
    %878 = bufferization.to_buffer %873 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    scf.for %arg399 = %c0 to %c1 step %c1 {
      scf.for %arg400 = %c0 to %c2 step %c1 {
        scf.for %arg401 = %c0 to %c1 step %c1 {
          scf.for %arg402 = %c0 to %c128 step %c1 {
            %2290 = memref.load %878[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            %2291 = memref.load %877[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xi64>
            %2292 = arith.index_cast %2291 : i64 to index
            memref.store %2290, %874[%arg399, %arg400, %2292, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %879 = bufferization.to_tensor %874 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %880 = bufferization.to_buffer %arg153 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %881 = tosa.reshape %arg3, %7 : (tensor<1xi64>, !tosa.shape<4>) -> tensor<1x1x1x1xi64>
    %882 = tosa.add %881, %6 : (tensor<1x1x1x1xi64>, tensor<1x2x1x128xi64>) -> tensor<1x2x1x128xi64>
    %883 = bufferization.to_buffer %882 : tensor<1x2x1x128xi64> to memref<1x2x1x128xi64>
    %884 = bufferization.to_buffer %861 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    scf.for %arg399 = %c0 to %c1 step %c1 {
      scf.for %arg400 = %c0 to %c2 step %c1 {
        scf.for %arg401 = %c0 to %c1 step %c1 {
          scf.for %arg402 = %c0 to %c128 step %c1 {
            %2290 = memref.load %884[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            %2291 = memref.load %883[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xi64>
            %2292 = arith.index_cast %2291 : i64 to index
            memref.store %2290, %880[%arg399, %arg400, %2292, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %885 = bufferization.to_tensor %880 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %886 = tosa.reshape %28, %5 : (tensor<1x1024xi1>, !tosa.shape<4>) -> tensor<1x1x1x1024xi1>
    %887 = tensor.empty() : tensor<1x1x1x1024xf32>
    %888 = linalg.generic {indexing_maps = [#map1, #map1, #map1, #map1], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%886, %cst_1, %cst_0 : tensor<1x1x1x1024xi1>, tensor<1x1x1x1024xf32>, tensor<1x1x1x1024xf32>) outs(%887 : tensor<1x1x1x1024xf32>) {
    ^bb0(%in: i1, %in_315: f32, %in_316: f32, %out: f32):
      %2290 = arith.select %in, %in_315, %in_316 : f32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1x1024xf32>
    %889 = bufferization.to_buffer %868 : tensor<1x12x1x128xf32> to memref<1x12x1x128xf32>
    %890 = bufferization.to_buffer %888 : tensor<1x1x1x1024xf32> to memref<1x1x1x1024xf32>
    %alloc_125 = memref.alloc() : memref<1x12x1x128xf32>
    %alloc_126 = memref.alloc() : memref<1x12x1xf32>
    %alloc_127 = memref.alloc() : memref<128xf32>
    affine.for %arg399 = 0 to 1 {
      affine.for %arg400 = 0 to 12 {
        %2290 = arith.divsi %arg400, %c6 : index
        affine.for %arg401 = 0 to 1 {
          affine.for %arg402 = 0 to 128 {
            memref.store %cst_7, %alloc_127[%arg402] : memref<128xf32>
          }
          %2291:2 = affine.for %arg402 = 0 to 1024 iter_args(%arg403 = %cst_4, %arg404 = %cst_7) -> (f32, f32) {
            %2292 = affine.for %arg405 = 0 to 128 step 16 iter_args(%arg406 = %cst) -> (vector<16xf32>) {
              %2307 = vector.load %889[%arg399, %arg400, %arg401, %arg405] : memref<1x12x1x128xf32>, vector<16xf32>
              %2308 = vector.load %874[%arg399, %2290, %arg402, %arg405] : memref<1x2x1024x128xf32>, vector<16xf32>
              %2309 = vector.fma %2307, %2308, %arg406 : vector<16xf32>
              affine.yield %2309 : vector<16xf32>
            }
            %2293 = vector.reduction <add>, %2292 : vector<16xf32> into f32
            %2294 = arith.mulf %2293, %cst_5 : f32
            %2295 = memref.load %890[%arg399, %c0, %arg401, %arg402] : memref<1x1x1x1024xf32>
            %2296 = arith.addf %2294, %2295 : f32
            %2297 = arith.cmpf ogt, %2296, %arg403 : f32
            %2298 = arith.select %2297, %2296, %arg403 : f32
            %2299 = arith.subf %arg403, %2296 : f32
            %2300 = math.exp %2299 : f32
            %2301 = arith.mulf %2300, %arg404 : f32
            %2302 = arith.addf %2301, %cst_6 : f32
            %2303 = arith.subf %2296, %arg403 : f32
            %2304 = math.exp %2303 : f32
            %2305 = arith.addf %arg404, %2304 : f32
            %2306 = arith.select %2297, %2302, %2305 : f32
            affine.for %arg405 = 0 to 128 {
              %2307 = memref.load %880[%arg399, %2290, %arg402, %arg405] : memref<1x2x1024x128xf32>
              %2308 = memref.load %alloc_127[%arg405] : memref<128xf32>
              %2309 = arith.mulf %2308, %2300 : f32
              %2310 = arith.addf %2309, %2307 : f32
              %2311 = arith.mulf %2304, %2307 : f32
              %2312 = arith.addf %2311, %2308 : f32
              %2313 = arith.select %2297, %2310, %2312 : f32
              memref.store %2313, %alloc_127[%arg405] : memref<128xf32>
            }
            affine.yield %2298, %2306 : f32, f32
          }
          memref.store %2291#1, %alloc_126[%arg399, %arg400, %arg401] : memref<1x12x1xf32>
          affine.for %arg402 = 0 to 128 {
            %2292 = memref.load %alloc_127[%arg402] : memref<128xf32>
            %2293 = arith.divf %2292, %2291#1 : f32
            memref.store %2293, %alloc_125[%arg399, %arg400, %arg401, %arg402] : memref<1x12x1x128xf32>
          }
        }
      }
    }
    %891 = bufferization.to_tensor %alloc_125 restrict : memref<1x12x1x128xf32> to tensor<1x12x1x128xf32>
    %892 = tosa.reshape %891, %12 : (tensor<1x12x1x128xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %893 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%892, %arg154 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %894 = tosa.reshape %893, %13 : (tensor<1x1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %895 = tosa.add %837, %894 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %896 = tensor.empty() : tensor<1x1x1536xf32>
    %897 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%895 : tensor<1x1x1536xf32>) outs(%896 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2290 = math.fpowi %in, %c2_i32 : f32, i32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1536xf32>
    %898 = tosa.reduce_sum %897 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %899 = tosa.mul %898, %0, %15 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1xf32>
    %900 = tosa.add %899, %14 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %901 = tosa.rsqrt %900 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %902 = tosa.mul %895, %901, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %903 = tosa.reshape %arg155, %13 : (tensor<1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %904 = tosa.mul %903, %902, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %905 = tosa.reshape %904, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %906 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%905, %arg156 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_3 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %907 = tosa.reshape %906, %4 : (tensor<1x8960xf32>, !tosa.shape<3>) -> tensor<1x1x8960xf32>
    %908 = tosa.sigmoid %907 : (tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %909 = tosa.mul %907, %908, %15 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>, tensor<1xi8>) -> tensor<1x1x8960xf32>
    %910 = tosa.reshape %904, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %911 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%910, %arg157 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_3 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %912 = tosa.reshape %911, %4 : (tensor<1x8960xf32>, !tosa.shape<3>) -> tensor<1x1x8960xf32>
    %913 = tosa.mul %909, %912, %15 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>, tensor<1xi8>) -> tensor<1x1x8960xf32>
    %914 = tosa.reshape %913, %3 : (tensor<1x1x8960xf32>, !tosa.shape<2>) -> tensor<1x8960xf32>
    %915 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%914, %arg158 : tensor<1x8960xf32>, tensor<8960x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %916 = tosa.reshape %915, %13 : (tensor<1x1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %917 = tosa.add %895, %916 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %918 = tensor.empty() : tensor<1x1x1536xf32>
    %919 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%917 : tensor<1x1x1536xf32>) outs(%918 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2290 = math.fpowi %in, %c2_i32 : f32, i32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1536xf32>
    %920 = tosa.reduce_sum %919 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %921 = tosa.mul %920, %0, %15 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1xf32>
    %922 = tosa.add %921, %14 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %923 = tosa.rsqrt %922 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %924 = tosa.mul %917, %923, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %925 = tosa.reshape %arg159, %13 : (tensor<1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %926 = tosa.mul %925, %924, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %927 = tosa.reshape %926, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %928 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%927, %arg161 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %929 = tosa.reshape %arg160, %12 : (tensor<1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %930 = tosa.add %929, %928 : (tensor<1x1536xf32>, tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %931 = tosa.reshape %930, %11 : (tensor<1x1536xf32>, !tosa.shape<4>) -> tensor<1x12x1x128xf32>
    %932 = tosa.reshape %926, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %933 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%932, %arg163 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_8 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %934 = tosa.reshape %arg162, %10 : (tensor<256xf32>, !tosa.shape<2>) -> tensor<1x256xf32>
    %935 = tosa.add %934, %933 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %936 = tosa.reshape %935, %9 : (tensor<1x256xf32>, !tosa.shape<4>) -> tensor<1x2x1x128xf32>
    %937 = tosa.reshape %926, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %938 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%937, %arg165 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_8 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %939 = tosa.reshape %arg164, %10 : (tensor<256xf32>, !tosa.shape<2>) -> tensor<1x256xf32>
    %940 = tosa.add %939, %938 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %941 = tosa.reshape %940, %9 : (tensor<1x256xf32>, !tosa.shape<4>) -> tensor<1x2x1x128xf32>
    %942 = tosa.reshape %36, %8 : (tensor<1x1x128xf32>, !tosa.shape<4>) -> tensor<1x1x1x128xf32>
    %943 = tosa.reshape %37, %8 : (tensor<1x1x128xf32>, !tosa.shape<4>) -> tensor<1x1x1x128xf32>
    %944 = tosa.mul %931, %942, %15 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x12x1x128xf32>
    %extracted_slice_128 = tensor.extract_slice %931[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %extracted_slice_129 = tensor.extract_slice %931[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %945 = tosa.negate %extracted_slice_129, %19, %19 : (tensor<1x12x1x64xf32>, tensor<1xf32>, tensor<1xf32>) -> tensor<1x12x1x64xf32>
    %946 = tensor.empty() : tensor<1x12x1x128xf32>
    %inserted_slice_130 = tensor.insert_slice %945 into %946[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %inserted_slice_131 = tensor.insert_slice %extracted_slice_128 into %inserted_slice_130[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %947 = tosa.mul %inserted_slice_131, %943, %15 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x12x1x128xf32>
    %948 = tosa.add %944, %947 : (tensor<1x12x1x128xf32>, tensor<1x12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %949 = tosa.mul %936, %942, %15 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x2x1x128xf32>
    %extracted_slice_132 = tensor.extract_slice %936[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %extracted_slice_133 = tensor.extract_slice %936[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %950 = tosa.negate %extracted_slice_133, %19, %19 : (tensor<1x2x1x64xf32>, tensor<1xf32>, tensor<1xf32>) -> tensor<1x2x1x64xf32>
    %951 = tensor.empty() : tensor<1x2x1x128xf32>
    %inserted_slice_134 = tensor.insert_slice %950 into %951[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %inserted_slice_135 = tensor.insert_slice %extracted_slice_132 into %inserted_slice_134[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %952 = tosa.mul %inserted_slice_135, %943, %15 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x2x1x128xf32>
    %953 = tosa.add %949, %952 : (tensor<1x2x1x128xf32>, tensor<1x2x1x128xf32>) -> tensor<1x2x1x128xf32>
    %954 = bufferization.to_buffer %arg166 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %955 = tosa.reshape %arg3, %7 : (tensor<1xi64>, !tosa.shape<4>) -> tensor<1x1x1x1xi64>
    %956 = tosa.add %955, %6 : (tensor<1x1x1x1xi64>, tensor<1x2x1x128xi64>) -> tensor<1x2x1x128xi64>
    %957 = bufferization.to_buffer %956 : tensor<1x2x1x128xi64> to memref<1x2x1x128xi64>
    %958 = bufferization.to_buffer %953 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    scf.for %arg399 = %c0 to %c1 step %c1 {
      scf.for %arg400 = %c0 to %c2 step %c1 {
        scf.for %arg401 = %c0 to %c1 step %c1 {
          scf.for %arg402 = %c0 to %c128 step %c1 {
            %2290 = memref.load %958[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            %2291 = memref.load %957[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xi64>
            %2292 = arith.index_cast %2291 : i64 to index
            memref.store %2290, %954[%arg399, %arg400, %2292, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %959 = bufferization.to_tensor %954 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %960 = bufferization.to_buffer %arg167 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %961 = tosa.reshape %arg3, %7 : (tensor<1xi64>, !tosa.shape<4>) -> tensor<1x1x1x1xi64>
    %962 = tosa.add %961, %6 : (tensor<1x1x1x1xi64>, tensor<1x2x1x128xi64>) -> tensor<1x2x1x128xi64>
    %963 = bufferization.to_buffer %962 : tensor<1x2x1x128xi64> to memref<1x2x1x128xi64>
    %964 = bufferization.to_buffer %941 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    scf.for %arg399 = %c0 to %c1 step %c1 {
      scf.for %arg400 = %c0 to %c2 step %c1 {
        scf.for %arg401 = %c0 to %c1 step %c1 {
          scf.for %arg402 = %c0 to %c128 step %c1 {
            %2290 = memref.load %964[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            %2291 = memref.load %963[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xi64>
            %2292 = arith.index_cast %2291 : i64 to index
            memref.store %2290, %960[%arg399, %arg400, %2292, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %965 = bufferization.to_tensor %960 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %966 = tosa.reshape %28, %5 : (tensor<1x1024xi1>, !tosa.shape<4>) -> tensor<1x1x1x1024xi1>
    %967 = tensor.empty() : tensor<1x1x1x1024xf32>
    %968 = linalg.generic {indexing_maps = [#map1, #map1, #map1, #map1], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%966, %cst_1, %cst_0 : tensor<1x1x1x1024xi1>, tensor<1x1x1x1024xf32>, tensor<1x1x1x1024xf32>) outs(%967 : tensor<1x1x1x1024xf32>) {
    ^bb0(%in: i1, %in_315: f32, %in_316: f32, %out: f32):
      %2290 = arith.select %in, %in_315, %in_316 : f32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1x1024xf32>
    %969 = bufferization.to_buffer %948 : tensor<1x12x1x128xf32> to memref<1x12x1x128xf32>
    %970 = bufferization.to_buffer %968 : tensor<1x1x1x1024xf32> to memref<1x1x1x1024xf32>
    %alloc_136 = memref.alloc() : memref<1x12x1x128xf32>
    %alloc_137 = memref.alloc() : memref<1x12x1xf32>
    %alloc_138 = memref.alloc() : memref<128xf32>
    affine.for %arg399 = 0 to 1 {
      affine.for %arg400 = 0 to 12 {
        %2290 = arith.divsi %arg400, %c6 : index
        affine.for %arg401 = 0 to 1 {
          affine.for %arg402 = 0 to 128 {
            memref.store %cst_7, %alloc_138[%arg402] : memref<128xf32>
          }
          %2291:2 = affine.for %arg402 = 0 to 1024 iter_args(%arg403 = %cst_4, %arg404 = %cst_7) -> (f32, f32) {
            %2292 = affine.for %arg405 = 0 to 128 step 16 iter_args(%arg406 = %cst) -> (vector<16xf32>) {
              %2307 = vector.load %969[%arg399, %arg400, %arg401, %arg405] : memref<1x12x1x128xf32>, vector<16xf32>
              %2308 = vector.load %954[%arg399, %2290, %arg402, %arg405] : memref<1x2x1024x128xf32>, vector<16xf32>
              %2309 = vector.fma %2307, %2308, %arg406 : vector<16xf32>
              affine.yield %2309 : vector<16xf32>
            }
            %2293 = vector.reduction <add>, %2292 : vector<16xf32> into f32
            %2294 = arith.mulf %2293, %cst_5 : f32
            %2295 = memref.load %970[%arg399, %c0, %arg401, %arg402] : memref<1x1x1x1024xf32>
            %2296 = arith.addf %2294, %2295 : f32
            %2297 = arith.cmpf ogt, %2296, %arg403 : f32
            %2298 = arith.select %2297, %2296, %arg403 : f32
            %2299 = arith.subf %arg403, %2296 : f32
            %2300 = math.exp %2299 : f32
            %2301 = arith.mulf %2300, %arg404 : f32
            %2302 = arith.addf %2301, %cst_6 : f32
            %2303 = arith.subf %2296, %arg403 : f32
            %2304 = math.exp %2303 : f32
            %2305 = arith.addf %arg404, %2304 : f32
            %2306 = arith.select %2297, %2302, %2305 : f32
            affine.for %arg405 = 0 to 128 {
              %2307 = memref.load %960[%arg399, %2290, %arg402, %arg405] : memref<1x2x1024x128xf32>
              %2308 = memref.load %alloc_138[%arg405] : memref<128xf32>
              %2309 = arith.mulf %2308, %2300 : f32
              %2310 = arith.addf %2309, %2307 : f32
              %2311 = arith.mulf %2304, %2307 : f32
              %2312 = arith.addf %2311, %2308 : f32
              %2313 = arith.select %2297, %2310, %2312 : f32
              memref.store %2313, %alloc_138[%arg405] : memref<128xf32>
            }
            affine.yield %2298, %2306 : f32, f32
          }
          memref.store %2291#1, %alloc_137[%arg399, %arg400, %arg401] : memref<1x12x1xf32>
          affine.for %arg402 = 0 to 128 {
            %2292 = memref.load %alloc_138[%arg402] : memref<128xf32>
            %2293 = arith.divf %2292, %2291#1 : f32
            memref.store %2293, %alloc_136[%arg399, %arg400, %arg401, %arg402] : memref<1x12x1x128xf32>
          }
        }
      }
    }
    %971 = bufferization.to_tensor %alloc_136 restrict : memref<1x12x1x128xf32> to tensor<1x12x1x128xf32>
    %972 = tosa.reshape %971, %12 : (tensor<1x12x1x128xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %973 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%972, %arg168 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %974 = tosa.reshape %973, %13 : (tensor<1x1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %975 = tosa.add %917, %974 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %976 = tensor.empty() : tensor<1x1x1536xf32>
    %977 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%975 : tensor<1x1x1536xf32>) outs(%976 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2290 = math.fpowi %in, %c2_i32 : f32, i32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1536xf32>
    %978 = tosa.reduce_sum %977 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %979 = tosa.mul %978, %0, %15 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1xf32>
    %980 = tosa.add %979, %14 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %981 = tosa.rsqrt %980 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %982 = tosa.mul %975, %981, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %983 = tosa.reshape %arg169, %13 : (tensor<1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %984 = tosa.mul %983, %982, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %985 = tosa.reshape %984, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %986 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%985, %arg170 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_3 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %987 = tosa.reshape %986, %4 : (tensor<1x8960xf32>, !tosa.shape<3>) -> tensor<1x1x8960xf32>
    %988 = tosa.sigmoid %987 : (tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %989 = tosa.mul %987, %988, %15 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>, tensor<1xi8>) -> tensor<1x1x8960xf32>
    %990 = tosa.reshape %984, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %991 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%990, %arg171 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_3 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %992 = tosa.reshape %991, %4 : (tensor<1x8960xf32>, !tosa.shape<3>) -> tensor<1x1x8960xf32>
    %993 = tosa.mul %989, %992, %15 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>, tensor<1xi8>) -> tensor<1x1x8960xf32>
    %994 = tosa.reshape %993, %3 : (tensor<1x1x8960xf32>, !tosa.shape<2>) -> tensor<1x8960xf32>
    %995 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%994, %arg172 : tensor<1x8960xf32>, tensor<8960x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %996 = tosa.reshape %995, %13 : (tensor<1x1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %997 = tosa.add %975, %996 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %998 = tensor.empty() : tensor<1x1x1536xf32>
    %999 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%997 : tensor<1x1x1536xf32>) outs(%998 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2290 = math.fpowi %in, %c2_i32 : f32, i32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1536xf32>
    %1000 = tosa.reduce_sum %999 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %1001 = tosa.mul %1000, %0, %15 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1xf32>
    %1002 = tosa.add %1001, %14 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1003 = tosa.rsqrt %1002 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1004 = tosa.mul %997, %1003, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %1005 = tosa.reshape %arg173, %13 : (tensor<1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %1006 = tosa.mul %1005, %1004, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %1007 = tosa.reshape %1006, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1008 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1007, %arg175 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1009 = tosa.reshape %arg174, %12 : (tensor<1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1010 = tosa.add %1009, %1008 : (tensor<1x1536xf32>, tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1011 = tosa.reshape %1010, %11 : (tensor<1x1536xf32>, !tosa.shape<4>) -> tensor<1x12x1x128xf32>
    %1012 = tosa.reshape %1006, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1013 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1012, %arg177 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_8 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %1014 = tosa.reshape %arg176, %10 : (tensor<256xf32>, !tosa.shape<2>) -> tensor<1x256xf32>
    %1015 = tosa.add %1014, %1013 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %1016 = tosa.reshape %1015, %9 : (tensor<1x256xf32>, !tosa.shape<4>) -> tensor<1x2x1x128xf32>
    %1017 = tosa.reshape %1006, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1018 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1017, %arg179 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_8 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %1019 = tosa.reshape %arg178, %10 : (tensor<256xf32>, !tosa.shape<2>) -> tensor<1x256xf32>
    %1020 = tosa.add %1019, %1018 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %1021 = tosa.reshape %1020, %9 : (tensor<1x256xf32>, !tosa.shape<4>) -> tensor<1x2x1x128xf32>
    %1022 = tosa.reshape %36, %8 : (tensor<1x1x128xf32>, !tosa.shape<4>) -> tensor<1x1x1x128xf32>
    %1023 = tosa.reshape %37, %8 : (tensor<1x1x128xf32>, !tosa.shape<4>) -> tensor<1x1x1x128xf32>
    %1024 = tosa.mul %1011, %1022, %15 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x12x1x128xf32>
    %extracted_slice_139 = tensor.extract_slice %1011[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %extracted_slice_140 = tensor.extract_slice %1011[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %1025 = tosa.negate %extracted_slice_140, %19, %19 : (tensor<1x12x1x64xf32>, tensor<1xf32>, tensor<1xf32>) -> tensor<1x12x1x64xf32>
    %1026 = tensor.empty() : tensor<1x12x1x128xf32>
    %inserted_slice_141 = tensor.insert_slice %1025 into %1026[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %inserted_slice_142 = tensor.insert_slice %extracted_slice_139 into %inserted_slice_141[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %1027 = tosa.mul %inserted_slice_142, %1023, %15 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x12x1x128xf32>
    %1028 = tosa.add %1024, %1027 : (tensor<1x12x1x128xf32>, tensor<1x12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %1029 = tosa.mul %1016, %1022, %15 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x2x1x128xf32>
    %extracted_slice_143 = tensor.extract_slice %1016[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %extracted_slice_144 = tensor.extract_slice %1016[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %1030 = tosa.negate %extracted_slice_144, %19, %19 : (tensor<1x2x1x64xf32>, tensor<1xf32>, tensor<1xf32>) -> tensor<1x2x1x64xf32>
    %1031 = tensor.empty() : tensor<1x2x1x128xf32>
    %inserted_slice_145 = tensor.insert_slice %1030 into %1031[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %inserted_slice_146 = tensor.insert_slice %extracted_slice_143 into %inserted_slice_145[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %1032 = tosa.mul %inserted_slice_146, %1023, %15 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x2x1x128xf32>
    %1033 = tosa.add %1029, %1032 : (tensor<1x2x1x128xf32>, tensor<1x2x1x128xf32>) -> tensor<1x2x1x128xf32>
    %1034 = bufferization.to_buffer %arg180 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %1035 = tosa.reshape %arg3, %7 : (tensor<1xi64>, !tosa.shape<4>) -> tensor<1x1x1x1xi64>
    %1036 = tosa.add %1035, %6 : (tensor<1x1x1x1xi64>, tensor<1x2x1x128xi64>) -> tensor<1x2x1x128xi64>
    %1037 = bufferization.to_buffer %1036 : tensor<1x2x1x128xi64> to memref<1x2x1x128xi64>
    %1038 = bufferization.to_buffer %1033 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    scf.for %arg399 = %c0 to %c1 step %c1 {
      scf.for %arg400 = %c0 to %c2 step %c1 {
        scf.for %arg401 = %c0 to %c1 step %c1 {
          scf.for %arg402 = %c0 to %c128 step %c1 {
            %2290 = memref.load %1038[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            %2291 = memref.load %1037[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xi64>
            %2292 = arith.index_cast %2291 : i64 to index
            memref.store %2290, %1034[%arg399, %arg400, %2292, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %1039 = bufferization.to_tensor %1034 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %1040 = bufferization.to_buffer %arg181 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %1041 = tosa.reshape %arg3, %7 : (tensor<1xi64>, !tosa.shape<4>) -> tensor<1x1x1x1xi64>
    %1042 = tosa.add %1041, %6 : (tensor<1x1x1x1xi64>, tensor<1x2x1x128xi64>) -> tensor<1x2x1x128xi64>
    %1043 = bufferization.to_buffer %1042 : tensor<1x2x1x128xi64> to memref<1x2x1x128xi64>
    %1044 = bufferization.to_buffer %1021 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    scf.for %arg399 = %c0 to %c1 step %c1 {
      scf.for %arg400 = %c0 to %c2 step %c1 {
        scf.for %arg401 = %c0 to %c1 step %c1 {
          scf.for %arg402 = %c0 to %c128 step %c1 {
            %2290 = memref.load %1044[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            %2291 = memref.load %1043[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xi64>
            %2292 = arith.index_cast %2291 : i64 to index
            memref.store %2290, %1040[%arg399, %arg400, %2292, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %1045 = bufferization.to_tensor %1040 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %1046 = tosa.reshape %28, %5 : (tensor<1x1024xi1>, !tosa.shape<4>) -> tensor<1x1x1x1024xi1>
    %1047 = tensor.empty() : tensor<1x1x1x1024xf32>
    %1048 = linalg.generic {indexing_maps = [#map1, #map1, #map1, #map1], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1046, %cst_1, %cst_0 : tensor<1x1x1x1024xi1>, tensor<1x1x1x1024xf32>, tensor<1x1x1x1024xf32>) outs(%1047 : tensor<1x1x1x1024xf32>) {
    ^bb0(%in: i1, %in_315: f32, %in_316: f32, %out: f32):
      %2290 = arith.select %in, %in_315, %in_316 : f32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1x1024xf32>
    %1049 = bufferization.to_buffer %1028 : tensor<1x12x1x128xf32> to memref<1x12x1x128xf32>
    %1050 = bufferization.to_buffer %1048 : tensor<1x1x1x1024xf32> to memref<1x1x1x1024xf32>
    %alloc_147 = memref.alloc() : memref<1x12x1x128xf32>
    %alloc_148 = memref.alloc() : memref<1x12x1xf32>
    %alloc_149 = memref.alloc() : memref<128xf32>
    affine.for %arg399 = 0 to 1 {
      affine.for %arg400 = 0 to 12 {
        %2290 = arith.divsi %arg400, %c6 : index
        affine.for %arg401 = 0 to 1 {
          affine.for %arg402 = 0 to 128 {
            memref.store %cst_7, %alloc_149[%arg402] : memref<128xf32>
          }
          %2291:2 = affine.for %arg402 = 0 to 1024 iter_args(%arg403 = %cst_4, %arg404 = %cst_7) -> (f32, f32) {
            %2292 = affine.for %arg405 = 0 to 128 step 16 iter_args(%arg406 = %cst) -> (vector<16xf32>) {
              %2307 = vector.load %1049[%arg399, %arg400, %arg401, %arg405] : memref<1x12x1x128xf32>, vector<16xf32>
              %2308 = vector.load %1034[%arg399, %2290, %arg402, %arg405] : memref<1x2x1024x128xf32>, vector<16xf32>
              %2309 = vector.fma %2307, %2308, %arg406 : vector<16xf32>
              affine.yield %2309 : vector<16xf32>
            }
            %2293 = vector.reduction <add>, %2292 : vector<16xf32> into f32
            %2294 = arith.mulf %2293, %cst_5 : f32
            %2295 = memref.load %1050[%arg399, %c0, %arg401, %arg402] : memref<1x1x1x1024xf32>
            %2296 = arith.addf %2294, %2295 : f32
            %2297 = arith.cmpf ogt, %2296, %arg403 : f32
            %2298 = arith.select %2297, %2296, %arg403 : f32
            %2299 = arith.subf %arg403, %2296 : f32
            %2300 = math.exp %2299 : f32
            %2301 = arith.mulf %2300, %arg404 : f32
            %2302 = arith.addf %2301, %cst_6 : f32
            %2303 = arith.subf %2296, %arg403 : f32
            %2304 = math.exp %2303 : f32
            %2305 = arith.addf %arg404, %2304 : f32
            %2306 = arith.select %2297, %2302, %2305 : f32
            affine.for %arg405 = 0 to 128 {
              %2307 = memref.load %1040[%arg399, %2290, %arg402, %arg405] : memref<1x2x1024x128xf32>
              %2308 = memref.load %alloc_149[%arg405] : memref<128xf32>
              %2309 = arith.mulf %2308, %2300 : f32
              %2310 = arith.addf %2309, %2307 : f32
              %2311 = arith.mulf %2304, %2307 : f32
              %2312 = arith.addf %2311, %2308 : f32
              %2313 = arith.select %2297, %2310, %2312 : f32
              memref.store %2313, %alloc_149[%arg405] : memref<128xf32>
            }
            affine.yield %2298, %2306 : f32, f32
          }
          memref.store %2291#1, %alloc_148[%arg399, %arg400, %arg401] : memref<1x12x1xf32>
          affine.for %arg402 = 0 to 128 {
            %2292 = memref.load %alloc_149[%arg402] : memref<128xf32>
            %2293 = arith.divf %2292, %2291#1 : f32
            memref.store %2293, %alloc_147[%arg399, %arg400, %arg401, %arg402] : memref<1x12x1x128xf32>
          }
        }
      }
    }
    %1051 = bufferization.to_tensor %alloc_147 restrict : memref<1x12x1x128xf32> to tensor<1x12x1x128xf32>
    %1052 = tosa.reshape %1051, %12 : (tensor<1x12x1x128xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1053 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1052, %arg182 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1054 = tosa.reshape %1053, %13 : (tensor<1x1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %1055 = tosa.add %997, %1054 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %1056 = tensor.empty() : tensor<1x1x1536xf32>
    %1057 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1055 : tensor<1x1x1536xf32>) outs(%1056 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2290 = math.fpowi %in, %c2_i32 : f32, i32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1536xf32>
    %1058 = tosa.reduce_sum %1057 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %1059 = tosa.mul %1058, %0, %15 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1xf32>
    %1060 = tosa.add %1059, %14 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1061 = tosa.rsqrt %1060 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1062 = tosa.mul %1055, %1061, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %1063 = tosa.reshape %arg183, %13 : (tensor<1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %1064 = tosa.mul %1063, %1062, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %1065 = tosa.reshape %1064, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1066 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1065, %arg184 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_3 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %1067 = tosa.reshape %1066, %4 : (tensor<1x8960xf32>, !tosa.shape<3>) -> tensor<1x1x8960xf32>
    %1068 = tosa.sigmoid %1067 : (tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %1069 = tosa.mul %1067, %1068, %15 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>, tensor<1xi8>) -> tensor<1x1x8960xf32>
    %1070 = tosa.reshape %1064, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1071 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1070, %arg185 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_3 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %1072 = tosa.reshape %1071, %4 : (tensor<1x8960xf32>, !tosa.shape<3>) -> tensor<1x1x8960xf32>
    %1073 = tosa.mul %1069, %1072, %15 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>, tensor<1xi8>) -> tensor<1x1x8960xf32>
    %1074 = tosa.reshape %1073, %3 : (tensor<1x1x8960xf32>, !tosa.shape<2>) -> tensor<1x8960xf32>
    %1075 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1074, %arg186 : tensor<1x8960xf32>, tensor<8960x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1076 = tosa.reshape %1075, %13 : (tensor<1x1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %1077 = tosa.add %1055, %1076 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %1078 = tensor.empty() : tensor<1x1x1536xf32>
    %1079 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1077 : tensor<1x1x1536xf32>) outs(%1078 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2290 = math.fpowi %in, %c2_i32 : f32, i32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1536xf32>
    %1080 = tosa.reduce_sum %1079 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %1081 = tosa.mul %1080, %0, %15 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1xf32>
    %1082 = tosa.add %1081, %14 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1083 = tosa.rsqrt %1082 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1084 = tosa.mul %1077, %1083, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %1085 = tosa.reshape %arg187, %13 : (tensor<1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %1086 = tosa.mul %1085, %1084, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %1087 = tosa.reshape %1086, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1088 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1087, %arg189 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1089 = tosa.reshape %arg188, %12 : (tensor<1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1090 = tosa.add %1089, %1088 : (tensor<1x1536xf32>, tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1091 = tosa.reshape %1090, %11 : (tensor<1x1536xf32>, !tosa.shape<4>) -> tensor<1x12x1x128xf32>
    %1092 = tosa.reshape %1086, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1093 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1092, %arg191 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_8 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %1094 = tosa.reshape %arg190, %10 : (tensor<256xf32>, !tosa.shape<2>) -> tensor<1x256xf32>
    %1095 = tosa.add %1094, %1093 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %1096 = tosa.reshape %1095, %9 : (tensor<1x256xf32>, !tosa.shape<4>) -> tensor<1x2x1x128xf32>
    %1097 = tosa.reshape %1086, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1098 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1097, %arg193 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_8 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %1099 = tosa.reshape %arg192, %10 : (tensor<256xf32>, !tosa.shape<2>) -> tensor<1x256xf32>
    %1100 = tosa.add %1099, %1098 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %1101 = tosa.reshape %1100, %9 : (tensor<1x256xf32>, !tosa.shape<4>) -> tensor<1x2x1x128xf32>
    %1102 = tosa.reshape %36, %8 : (tensor<1x1x128xf32>, !tosa.shape<4>) -> tensor<1x1x1x128xf32>
    %1103 = tosa.reshape %37, %8 : (tensor<1x1x128xf32>, !tosa.shape<4>) -> tensor<1x1x1x128xf32>
    %1104 = tosa.mul %1091, %1102, %15 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x12x1x128xf32>
    %extracted_slice_150 = tensor.extract_slice %1091[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %extracted_slice_151 = tensor.extract_slice %1091[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %1105 = tosa.negate %extracted_slice_151, %19, %19 : (tensor<1x12x1x64xf32>, tensor<1xf32>, tensor<1xf32>) -> tensor<1x12x1x64xf32>
    %1106 = tensor.empty() : tensor<1x12x1x128xf32>
    %inserted_slice_152 = tensor.insert_slice %1105 into %1106[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %inserted_slice_153 = tensor.insert_slice %extracted_slice_150 into %inserted_slice_152[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %1107 = tosa.mul %inserted_slice_153, %1103, %15 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x12x1x128xf32>
    %1108 = tosa.add %1104, %1107 : (tensor<1x12x1x128xf32>, tensor<1x12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %1109 = tosa.mul %1096, %1102, %15 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x2x1x128xf32>
    %extracted_slice_154 = tensor.extract_slice %1096[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %extracted_slice_155 = tensor.extract_slice %1096[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %1110 = tosa.negate %extracted_slice_155, %19, %19 : (tensor<1x2x1x64xf32>, tensor<1xf32>, tensor<1xf32>) -> tensor<1x2x1x64xf32>
    %1111 = tensor.empty() : tensor<1x2x1x128xf32>
    %inserted_slice_156 = tensor.insert_slice %1110 into %1111[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %inserted_slice_157 = tensor.insert_slice %extracted_slice_154 into %inserted_slice_156[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %1112 = tosa.mul %inserted_slice_157, %1103, %15 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x2x1x128xf32>
    %1113 = tosa.add %1109, %1112 : (tensor<1x2x1x128xf32>, tensor<1x2x1x128xf32>) -> tensor<1x2x1x128xf32>
    %1114 = bufferization.to_buffer %arg194 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %1115 = tosa.reshape %arg3, %7 : (tensor<1xi64>, !tosa.shape<4>) -> tensor<1x1x1x1xi64>
    %1116 = tosa.add %1115, %6 : (tensor<1x1x1x1xi64>, tensor<1x2x1x128xi64>) -> tensor<1x2x1x128xi64>
    %1117 = bufferization.to_buffer %1116 : tensor<1x2x1x128xi64> to memref<1x2x1x128xi64>
    %1118 = bufferization.to_buffer %1113 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    scf.for %arg399 = %c0 to %c1 step %c1 {
      scf.for %arg400 = %c0 to %c2 step %c1 {
        scf.for %arg401 = %c0 to %c1 step %c1 {
          scf.for %arg402 = %c0 to %c128 step %c1 {
            %2290 = memref.load %1118[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            %2291 = memref.load %1117[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xi64>
            %2292 = arith.index_cast %2291 : i64 to index
            memref.store %2290, %1114[%arg399, %arg400, %2292, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %1119 = bufferization.to_tensor %1114 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %1120 = bufferization.to_buffer %arg195 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %1121 = tosa.reshape %arg3, %7 : (tensor<1xi64>, !tosa.shape<4>) -> tensor<1x1x1x1xi64>
    %1122 = tosa.add %1121, %6 : (tensor<1x1x1x1xi64>, tensor<1x2x1x128xi64>) -> tensor<1x2x1x128xi64>
    %1123 = bufferization.to_buffer %1122 : tensor<1x2x1x128xi64> to memref<1x2x1x128xi64>
    %1124 = bufferization.to_buffer %1101 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    scf.for %arg399 = %c0 to %c1 step %c1 {
      scf.for %arg400 = %c0 to %c2 step %c1 {
        scf.for %arg401 = %c0 to %c1 step %c1 {
          scf.for %arg402 = %c0 to %c128 step %c1 {
            %2290 = memref.load %1124[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            %2291 = memref.load %1123[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xi64>
            %2292 = arith.index_cast %2291 : i64 to index
            memref.store %2290, %1120[%arg399, %arg400, %2292, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %1125 = bufferization.to_tensor %1120 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %1126 = tosa.reshape %28, %5 : (tensor<1x1024xi1>, !tosa.shape<4>) -> tensor<1x1x1x1024xi1>
    %1127 = tensor.empty() : tensor<1x1x1x1024xf32>
    %1128 = linalg.generic {indexing_maps = [#map1, #map1, #map1, #map1], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1126, %cst_1, %cst_0 : tensor<1x1x1x1024xi1>, tensor<1x1x1x1024xf32>, tensor<1x1x1x1024xf32>) outs(%1127 : tensor<1x1x1x1024xf32>) {
    ^bb0(%in: i1, %in_315: f32, %in_316: f32, %out: f32):
      %2290 = arith.select %in, %in_315, %in_316 : f32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1x1024xf32>
    %1129 = bufferization.to_buffer %1108 : tensor<1x12x1x128xf32> to memref<1x12x1x128xf32>
    %1130 = bufferization.to_buffer %1128 : tensor<1x1x1x1024xf32> to memref<1x1x1x1024xf32>
    %alloc_158 = memref.alloc() : memref<1x12x1x128xf32>
    %alloc_159 = memref.alloc() : memref<1x12x1xf32>
    %alloc_160 = memref.alloc() : memref<128xf32>
    affine.for %arg399 = 0 to 1 {
      affine.for %arg400 = 0 to 12 {
        %2290 = arith.divsi %arg400, %c6 : index
        affine.for %arg401 = 0 to 1 {
          affine.for %arg402 = 0 to 128 {
            memref.store %cst_7, %alloc_160[%arg402] : memref<128xf32>
          }
          %2291:2 = affine.for %arg402 = 0 to 1024 iter_args(%arg403 = %cst_4, %arg404 = %cst_7) -> (f32, f32) {
            %2292 = affine.for %arg405 = 0 to 128 step 16 iter_args(%arg406 = %cst) -> (vector<16xf32>) {
              %2307 = vector.load %1129[%arg399, %arg400, %arg401, %arg405] : memref<1x12x1x128xf32>, vector<16xf32>
              %2308 = vector.load %1114[%arg399, %2290, %arg402, %arg405] : memref<1x2x1024x128xf32>, vector<16xf32>
              %2309 = vector.fma %2307, %2308, %arg406 : vector<16xf32>
              affine.yield %2309 : vector<16xf32>
            }
            %2293 = vector.reduction <add>, %2292 : vector<16xf32> into f32
            %2294 = arith.mulf %2293, %cst_5 : f32
            %2295 = memref.load %1130[%arg399, %c0, %arg401, %arg402] : memref<1x1x1x1024xf32>
            %2296 = arith.addf %2294, %2295 : f32
            %2297 = arith.cmpf ogt, %2296, %arg403 : f32
            %2298 = arith.select %2297, %2296, %arg403 : f32
            %2299 = arith.subf %arg403, %2296 : f32
            %2300 = math.exp %2299 : f32
            %2301 = arith.mulf %2300, %arg404 : f32
            %2302 = arith.addf %2301, %cst_6 : f32
            %2303 = arith.subf %2296, %arg403 : f32
            %2304 = math.exp %2303 : f32
            %2305 = arith.addf %arg404, %2304 : f32
            %2306 = arith.select %2297, %2302, %2305 : f32
            affine.for %arg405 = 0 to 128 {
              %2307 = memref.load %1120[%arg399, %2290, %arg402, %arg405] : memref<1x2x1024x128xf32>
              %2308 = memref.load %alloc_160[%arg405] : memref<128xf32>
              %2309 = arith.mulf %2308, %2300 : f32
              %2310 = arith.addf %2309, %2307 : f32
              %2311 = arith.mulf %2304, %2307 : f32
              %2312 = arith.addf %2311, %2308 : f32
              %2313 = arith.select %2297, %2310, %2312 : f32
              memref.store %2313, %alloc_160[%arg405] : memref<128xf32>
            }
            affine.yield %2298, %2306 : f32, f32
          }
          memref.store %2291#1, %alloc_159[%arg399, %arg400, %arg401] : memref<1x12x1xf32>
          affine.for %arg402 = 0 to 128 {
            %2292 = memref.load %alloc_160[%arg402] : memref<128xf32>
            %2293 = arith.divf %2292, %2291#1 : f32
            memref.store %2293, %alloc_158[%arg399, %arg400, %arg401, %arg402] : memref<1x12x1x128xf32>
          }
        }
      }
    }
    %1131 = bufferization.to_tensor %alloc_158 restrict : memref<1x12x1x128xf32> to tensor<1x12x1x128xf32>
    %1132 = tosa.reshape %1131, %12 : (tensor<1x12x1x128xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1133 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1132, %arg196 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1134 = tosa.reshape %1133, %13 : (tensor<1x1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %1135 = tosa.add %1077, %1134 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %1136 = tensor.empty() : tensor<1x1x1536xf32>
    %1137 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1135 : tensor<1x1x1536xf32>) outs(%1136 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2290 = math.fpowi %in, %c2_i32 : f32, i32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1536xf32>
    %1138 = tosa.reduce_sum %1137 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %1139 = tosa.mul %1138, %0, %15 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1xf32>
    %1140 = tosa.add %1139, %14 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1141 = tosa.rsqrt %1140 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1142 = tosa.mul %1135, %1141, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %1143 = tosa.reshape %arg197, %13 : (tensor<1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %1144 = tosa.mul %1143, %1142, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %1145 = tosa.reshape %1144, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1146 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1145, %arg198 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_3 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %1147 = tosa.reshape %1146, %4 : (tensor<1x8960xf32>, !tosa.shape<3>) -> tensor<1x1x8960xf32>
    %1148 = tosa.sigmoid %1147 : (tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %1149 = tosa.mul %1147, %1148, %15 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>, tensor<1xi8>) -> tensor<1x1x8960xf32>
    %1150 = tosa.reshape %1144, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1151 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1150, %arg199 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_3 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %1152 = tosa.reshape %1151, %4 : (tensor<1x8960xf32>, !tosa.shape<3>) -> tensor<1x1x8960xf32>
    %1153 = tosa.mul %1149, %1152, %15 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>, tensor<1xi8>) -> tensor<1x1x8960xf32>
    %1154 = tosa.reshape %1153, %3 : (tensor<1x1x8960xf32>, !tosa.shape<2>) -> tensor<1x8960xf32>
    %1155 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1154, %arg200 : tensor<1x8960xf32>, tensor<8960x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1156 = tosa.reshape %1155, %13 : (tensor<1x1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %1157 = tosa.add %1135, %1156 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %1158 = tensor.empty() : tensor<1x1x1536xf32>
    %1159 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1157 : tensor<1x1x1536xf32>) outs(%1158 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2290 = math.fpowi %in, %c2_i32 : f32, i32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1536xf32>
    %1160 = tosa.reduce_sum %1159 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %1161 = tosa.mul %1160, %0, %15 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1xf32>
    %1162 = tosa.add %1161, %14 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1163 = tosa.rsqrt %1162 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1164 = tosa.mul %1157, %1163, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %1165 = tosa.reshape %arg201, %13 : (tensor<1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %1166 = tosa.mul %1165, %1164, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %1167 = tosa.reshape %1166, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1168 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1167, %arg203 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1169 = tosa.reshape %arg202, %12 : (tensor<1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1170 = tosa.add %1169, %1168 : (tensor<1x1536xf32>, tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1171 = tosa.reshape %1170, %11 : (tensor<1x1536xf32>, !tosa.shape<4>) -> tensor<1x12x1x128xf32>
    %1172 = tosa.reshape %1166, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1173 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1172, %arg205 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_8 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %1174 = tosa.reshape %arg204, %10 : (tensor<256xf32>, !tosa.shape<2>) -> tensor<1x256xf32>
    %1175 = tosa.add %1174, %1173 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %1176 = tosa.reshape %1175, %9 : (tensor<1x256xf32>, !tosa.shape<4>) -> tensor<1x2x1x128xf32>
    %1177 = tosa.reshape %1166, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1178 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1177, %arg207 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_8 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %1179 = tosa.reshape %arg206, %10 : (tensor<256xf32>, !tosa.shape<2>) -> tensor<1x256xf32>
    %1180 = tosa.add %1179, %1178 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %1181 = tosa.reshape %1180, %9 : (tensor<1x256xf32>, !tosa.shape<4>) -> tensor<1x2x1x128xf32>
    %1182 = tosa.reshape %36, %8 : (tensor<1x1x128xf32>, !tosa.shape<4>) -> tensor<1x1x1x128xf32>
    %1183 = tosa.reshape %37, %8 : (tensor<1x1x128xf32>, !tosa.shape<4>) -> tensor<1x1x1x128xf32>
    %1184 = tosa.mul %1171, %1182, %15 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x12x1x128xf32>
    %extracted_slice_161 = tensor.extract_slice %1171[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %extracted_slice_162 = tensor.extract_slice %1171[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %1185 = tosa.negate %extracted_slice_162, %19, %19 : (tensor<1x12x1x64xf32>, tensor<1xf32>, tensor<1xf32>) -> tensor<1x12x1x64xf32>
    %1186 = tensor.empty() : tensor<1x12x1x128xf32>
    %inserted_slice_163 = tensor.insert_slice %1185 into %1186[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %inserted_slice_164 = tensor.insert_slice %extracted_slice_161 into %inserted_slice_163[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %1187 = tosa.mul %inserted_slice_164, %1183, %15 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x12x1x128xf32>
    %1188 = tosa.add %1184, %1187 : (tensor<1x12x1x128xf32>, tensor<1x12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %1189 = tosa.mul %1176, %1182, %15 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x2x1x128xf32>
    %extracted_slice_165 = tensor.extract_slice %1176[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %extracted_slice_166 = tensor.extract_slice %1176[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %1190 = tosa.negate %extracted_slice_166, %19, %19 : (tensor<1x2x1x64xf32>, tensor<1xf32>, tensor<1xf32>) -> tensor<1x2x1x64xf32>
    %1191 = tensor.empty() : tensor<1x2x1x128xf32>
    %inserted_slice_167 = tensor.insert_slice %1190 into %1191[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %inserted_slice_168 = tensor.insert_slice %extracted_slice_165 into %inserted_slice_167[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %1192 = tosa.mul %inserted_slice_168, %1183, %15 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x2x1x128xf32>
    %1193 = tosa.add %1189, %1192 : (tensor<1x2x1x128xf32>, tensor<1x2x1x128xf32>) -> tensor<1x2x1x128xf32>
    %1194 = bufferization.to_buffer %arg208 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %1195 = tosa.reshape %arg3, %7 : (tensor<1xi64>, !tosa.shape<4>) -> tensor<1x1x1x1xi64>
    %1196 = tosa.add %1195, %6 : (tensor<1x1x1x1xi64>, tensor<1x2x1x128xi64>) -> tensor<1x2x1x128xi64>
    %1197 = bufferization.to_buffer %1196 : tensor<1x2x1x128xi64> to memref<1x2x1x128xi64>
    %1198 = bufferization.to_buffer %1193 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    scf.for %arg399 = %c0 to %c1 step %c1 {
      scf.for %arg400 = %c0 to %c2 step %c1 {
        scf.for %arg401 = %c0 to %c1 step %c1 {
          scf.for %arg402 = %c0 to %c128 step %c1 {
            %2290 = memref.load %1198[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            %2291 = memref.load %1197[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xi64>
            %2292 = arith.index_cast %2291 : i64 to index
            memref.store %2290, %1194[%arg399, %arg400, %2292, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %1199 = bufferization.to_tensor %1194 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %1200 = bufferization.to_buffer %arg209 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %1201 = tosa.reshape %arg3, %7 : (tensor<1xi64>, !tosa.shape<4>) -> tensor<1x1x1x1xi64>
    %1202 = tosa.add %1201, %6 : (tensor<1x1x1x1xi64>, tensor<1x2x1x128xi64>) -> tensor<1x2x1x128xi64>
    %1203 = bufferization.to_buffer %1202 : tensor<1x2x1x128xi64> to memref<1x2x1x128xi64>
    %1204 = bufferization.to_buffer %1181 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    scf.for %arg399 = %c0 to %c1 step %c1 {
      scf.for %arg400 = %c0 to %c2 step %c1 {
        scf.for %arg401 = %c0 to %c1 step %c1 {
          scf.for %arg402 = %c0 to %c128 step %c1 {
            %2290 = memref.load %1204[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            %2291 = memref.load %1203[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xi64>
            %2292 = arith.index_cast %2291 : i64 to index
            memref.store %2290, %1200[%arg399, %arg400, %2292, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %1205 = bufferization.to_tensor %1200 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %1206 = tosa.reshape %28, %5 : (tensor<1x1024xi1>, !tosa.shape<4>) -> tensor<1x1x1x1024xi1>
    %1207 = tensor.empty() : tensor<1x1x1x1024xf32>
    %1208 = linalg.generic {indexing_maps = [#map1, #map1, #map1, #map1], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1206, %cst_1, %cst_0 : tensor<1x1x1x1024xi1>, tensor<1x1x1x1024xf32>, tensor<1x1x1x1024xf32>) outs(%1207 : tensor<1x1x1x1024xf32>) {
    ^bb0(%in: i1, %in_315: f32, %in_316: f32, %out: f32):
      %2290 = arith.select %in, %in_315, %in_316 : f32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1x1024xf32>
    %1209 = bufferization.to_buffer %1188 : tensor<1x12x1x128xf32> to memref<1x12x1x128xf32>
    %1210 = bufferization.to_buffer %1208 : tensor<1x1x1x1024xf32> to memref<1x1x1x1024xf32>
    %alloc_169 = memref.alloc() : memref<1x12x1x128xf32>
    %alloc_170 = memref.alloc() : memref<1x12x1xf32>
    %alloc_171 = memref.alloc() : memref<128xf32>
    affine.for %arg399 = 0 to 1 {
      affine.for %arg400 = 0 to 12 {
        %2290 = arith.divsi %arg400, %c6 : index
        affine.for %arg401 = 0 to 1 {
          affine.for %arg402 = 0 to 128 {
            memref.store %cst_7, %alloc_171[%arg402] : memref<128xf32>
          }
          %2291:2 = affine.for %arg402 = 0 to 1024 iter_args(%arg403 = %cst_4, %arg404 = %cst_7) -> (f32, f32) {
            %2292 = affine.for %arg405 = 0 to 128 step 16 iter_args(%arg406 = %cst) -> (vector<16xf32>) {
              %2307 = vector.load %1209[%arg399, %arg400, %arg401, %arg405] : memref<1x12x1x128xf32>, vector<16xf32>
              %2308 = vector.load %1194[%arg399, %2290, %arg402, %arg405] : memref<1x2x1024x128xf32>, vector<16xf32>
              %2309 = vector.fma %2307, %2308, %arg406 : vector<16xf32>
              affine.yield %2309 : vector<16xf32>
            }
            %2293 = vector.reduction <add>, %2292 : vector<16xf32> into f32
            %2294 = arith.mulf %2293, %cst_5 : f32
            %2295 = memref.load %1210[%arg399, %c0, %arg401, %arg402] : memref<1x1x1x1024xf32>
            %2296 = arith.addf %2294, %2295 : f32
            %2297 = arith.cmpf ogt, %2296, %arg403 : f32
            %2298 = arith.select %2297, %2296, %arg403 : f32
            %2299 = arith.subf %arg403, %2296 : f32
            %2300 = math.exp %2299 : f32
            %2301 = arith.mulf %2300, %arg404 : f32
            %2302 = arith.addf %2301, %cst_6 : f32
            %2303 = arith.subf %2296, %arg403 : f32
            %2304 = math.exp %2303 : f32
            %2305 = arith.addf %arg404, %2304 : f32
            %2306 = arith.select %2297, %2302, %2305 : f32
            affine.for %arg405 = 0 to 128 {
              %2307 = memref.load %1200[%arg399, %2290, %arg402, %arg405] : memref<1x2x1024x128xf32>
              %2308 = memref.load %alloc_171[%arg405] : memref<128xf32>
              %2309 = arith.mulf %2308, %2300 : f32
              %2310 = arith.addf %2309, %2307 : f32
              %2311 = arith.mulf %2304, %2307 : f32
              %2312 = arith.addf %2311, %2308 : f32
              %2313 = arith.select %2297, %2310, %2312 : f32
              memref.store %2313, %alloc_171[%arg405] : memref<128xf32>
            }
            affine.yield %2298, %2306 : f32, f32
          }
          memref.store %2291#1, %alloc_170[%arg399, %arg400, %arg401] : memref<1x12x1xf32>
          affine.for %arg402 = 0 to 128 {
            %2292 = memref.load %alloc_171[%arg402] : memref<128xf32>
            %2293 = arith.divf %2292, %2291#1 : f32
            memref.store %2293, %alloc_169[%arg399, %arg400, %arg401, %arg402] : memref<1x12x1x128xf32>
          }
        }
      }
    }
    %1211 = bufferization.to_tensor %alloc_169 restrict : memref<1x12x1x128xf32> to tensor<1x12x1x128xf32>
    %1212 = tosa.reshape %1211, %12 : (tensor<1x12x1x128xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1213 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1212, %arg210 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1214 = tosa.reshape %1213, %13 : (tensor<1x1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %1215 = tosa.add %1157, %1214 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %1216 = tensor.empty() : tensor<1x1x1536xf32>
    %1217 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1215 : tensor<1x1x1536xf32>) outs(%1216 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2290 = math.fpowi %in, %c2_i32 : f32, i32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1536xf32>
    %1218 = tosa.reduce_sum %1217 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %1219 = tosa.mul %1218, %0, %15 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1xf32>
    %1220 = tosa.add %1219, %14 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1221 = tosa.rsqrt %1220 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1222 = tosa.mul %1215, %1221, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %1223 = tosa.reshape %arg211, %13 : (tensor<1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %1224 = tosa.mul %1223, %1222, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %1225 = tosa.reshape %1224, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1226 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1225, %arg212 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_3 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %1227 = tosa.reshape %1226, %4 : (tensor<1x8960xf32>, !tosa.shape<3>) -> tensor<1x1x8960xf32>
    %1228 = tosa.sigmoid %1227 : (tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %1229 = tosa.mul %1227, %1228, %15 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>, tensor<1xi8>) -> tensor<1x1x8960xf32>
    %1230 = tosa.reshape %1224, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1231 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1230, %arg213 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_3 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %1232 = tosa.reshape %1231, %4 : (tensor<1x8960xf32>, !tosa.shape<3>) -> tensor<1x1x8960xf32>
    %1233 = tosa.mul %1229, %1232, %15 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>, tensor<1xi8>) -> tensor<1x1x8960xf32>
    %1234 = tosa.reshape %1233, %3 : (tensor<1x1x8960xf32>, !tosa.shape<2>) -> tensor<1x8960xf32>
    %1235 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1234, %arg214 : tensor<1x8960xf32>, tensor<8960x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1236 = tosa.reshape %1235, %13 : (tensor<1x1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %1237 = tosa.add %1215, %1236 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %1238 = tensor.empty() : tensor<1x1x1536xf32>
    %1239 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1237 : tensor<1x1x1536xf32>) outs(%1238 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2290 = math.fpowi %in, %c2_i32 : f32, i32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1536xf32>
    %1240 = tosa.reduce_sum %1239 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %1241 = tosa.mul %1240, %0, %15 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1xf32>
    %1242 = tosa.add %1241, %14 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1243 = tosa.rsqrt %1242 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1244 = tosa.mul %1237, %1243, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %1245 = tosa.reshape %arg215, %13 : (tensor<1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %1246 = tosa.mul %1245, %1244, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %1247 = tosa.reshape %1246, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1248 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1247, %arg217 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1249 = tosa.reshape %arg216, %12 : (tensor<1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1250 = tosa.add %1249, %1248 : (tensor<1x1536xf32>, tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1251 = tosa.reshape %1250, %11 : (tensor<1x1536xf32>, !tosa.shape<4>) -> tensor<1x12x1x128xf32>
    %1252 = tosa.reshape %1246, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1253 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1252, %arg219 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_8 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %1254 = tosa.reshape %arg218, %10 : (tensor<256xf32>, !tosa.shape<2>) -> tensor<1x256xf32>
    %1255 = tosa.add %1254, %1253 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %1256 = tosa.reshape %1255, %9 : (tensor<1x256xf32>, !tosa.shape<4>) -> tensor<1x2x1x128xf32>
    %1257 = tosa.reshape %1246, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1258 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1257, %arg221 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_8 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %1259 = tosa.reshape %arg220, %10 : (tensor<256xf32>, !tosa.shape<2>) -> tensor<1x256xf32>
    %1260 = tosa.add %1259, %1258 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %1261 = tosa.reshape %1260, %9 : (tensor<1x256xf32>, !tosa.shape<4>) -> tensor<1x2x1x128xf32>
    %1262 = tosa.reshape %36, %8 : (tensor<1x1x128xf32>, !tosa.shape<4>) -> tensor<1x1x1x128xf32>
    %1263 = tosa.reshape %37, %8 : (tensor<1x1x128xf32>, !tosa.shape<4>) -> tensor<1x1x1x128xf32>
    %1264 = tosa.mul %1251, %1262, %15 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x12x1x128xf32>
    %extracted_slice_172 = tensor.extract_slice %1251[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %extracted_slice_173 = tensor.extract_slice %1251[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %1265 = tosa.negate %extracted_slice_173, %19, %19 : (tensor<1x12x1x64xf32>, tensor<1xf32>, tensor<1xf32>) -> tensor<1x12x1x64xf32>
    %1266 = tensor.empty() : tensor<1x12x1x128xf32>
    %inserted_slice_174 = tensor.insert_slice %1265 into %1266[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %inserted_slice_175 = tensor.insert_slice %extracted_slice_172 into %inserted_slice_174[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %1267 = tosa.mul %inserted_slice_175, %1263, %15 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x12x1x128xf32>
    %1268 = tosa.add %1264, %1267 : (tensor<1x12x1x128xf32>, tensor<1x12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %1269 = tosa.mul %1256, %1262, %15 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x2x1x128xf32>
    %extracted_slice_176 = tensor.extract_slice %1256[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %extracted_slice_177 = tensor.extract_slice %1256[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %1270 = tosa.negate %extracted_slice_177, %19, %19 : (tensor<1x2x1x64xf32>, tensor<1xf32>, tensor<1xf32>) -> tensor<1x2x1x64xf32>
    %1271 = tensor.empty() : tensor<1x2x1x128xf32>
    %inserted_slice_178 = tensor.insert_slice %1270 into %1271[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %inserted_slice_179 = tensor.insert_slice %extracted_slice_176 into %inserted_slice_178[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %1272 = tosa.mul %inserted_slice_179, %1263, %15 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x2x1x128xf32>
    %1273 = tosa.add %1269, %1272 : (tensor<1x2x1x128xf32>, tensor<1x2x1x128xf32>) -> tensor<1x2x1x128xf32>
    %1274 = bufferization.to_buffer %arg222 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %1275 = tosa.reshape %arg3, %7 : (tensor<1xi64>, !tosa.shape<4>) -> tensor<1x1x1x1xi64>
    %1276 = tosa.add %1275, %6 : (tensor<1x1x1x1xi64>, tensor<1x2x1x128xi64>) -> tensor<1x2x1x128xi64>
    %1277 = bufferization.to_buffer %1276 : tensor<1x2x1x128xi64> to memref<1x2x1x128xi64>
    %1278 = bufferization.to_buffer %1273 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    scf.for %arg399 = %c0 to %c1 step %c1 {
      scf.for %arg400 = %c0 to %c2 step %c1 {
        scf.for %arg401 = %c0 to %c1 step %c1 {
          scf.for %arg402 = %c0 to %c128 step %c1 {
            %2290 = memref.load %1278[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            %2291 = memref.load %1277[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xi64>
            %2292 = arith.index_cast %2291 : i64 to index
            memref.store %2290, %1274[%arg399, %arg400, %2292, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %1279 = bufferization.to_tensor %1274 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %1280 = bufferization.to_buffer %arg223 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %1281 = tosa.reshape %arg3, %7 : (tensor<1xi64>, !tosa.shape<4>) -> tensor<1x1x1x1xi64>
    %1282 = tosa.add %1281, %6 : (tensor<1x1x1x1xi64>, tensor<1x2x1x128xi64>) -> tensor<1x2x1x128xi64>
    %1283 = bufferization.to_buffer %1282 : tensor<1x2x1x128xi64> to memref<1x2x1x128xi64>
    %1284 = bufferization.to_buffer %1261 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    scf.for %arg399 = %c0 to %c1 step %c1 {
      scf.for %arg400 = %c0 to %c2 step %c1 {
        scf.for %arg401 = %c0 to %c1 step %c1 {
          scf.for %arg402 = %c0 to %c128 step %c1 {
            %2290 = memref.load %1284[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            %2291 = memref.load %1283[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xi64>
            %2292 = arith.index_cast %2291 : i64 to index
            memref.store %2290, %1280[%arg399, %arg400, %2292, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %1285 = bufferization.to_tensor %1280 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %1286 = tosa.reshape %28, %5 : (tensor<1x1024xi1>, !tosa.shape<4>) -> tensor<1x1x1x1024xi1>
    %1287 = tensor.empty() : tensor<1x1x1x1024xf32>
    %1288 = linalg.generic {indexing_maps = [#map1, #map1, #map1, #map1], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1286, %cst_1, %cst_0 : tensor<1x1x1x1024xi1>, tensor<1x1x1x1024xf32>, tensor<1x1x1x1024xf32>) outs(%1287 : tensor<1x1x1x1024xf32>) {
    ^bb0(%in: i1, %in_315: f32, %in_316: f32, %out: f32):
      %2290 = arith.select %in, %in_315, %in_316 : f32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1x1024xf32>
    %1289 = bufferization.to_buffer %1268 : tensor<1x12x1x128xf32> to memref<1x12x1x128xf32>
    %1290 = bufferization.to_buffer %1288 : tensor<1x1x1x1024xf32> to memref<1x1x1x1024xf32>
    %alloc_180 = memref.alloc() : memref<1x12x1x128xf32>
    %alloc_181 = memref.alloc() : memref<1x12x1xf32>
    %alloc_182 = memref.alloc() : memref<128xf32>
    affine.for %arg399 = 0 to 1 {
      affine.for %arg400 = 0 to 12 {
        %2290 = arith.divsi %arg400, %c6 : index
        affine.for %arg401 = 0 to 1 {
          affine.for %arg402 = 0 to 128 {
            memref.store %cst_7, %alloc_182[%arg402] : memref<128xf32>
          }
          %2291:2 = affine.for %arg402 = 0 to 1024 iter_args(%arg403 = %cst_4, %arg404 = %cst_7) -> (f32, f32) {
            %2292 = affine.for %arg405 = 0 to 128 step 16 iter_args(%arg406 = %cst) -> (vector<16xf32>) {
              %2307 = vector.load %1289[%arg399, %arg400, %arg401, %arg405] : memref<1x12x1x128xf32>, vector<16xf32>
              %2308 = vector.load %1274[%arg399, %2290, %arg402, %arg405] : memref<1x2x1024x128xf32>, vector<16xf32>
              %2309 = vector.fma %2307, %2308, %arg406 : vector<16xf32>
              affine.yield %2309 : vector<16xf32>
            }
            %2293 = vector.reduction <add>, %2292 : vector<16xf32> into f32
            %2294 = arith.mulf %2293, %cst_5 : f32
            %2295 = memref.load %1290[%arg399, %c0, %arg401, %arg402] : memref<1x1x1x1024xf32>
            %2296 = arith.addf %2294, %2295 : f32
            %2297 = arith.cmpf ogt, %2296, %arg403 : f32
            %2298 = arith.select %2297, %2296, %arg403 : f32
            %2299 = arith.subf %arg403, %2296 : f32
            %2300 = math.exp %2299 : f32
            %2301 = arith.mulf %2300, %arg404 : f32
            %2302 = arith.addf %2301, %cst_6 : f32
            %2303 = arith.subf %2296, %arg403 : f32
            %2304 = math.exp %2303 : f32
            %2305 = arith.addf %arg404, %2304 : f32
            %2306 = arith.select %2297, %2302, %2305 : f32
            affine.for %arg405 = 0 to 128 {
              %2307 = memref.load %1280[%arg399, %2290, %arg402, %arg405] : memref<1x2x1024x128xf32>
              %2308 = memref.load %alloc_182[%arg405] : memref<128xf32>
              %2309 = arith.mulf %2308, %2300 : f32
              %2310 = arith.addf %2309, %2307 : f32
              %2311 = arith.mulf %2304, %2307 : f32
              %2312 = arith.addf %2311, %2308 : f32
              %2313 = arith.select %2297, %2310, %2312 : f32
              memref.store %2313, %alloc_182[%arg405] : memref<128xf32>
            }
            affine.yield %2298, %2306 : f32, f32
          }
          memref.store %2291#1, %alloc_181[%arg399, %arg400, %arg401] : memref<1x12x1xf32>
          affine.for %arg402 = 0 to 128 {
            %2292 = memref.load %alloc_182[%arg402] : memref<128xf32>
            %2293 = arith.divf %2292, %2291#1 : f32
            memref.store %2293, %alloc_180[%arg399, %arg400, %arg401, %arg402] : memref<1x12x1x128xf32>
          }
        }
      }
    }
    %1291 = bufferization.to_tensor %alloc_180 restrict : memref<1x12x1x128xf32> to tensor<1x12x1x128xf32>
    %1292 = tosa.reshape %1291, %12 : (tensor<1x12x1x128xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1293 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1292, %arg224 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1294 = tosa.reshape %1293, %13 : (tensor<1x1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %1295 = tosa.add %1237, %1294 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %1296 = tensor.empty() : tensor<1x1x1536xf32>
    %1297 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1295 : tensor<1x1x1536xf32>) outs(%1296 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2290 = math.fpowi %in, %c2_i32 : f32, i32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1536xf32>
    %1298 = tosa.reduce_sum %1297 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %1299 = tosa.mul %1298, %0, %15 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1xf32>
    %1300 = tosa.add %1299, %14 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1301 = tosa.rsqrt %1300 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1302 = tosa.mul %1295, %1301, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %1303 = tosa.reshape %arg225, %13 : (tensor<1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %1304 = tosa.mul %1303, %1302, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %1305 = tosa.reshape %1304, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1306 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1305, %arg226 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_3 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %1307 = tosa.reshape %1306, %4 : (tensor<1x8960xf32>, !tosa.shape<3>) -> tensor<1x1x8960xf32>
    %1308 = tosa.sigmoid %1307 : (tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %1309 = tosa.mul %1307, %1308, %15 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>, tensor<1xi8>) -> tensor<1x1x8960xf32>
    %1310 = tosa.reshape %1304, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1311 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1310, %arg227 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_3 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %1312 = tosa.reshape %1311, %4 : (tensor<1x8960xf32>, !tosa.shape<3>) -> tensor<1x1x8960xf32>
    %1313 = tosa.mul %1309, %1312, %15 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>, tensor<1xi8>) -> tensor<1x1x8960xf32>
    %1314 = tosa.reshape %1313, %3 : (tensor<1x1x8960xf32>, !tosa.shape<2>) -> tensor<1x8960xf32>
    %1315 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1314, %arg228 : tensor<1x8960xf32>, tensor<8960x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1316 = tosa.reshape %1315, %13 : (tensor<1x1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %1317 = tosa.add %1295, %1316 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %1318 = tensor.empty() : tensor<1x1x1536xf32>
    %1319 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1317 : tensor<1x1x1536xf32>) outs(%1318 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2290 = math.fpowi %in, %c2_i32 : f32, i32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1536xf32>
    %1320 = tosa.reduce_sum %1319 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %1321 = tosa.mul %1320, %0, %15 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1xf32>
    %1322 = tosa.add %1321, %14 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1323 = tosa.rsqrt %1322 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1324 = tosa.mul %1317, %1323, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %1325 = tosa.reshape %arg229, %13 : (tensor<1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %1326 = tosa.mul %1325, %1324, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %1327 = tosa.reshape %1326, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1328 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1327, %arg231 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1329 = tosa.reshape %arg230, %12 : (tensor<1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1330 = tosa.add %1329, %1328 : (tensor<1x1536xf32>, tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1331 = tosa.reshape %1330, %11 : (tensor<1x1536xf32>, !tosa.shape<4>) -> tensor<1x12x1x128xf32>
    %1332 = tosa.reshape %1326, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1333 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1332, %arg233 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_8 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %1334 = tosa.reshape %arg232, %10 : (tensor<256xf32>, !tosa.shape<2>) -> tensor<1x256xf32>
    %1335 = tosa.add %1334, %1333 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %1336 = tosa.reshape %1335, %9 : (tensor<1x256xf32>, !tosa.shape<4>) -> tensor<1x2x1x128xf32>
    %1337 = tosa.reshape %1326, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1338 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1337, %arg235 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_8 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %1339 = tosa.reshape %arg234, %10 : (tensor<256xf32>, !tosa.shape<2>) -> tensor<1x256xf32>
    %1340 = tosa.add %1339, %1338 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %1341 = tosa.reshape %1340, %9 : (tensor<1x256xf32>, !tosa.shape<4>) -> tensor<1x2x1x128xf32>
    %1342 = tosa.reshape %36, %8 : (tensor<1x1x128xf32>, !tosa.shape<4>) -> tensor<1x1x1x128xf32>
    %1343 = tosa.reshape %37, %8 : (tensor<1x1x128xf32>, !tosa.shape<4>) -> tensor<1x1x1x128xf32>
    %1344 = tosa.mul %1331, %1342, %15 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x12x1x128xf32>
    %extracted_slice_183 = tensor.extract_slice %1331[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %extracted_slice_184 = tensor.extract_slice %1331[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %1345 = tosa.negate %extracted_slice_184, %19, %19 : (tensor<1x12x1x64xf32>, tensor<1xf32>, tensor<1xf32>) -> tensor<1x12x1x64xf32>
    %1346 = tensor.empty() : tensor<1x12x1x128xf32>
    %inserted_slice_185 = tensor.insert_slice %1345 into %1346[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %inserted_slice_186 = tensor.insert_slice %extracted_slice_183 into %inserted_slice_185[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %1347 = tosa.mul %inserted_slice_186, %1343, %15 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x12x1x128xf32>
    %1348 = tosa.add %1344, %1347 : (tensor<1x12x1x128xf32>, tensor<1x12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %1349 = tosa.mul %1336, %1342, %15 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x2x1x128xf32>
    %extracted_slice_187 = tensor.extract_slice %1336[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %extracted_slice_188 = tensor.extract_slice %1336[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %1350 = tosa.negate %extracted_slice_188, %19, %19 : (tensor<1x2x1x64xf32>, tensor<1xf32>, tensor<1xf32>) -> tensor<1x2x1x64xf32>
    %1351 = tensor.empty() : tensor<1x2x1x128xf32>
    %inserted_slice_189 = tensor.insert_slice %1350 into %1351[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %inserted_slice_190 = tensor.insert_slice %extracted_slice_187 into %inserted_slice_189[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %1352 = tosa.mul %inserted_slice_190, %1343, %15 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x2x1x128xf32>
    %1353 = tosa.add %1349, %1352 : (tensor<1x2x1x128xf32>, tensor<1x2x1x128xf32>) -> tensor<1x2x1x128xf32>
    %1354 = bufferization.to_buffer %arg236 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %1355 = tosa.reshape %arg3, %7 : (tensor<1xi64>, !tosa.shape<4>) -> tensor<1x1x1x1xi64>
    %1356 = tosa.add %1355, %6 : (tensor<1x1x1x1xi64>, tensor<1x2x1x128xi64>) -> tensor<1x2x1x128xi64>
    %1357 = bufferization.to_buffer %1356 : tensor<1x2x1x128xi64> to memref<1x2x1x128xi64>
    %1358 = bufferization.to_buffer %1353 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    scf.for %arg399 = %c0 to %c1 step %c1 {
      scf.for %arg400 = %c0 to %c2 step %c1 {
        scf.for %arg401 = %c0 to %c1 step %c1 {
          scf.for %arg402 = %c0 to %c128 step %c1 {
            %2290 = memref.load %1358[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            %2291 = memref.load %1357[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xi64>
            %2292 = arith.index_cast %2291 : i64 to index
            memref.store %2290, %1354[%arg399, %arg400, %2292, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %1359 = bufferization.to_tensor %1354 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %1360 = bufferization.to_buffer %arg237 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %1361 = tosa.reshape %arg3, %7 : (tensor<1xi64>, !tosa.shape<4>) -> tensor<1x1x1x1xi64>
    %1362 = tosa.add %1361, %6 : (tensor<1x1x1x1xi64>, tensor<1x2x1x128xi64>) -> tensor<1x2x1x128xi64>
    %1363 = bufferization.to_buffer %1362 : tensor<1x2x1x128xi64> to memref<1x2x1x128xi64>
    %1364 = bufferization.to_buffer %1341 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    scf.for %arg399 = %c0 to %c1 step %c1 {
      scf.for %arg400 = %c0 to %c2 step %c1 {
        scf.for %arg401 = %c0 to %c1 step %c1 {
          scf.for %arg402 = %c0 to %c128 step %c1 {
            %2290 = memref.load %1364[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            %2291 = memref.load %1363[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xi64>
            %2292 = arith.index_cast %2291 : i64 to index
            memref.store %2290, %1360[%arg399, %arg400, %2292, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %1365 = bufferization.to_tensor %1360 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %1366 = tosa.reshape %28, %5 : (tensor<1x1024xi1>, !tosa.shape<4>) -> tensor<1x1x1x1024xi1>
    %1367 = tensor.empty() : tensor<1x1x1x1024xf32>
    %1368 = linalg.generic {indexing_maps = [#map1, #map1, #map1, #map1], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1366, %cst_1, %cst_0 : tensor<1x1x1x1024xi1>, tensor<1x1x1x1024xf32>, tensor<1x1x1x1024xf32>) outs(%1367 : tensor<1x1x1x1024xf32>) {
    ^bb0(%in: i1, %in_315: f32, %in_316: f32, %out: f32):
      %2290 = arith.select %in, %in_315, %in_316 : f32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1x1024xf32>
    %1369 = bufferization.to_buffer %1348 : tensor<1x12x1x128xf32> to memref<1x12x1x128xf32>
    %1370 = bufferization.to_buffer %1368 : tensor<1x1x1x1024xf32> to memref<1x1x1x1024xf32>
    %alloc_191 = memref.alloc() : memref<1x12x1x128xf32>
    %alloc_192 = memref.alloc() : memref<1x12x1xf32>
    %alloc_193 = memref.alloc() : memref<128xf32>
    affine.for %arg399 = 0 to 1 {
      affine.for %arg400 = 0 to 12 {
        %2290 = arith.divsi %arg400, %c6 : index
        affine.for %arg401 = 0 to 1 {
          affine.for %arg402 = 0 to 128 {
            memref.store %cst_7, %alloc_193[%arg402] : memref<128xf32>
          }
          %2291:2 = affine.for %arg402 = 0 to 1024 iter_args(%arg403 = %cst_4, %arg404 = %cst_7) -> (f32, f32) {
            %2292 = affine.for %arg405 = 0 to 128 step 16 iter_args(%arg406 = %cst) -> (vector<16xf32>) {
              %2307 = vector.load %1369[%arg399, %arg400, %arg401, %arg405] : memref<1x12x1x128xf32>, vector<16xf32>
              %2308 = vector.load %1354[%arg399, %2290, %arg402, %arg405] : memref<1x2x1024x128xf32>, vector<16xf32>
              %2309 = vector.fma %2307, %2308, %arg406 : vector<16xf32>
              affine.yield %2309 : vector<16xf32>
            }
            %2293 = vector.reduction <add>, %2292 : vector<16xf32> into f32
            %2294 = arith.mulf %2293, %cst_5 : f32
            %2295 = memref.load %1370[%arg399, %c0, %arg401, %arg402] : memref<1x1x1x1024xf32>
            %2296 = arith.addf %2294, %2295 : f32
            %2297 = arith.cmpf ogt, %2296, %arg403 : f32
            %2298 = arith.select %2297, %2296, %arg403 : f32
            %2299 = arith.subf %arg403, %2296 : f32
            %2300 = math.exp %2299 : f32
            %2301 = arith.mulf %2300, %arg404 : f32
            %2302 = arith.addf %2301, %cst_6 : f32
            %2303 = arith.subf %2296, %arg403 : f32
            %2304 = math.exp %2303 : f32
            %2305 = arith.addf %arg404, %2304 : f32
            %2306 = arith.select %2297, %2302, %2305 : f32
            affine.for %arg405 = 0 to 128 {
              %2307 = memref.load %1360[%arg399, %2290, %arg402, %arg405] : memref<1x2x1024x128xf32>
              %2308 = memref.load %alloc_193[%arg405] : memref<128xf32>
              %2309 = arith.mulf %2308, %2300 : f32
              %2310 = arith.addf %2309, %2307 : f32
              %2311 = arith.mulf %2304, %2307 : f32
              %2312 = arith.addf %2311, %2308 : f32
              %2313 = arith.select %2297, %2310, %2312 : f32
              memref.store %2313, %alloc_193[%arg405] : memref<128xf32>
            }
            affine.yield %2298, %2306 : f32, f32
          }
          memref.store %2291#1, %alloc_192[%arg399, %arg400, %arg401] : memref<1x12x1xf32>
          affine.for %arg402 = 0 to 128 {
            %2292 = memref.load %alloc_193[%arg402] : memref<128xf32>
            %2293 = arith.divf %2292, %2291#1 : f32
            memref.store %2293, %alloc_191[%arg399, %arg400, %arg401, %arg402] : memref<1x12x1x128xf32>
          }
        }
      }
    }
    %1371 = bufferization.to_tensor %alloc_191 restrict : memref<1x12x1x128xf32> to tensor<1x12x1x128xf32>
    %1372 = tosa.reshape %1371, %12 : (tensor<1x12x1x128xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1373 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1372, %arg238 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1374 = tosa.reshape %1373, %13 : (tensor<1x1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %1375 = tosa.add %1317, %1374 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %1376 = tensor.empty() : tensor<1x1x1536xf32>
    %1377 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1375 : tensor<1x1x1536xf32>) outs(%1376 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2290 = math.fpowi %in, %c2_i32 : f32, i32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1536xf32>
    %1378 = tosa.reduce_sum %1377 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %1379 = tosa.mul %1378, %0, %15 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1xf32>
    %1380 = tosa.add %1379, %14 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1381 = tosa.rsqrt %1380 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1382 = tosa.mul %1375, %1381, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %1383 = tosa.reshape %arg239, %13 : (tensor<1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %1384 = tosa.mul %1383, %1382, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %1385 = tosa.reshape %1384, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1386 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1385, %arg240 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_3 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %1387 = tosa.reshape %1386, %4 : (tensor<1x8960xf32>, !tosa.shape<3>) -> tensor<1x1x8960xf32>
    %1388 = tosa.sigmoid %1387 : (tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %1389 = tosa.mul %1387, %1388, %15 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>, tensor<1xi8>) -> tensor<1x1x8960xf32>
    %1390 = tosa.reshape %1384, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1391 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1390, %arg241 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_3 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %1392 = tosa.reshape %1391, %4 : (tensor<1x8960xf32>, !tosa.shape<3>) -> tensor<1x1x8960xf32>
    %1393 = tosa.mul %1389, %1392, %15 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>, tensor<1xi8>) -> tensor<1x1x8960xf32>
    %1394 = tosa.reshape %1393, %3 : (tensor<1x1x8960xf32>, !tosa.shape<2>) -> tensor<1x8960xf32>
    %1395 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1394, %arg242 : tensor<1x8960xf32>, tensor<8960x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1396 = tosa.reshape %1395, %13 : (tensor<1x1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %1397 = tosa.add %1375, %1396 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %1398 = tensor.empty() : tensor<1x1x1536xf32>
    %1399 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1397 : tensor<1x1x1536xf32>) outs(%1398 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2290 = math.fpowi %in, %c2_i32 : f32, i32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1536xf32>
    %1400 = tosa.reduce_sum %1399 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %1401 = tosa.mul %1400, %0, %15 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1xf32>
    %1402 = tosa.add %1401, %14 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1403 = tosa.rsqrt %1402 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1404 = tosa.mul %1397, %1403, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %1405 = tosa.reshape %arg243, %13 : (tensor<1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %1406 = tosa.mul %1405, %1404, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %1407 = tosa.reshape %1406, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1408 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1407, %arg245 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1409 = tosa.reshape %arg244, %12 : (tensor<1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1410 = tosa.add %1409, %1408 : (tensor<1x1536xf32>, tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1411 = tosa.reshape %1410, %11 : (tensor<1x1536xf32>, !tosa.shape<4>) -> tensor<1x12x1x128xf32>
    %1412 = tosa.reshape %1406, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1413 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1412, %arg247 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_8 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %1414 = tosa.reshape %arg246, %10 : (tensor<256xf32>, !tosa.shape<2>) -> tensor<1x256xf32>
    %1415 = tosa.add %1414, %1413 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %1416 = tosa.reshape %1415, %9 : (tensor<1x256xf32>, !tosa.shape<4>) -> tensor<1x2x1x128xf32>
    %1417 = tosa.reshape %1406, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1418 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1417, %arg249 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_8 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %1419 = tosa.reshape %arg248, %10 : (tensor<256xf32>, !tosa.shape<2>) -> tensor<1x256xf32>
    %1420 = tosa.add %1419, %1418 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %1421 = tosa.reshape %1420, %9 : (tensor<1x256xf32>, !tosa.shape<4>) -> tensor<1x2x1x128xf32>
    %1422 = tosa.reshape %36, %8 : (tensor<1x1x128xf32>, !tosa.shape<4>) -> tensor<1x1x1x128xf32>
    %1423 = tosa.reshape %37, %8 : (tensor<1x1x128xf32>, !tosa.shape<4>) -> tensor<1x1x1x128xf32>
    %1424 = tosa.mul %1411, %1422, %15 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x12x1x128xf32>
    %extracted_slice_194 = tensor.extract_slice %1411[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %extracted_slice_195 = tensor.extract_slice %1411[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %1425 = tosa.negate %extracted_slice_195, %19, %19 : (tensor<1x12x1x64xf32>, tensor<1xf32>, tensor<1xf32>) -> tensor<1x12x1x64xf32>
    %1426 = tensor.empty() : tensor<1x12x1x128xf32>
    %inserted_slice_196 = tensor.insert_slice %1425 into %1426[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %inserted_slice_197 = tensor.insert_slice %extracted_slice_194 into %inserted_slice_196[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %1427 = tosa.mul %inserted_slice_197, %1423, %15 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x12x1x128xf32>
    %1428 = tosa.add %1424, %1427 : (tensor<1x12x1x128xf32>, tensor<1x12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %1429 = tosa.mul %1416, %1422, %15 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x2x1x128xf32>
    %extracted_slice_198 = tensor.extract_slice %1416[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %extracted_slice_199 = tensor.extract_slice %1416[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %1430 = tosa.negate %extracted_slice_199, %19, %19 : (tensor<1x2x1x64xf32>, tensor<1xf32>, tensor<1xf32>) -> tensor<1x2x1x64xf32>
    %1431 = tensor.empty() : tensor<1x2x1x128xf32>
    %inserted_slice_200 = tensor.insert_slice %1430 into %1431[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %inserted_slice_201 = tensor.insert_slice %extracted_slice_198 into %inserted_slice_200[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %1432 = tosa.mul %inserted_slice_201, %1423, %15 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x2x1x128xf32>
    %1433 = tosa.add %1429, %1432 : (tensor<1x2x1x128xf32>, tensor<1x2x1x128xf32>) -> tensor<1x2x1x128xf32>
    %1434 = bufferization.to_buffer %arg250 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %1435 = tosa.reshape %arg3, %7 : (tensor<1xi64>, !tosa.shape<4>) -> tensor<1x1x1x1xi64>
    %1436 = tosa.add %1435, %6 : (tensor<1x1x1x1xi64>, tensor<1x2x1x128xi64>) -> tensor<1x2x1x128xi64>
    %1437 = bufferization.to_buffer %1436 : tensor<1x2x1x128xi64> to memref<1x2x1x128xi64>
    %1438 = bufferization.to_buffer %1433 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    scf.for %arg399 = %c0 to %c1 step %c1 {
      scf.for %arg400 = %c0 to %c2 step %c1 {
        scf.for %arg401 = %c0 to %c1 step %c1 {
          scf.for %arg402 = %c0 to %c128 step %c1 {
            %2290 = memref.load %1438[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            %2291 = memref.load %1437[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xi64>
            %2292 = arith.index_cast %2291 : i64 to index
            memref.store %2290, %1434[%arg399, %arg400, %2292, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %1439 = bufferization.to_tensor %1434 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %1440 = bufferization.to_buffer %arg251 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %1441 = tosa.reshape %arg3, %7 : (tensor<1xi64>, !tosa.shape<4>) -> tensor<1x1x1x1xi64>
    %1442 = tosa.add %1441, %6 : (tensor<1x1x1x1xi64>, tensor<1x2x1x128xi64>) -> tensor<1x2x1x128xi64>
    %1443 = bufferization.to_buffer %1442 : tensor<1x2x1x128xi64> to memref<1x2x1x128xi64>
    %1444 = bufferization.to_buffer %1421 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    scf.for %arg399 = %c0 to %c1 step %c1 {
      scf.for %arg400 = %c0 to %c2 step %c1 {
        scf.for %arg401 = %c0 to %c1 step %c1 {
          scf.for %arg402 = %c0 to %c128 step %c1 {
            %2290 = memref.load %1444[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            %2291 = memref.load %1443[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xi64>
            %2292 = arith.index_cast %2291 : i64 to index
            memref.store %2290, %1440[%arg399, %arg400, %2292, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %1445 = bufferization.to_tensor %1440 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %1446 = tosa.reshape %28, %5 : (tensor<1x1024xi1>, !tosa.shape<4>) -> tensor<1x1x1x1024xi1>
    %1447 = tensor.empty() : tensor<1x1x1x1024xf32>
    %1448 = linalg.generic {indexing_maps = [#map1, #map1, #map1, #map1], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1446, %cst_1, %cst_0 : tensor<1x1x1x1024xi1>, tensor<1x1x1x1024xf32>, tensor<1x1x1x1024xf32>) outs(%1447 : tensor<1x1x1x1024xf32>) {
    ^bb0(%in: i1, %in_315: f32, %in_316: f32, %out: f32):
      %2290 = arith.select %in, %in_315, %in_316 : f32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1x1024xf32>
    %1449 = bufferization.to_buffer %1428 : tensor<1x12x1x128xf32> to memref<1x12x1x128xf32>
    %1450 = bufferization.to_buffer %1448 : tensor<1x1x1x1024xf32> to memref<1x1x1x1024xf32>
    %alloc_202 = memref.alloc() : memref<1x12x1x128xf32>
    %alloc_203 = memref.alloc() : memref<1x12x1xf32>
    %alloc_204 = memref.alloc() : memref<128xf32>
    affine.for %arg399 = 0 to 1 {
      affine.for %arg400 = 0 to 12 {
        %2290 = arith.divsi %arg400, %c6 : index
        affine.for %arg401 = 0 to 1 {
          affine.for %arg402 = 0 to 128 {
            memref.store %cst_7, %alloc_204[%arg402] : memref<128xf32>
          }
          %2291:2 = affine.for %arg402 = 0 to 1024 iter_args(%arg403 = %cst_4, %arg404 = %cst_7) -> (f32, f32) {
            %2292 = affine.for %arg405 = 0 to 128 step 16 iter_args(%arg406 = %cst) -> (vector<16xf32>) {
              %2307 = vector.load %1449[%arg399, %arg400, %arg401, %arg405] : memref<1x12x1x128xf32>, vector<16xf32>
              %2308 = vector.load %1434[%arg399, %2290, %arg402, %arg405] : memref<1x2x1024x128xf32>, vector<16xf32>
              %2309 = vector.fma %2307, %2308, %arg406 : vector<16xf32>
              affine.yield %2309 : vector<16xf32>
            }
            %2293 = vector.reduction <add>, %2292 : vector<16xf32> into f32
            %2294 = arith.mulf %2293, %cst_5 : f32
            %2295 = memref.load %1450[%arg399, %c0, %arg401, %arg402] : memref<1x1x1x1024xf32>
            %2296 = arith.addf %2294, %2295 : f32
            %2297 = arith.cmpf ogt, %2296, %arg403 : f32
            %2298 = arith.select %2297, %2296, %arg403 : f32
            %2299 = arith.subf %arg403, %2296 : f32
            %2300 = math.exp %2299 : f32
            %2301 = arith.mulf %2300, %arg404 : f32
            %2302 = arith.addf %2301, %cst_6 : f32
            %2303 = arith.subf %2296, %arg403 : f32
            %2304 = math.exp %2303 : f32
            %2305 = arith.addf %arg404, %2304 : f32
            %2306 = arith.select %2297, %2302, %2305 : f32
            affine.for %arg405 = 0 to 128 {
              %2307 = memref.load %1440[%arg399, %2290, %arg402, %arg405] : memref<1x2x1024x128xf32>
              %2308 = memref.load %alloc_204[%arg405] : memref<128xf32>
              %2309 = arith.mulf %2308, %2300 : f32
              %2310 = arith.addf %2309, %2307 : f32
              %2311 = arith.mulf %2304, %2307 : f32
              %2312 = arith.addf %2311, %2308 : f32
              %2313 = arith.select %2297, %2310, %2312 : f32
              memref.store %2313, %alloc_204[%arg405] : memref<128xf32>
            }
            affine.yield %2298, %2306 : f32, f32
          }
          memref.store %2291#1, %alloc_203[%arg399, %arg400, %arg401] : memref<1x12x1xf32>
          affine.for %arg402 = 0 to 128 {
            %2292 = memref.load %alloc_204[%arg402] : memref<128xf32>
            %2293 = arith.divf %2292, %2291#1 : f32
            memref.store %2293, %alloc_202[%arg399, %arg400, %arg401, %arg402] : memref<1x12x1x128xf32>
          }
        }
      }
    }
    %1451 = bufferization.to_tensor %alloc_202 restrict : memref<1x12x1x128xf32> to tensor<1x12x1x128xf32>
    %1452 = tosa.reshape %1451, %12 : (tensor<1x12x1x128xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1453 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1452, %arg252 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1454 = tosa.reshape %1453, %13 : (tensor<1x1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %1455 = tosa.add %1397, %1454 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %1456 = tensor.empty() : tensor<1x1x1536xf32>
    %1457 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1455 : tensor<1x1x1536xf32>) outs(%1456 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2290 = math.fpowi %in, %c2_i32 : f32, i32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1536xf32>
    %1458 = tosa.reduce_sum %1457 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %1459 = tosa.mul %1458, %0, %15 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1xf32>
    %1460 = tosa.add %1459, %14 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1461 = tosa.rsqrt %1460 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1462 = tosa.mul %1455, %1461, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %1463 = tosa.reshape %arg253, %13 : (tensor<1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %1464 = tosa.mul %1463, %1462, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %1465 = tosa.reshape %1464, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1466 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1465, %arg254 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_3 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %1467 = tosa.reshape %1466, %4 : (tensor<1x8960xf32>, !tosa.shape<3>) -> tensor<1x1x8960xf32>
    %1468 = tosa.sigmoid %1467 : (tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %1469 = tosa.mul %1467, %1468, %15 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>, tensor<1xi8>) -> tensor<1x1x8960xf32>
    %1470 = tosa.reshape %1464, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1471 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1470, %arg255 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_3 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %1472 = tosa.reshape %1471, %4 : (tensor<1x8960xf32>, !tosa.shape<3>) -> tensor<1x1x8960xf32>
    %1473 = tosa.mul %1469, %1472, %15 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>, tensor<1xi8>) -> tensor<1x1x8960xf32>
    %1474 = tosa.reshape %1473, %3 : (tensor<1x1x8960xf32>, !tosa.shape<2>) -> tensor<1x8960xf32>
    %1475 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1474, %arg256 : tensor<1x8960xf32>, tensor<8960x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1476 = tosa.reshape %1475, %13 : (tensor<1x1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %1477 = tosa.add %1455, %1476 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %1478 = tensor.empty() : tensor<1x1x1536xf32>
    %1479 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1477 : tensor<1x1x1536xf32>) outs(%1478 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2290 = math.fpowi %in, %c2_i32 : f32, i32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1536xf32>
    %1480 = tosa.reduce_sum %1479 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %1481 = tosa.mul %1480, %0, %15 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1xf32>
    %1482 = tosa.add %1481, %14 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1483 = tosa.rsqrt %1482 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1484 = tosa.mul %1477, %1483, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %1485 = tosa.reshape %arg257, %13 : (tensor<1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %1486 = tosa.mul %1485, %1484, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %1487 = tosa.reshape %1486, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1488 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1487, %arg259 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1489 = tosa.reshape %arg258, %12 : (tensor<1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1490 = tosa.add %1489, %1488 : (tensor<1x1536xf32>, tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1491 = tosa.reshape %1490, %11 : (tensor<1x1536xf32>, !tosa.shape<4>) -> tensor<1x12x1x128xf32>
    %1492 = tosa.reshape %1486, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1493 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1492, %arg261 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_8 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %1494 = tosa.reshape %arg260, %10 : (tensor<256xf32>, !tosa.shape<2>) -> tensor<1x256xf32>
    %1495 = tosa.add %1494, %1493 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %1496 = tosa.reshape %1495, %9 : (tensor<1x256xf32>, !tosa.shape<4>) -> tensor<1x2x1x128xf32>
    %1497 = tosa.reshape %1486, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1498 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1497, %arg263 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_8 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %1499 = tosa.reshape %arg262, %10 : (tensor<256xf32>, !tosa.shape<2>) -> tensor<1x256xf32>
    %1500 = tosa.add %1499, %1498 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %1501 = tosa.reshape %1500, %9 : (tensor<1x256xf32>, !tosa.shape<4>) -> tensor<1x2x1x128xf32>
    %1502 = tosa.reshape %36, %8 : (tensor<1x1x128xf32>, !tosa.shape<4>) -> tensor<1x1x1x128xf32>
    %1503 = tosa.reshape %37, %8 : (tensor<1x1x128xf32>, !tosa.shape<4>) -> tensor<1x1x1x128xf32>
    %1504 = tosa.mul %1491, %1502, %15 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x12x1x128xf32>
    %extracted_slice_205 = tensor.extract_slice %1491[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %extracted_slice_206 = tensor.extract_slice %1491[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %1505 = tosa.negate %extracted_slice_206, %19, %19 : (tensor<1x12x1x64xf32>, tensor<1xf32>, tensor<1xf32>) -> tensor<1x12x1x64xf32>
    %1506 = tensor.empty() : tensor<1x12x1x128xf32>
    %inserted_slice_207 = tensor.insert_slice %1505 into %1506[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %inserted_slice_208 = tensor.insert_slice %extracted_slice_205 into %inserted_slice_207[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %1507 = tosa.mul %inserted_slice_208, %1503, %15 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x12x1x128xf32>
    %1508 = tosa.add %1504, %1507 : (tensor<1x12x1x128xf32>, tensor<1x12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %1509 = tosa.mul %1496, %1502, %15 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x2x1x128xf32>
    %extracted_slice_209 = tensor.extract_slice %1496[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %extracted_slice_210 = tensor.extract_slice %1496[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %1510 = tosa.negate %extracted_slice_210, %19, %19 : (tensor<1x2x1x64xf32>, tensor<1xf32>, tensor<1xf32>) -> tensor<1x2x1x64xf32>
    %1511 = tensor.empty() : tensor<1x2x1x128xf32>
    %inserted_slice_211 = tensor.insert_slice %1510 into %1511[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %inserted_slice_212 = tensor.insert_slice %extracted_slice_209 into %inserted_slice_211[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %1512 = tosa.mul %inserted_slice_212, %1503, %15 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x2x1x128xf32>
    %1513 = tosa.add %1509, %1512 : (tensor<1x2x1x128xf32>, tensor<1x2x1x128xf32>) -> tensor<1x2x1x128xf32>
    %1514 = bufferization.to_buffer %arg264 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %1515 = tosa.reshape %arg3, %7 : (tensor<1xi64>, !tosa.shape<4>) -> tensor<1x1x1x1xi64>
    %1516 = tosa.add %1515, %6 : (tensor<1x1x1x1xi64>, tensor<1x2x1x128xi64>) -> tensor<1x2x1x128xi64>
    %1517 = bufferization.to_buffer %1516 : tensor<1x2x1x128xi64> to memref<1x2x1x128xi64>
    %1518 = bufferization.to_buffer %1513 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    scf.for %arg399 = %c0 to %c1 step %c1 {
      scf.for %arg400 = %c0 to %c2 step %c1 {
        scf.for %arg401 = %c0 to %c1 step %c1 {
          scf.for %arg402 = %c0 to %c128 step %c1 {
            %2290 = memref.load %1518[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            %2291 = memref.load %1517[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xi64>
            %2292 = arith.index_cast %2291 : i64 to index
            memref.store %2290, %1514[%arg399, %arg400, %2292, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %1519 = bufferization.to_tensor %1514 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %1520 = bufferization.to_buffer %arg265 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %1521 = tosa.reshape %arg3, %7 : (tensor<1xi64>, !tosa.shape<4>) -> tensor<1x1x1x1xi64>
    %1522 = tosa.add %1521, %6 : (tensor<1x1x1x1xi64>, tensor<1x2x1x128xi64>) -> tensor<1x2x1x128xi64>
    %1523 = bufferization.to_buffer %1522 : tensor<1x2x1x128xi64> to memref<1x2x1x128xi64>
    %1524 = bufferization.to_buffer %1501 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    scf.for %arg399 = %c0 to %c1 step %c1 {
      scf.for %arg400 = %c0 to %c2 step %c1 {
        scf.for %arg401 = %c0 to %c1 step %c1 {
          scf.for %arg402 = %c0 to %c128 step %c1 {
            %2290 = memref.load %1524[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            %2291 = memref.load %1523[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xi64>
            %2292 = arith.index_cast %2291 : i64 to index
            memref.store %2290, %1520[%arg399, %arg400, %2292, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %1525 = bufferization.to_tensor %1520 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %1526 = tosa.reshape %28, %5 : (tensor<1x1024xi1>, !tosa.shape<4>) -> tensor<1x1x1x1024xi1>
    %1527 = tensor.empty() : tensor<1x1x1x1024xf32>
    %1528 = linalg.generic {indexing_maps = [#map1, #map1, #map1, #map1], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1526, %cst_1, %cst_0 : tensor<1x1x1x1024xi1>, tensor<1x1x1x1024xf32>, tensor<1x1x1x1024xf32>) outs(%1527 : tensor<1x1x1x1024xf32>) {
    ^bb0(%in: i1, %in_315: f32, %in_316: f32, %out: f32):
      %2290 = arith.select %in, %in_315, %in_316 : f32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1x1024xf32>
    %1529 = bufferization.to_buffer %1508 : tensor<1x12x1x128xf32> to memref<1x12x1x128xf32>
    %1530 = bufferization.to_buffer %1528 : tensor<1x1x1x1024xf32> to memref<1x1x1x1024xf32>
    %alloc_213 = memref.alloc() : memref<1x12x1x128xf32>
    %alloc_214 = memref.alloc() : memref<1x12x1xf32>
    %alloc_215 = memref.alloc() : memref<128xf32>
    affine.for %arg399 = 0 to 1 {
      affine.for %arg400 = 0 to 12 {
        %2290 = arith.divsi %arg400, %c6 : index
        affine.for %arg401 = 0 to 1 {
          affine.for %arg402 = 0 to 128 {
            memref.store %cst_7, %alloc_215[%arg402] : memref<128xf32>
          }
          %2291:2 = affine.for %arg402 = 0 to 1024 iter_args(%arg403 = %cst_4, %arg404 = %cst_7) -> (f32, f32) {
            %2292 = affine.for %arg405 = 0 to 128 step 16 iter_args(%arg406 = %cst) -> (vector<16xf32>) {
              %2307 = vector.load %1529[%arg399, %arg400, %arg401, %arg405] : memref<1x12x1x128xf32>, vector<16xf32>
              %2308 = vector.load %1514[%arg399, %2290, %arg402, %arg405] : memref<1x2x1024x128xf32>, vector<16xf32>
              %2309 = vector.fma %2307, %2308, %arg406 : vector<16xf32>
              affine.yield %2309 : vector<16xf32>
            }
            %2293 = vector.reduction <add>, %2292 : vector<16xf32> into f32
            %2294 = arith.mulf %2293, %cst_5 : f32
            %2295 = memref.load %1530[%arg399, %c0, %arg401, %arg402] : memref<1x1x1x1024xf32>
            %2296 = arith.addf %2294, %2295 : f32
            %2297 = arith.cmpf ogt, %2296, %arg403 : f32
            %2298 = arith.select %2297, %2296, %arg403 : f32
            %2299 = arith.subf %arg403, %2296 : f32
            %2300 = math.exp %2299 : f32
            %2301 = arith.mulf %2300, %arg404 : f32
            %2302 = arith.addf %2301, %cst_6 : f32
            %2303 = arith.subf %2296, %arg403 : f32
            %2304 = math.exp %2303 : f32
            %2305 = arith.addf %arg404, %2304 : f32
            %2306 = arith.select %2297, %2302, %2305 : f32
            affine.for %arg405 = 0 to 128 {
              %2307 = memref.load %1520[%arg399, %2290, %arg402, %arg405] : memref<1x2x1024x128xf32>
              %2308 = memref.load %alloc_215[%arg405] : memref<128xf32>
              %2309 = arith.mulf %2308, %2300 : f32
              %2310 = arith.addf %2309, %2307 : f32
              %2311 = arith.mulf %2304, %2307 : f32
              %2312 = arith.addf %2311, %2308 : f32
              %2313 = arith.select %2297, %2310, %2312 : f32
              memref.store %2313, %alloc_215[%arg405] : memref<128xf32>
            }
            affine.yield %2298, %2306 : f32, f32
          }
          memref.store %2291#1, %alloc_214[%arg399, %arg400, %arg401] : memref<1x12x1xf32>
          affine.for %arg402 = 0 to 128 {
            %2292 = memref.load %alloc_215[%arg402] : memref<128xf32>
            %2293 = arith.divf %2292, %2291#1 : f32
            memref.store %2293, %alloc_213[%arg399, %arg400, %arg401, %arg402] : memref<1x12x1x128xf32>
          }
        }
      }
    }
    %1531 = bufferization.to_tensor %alloc_213 restrict : memref<1x12x1x128xf32> to tensor<1x12x1x128xf32>
    %1532 = tosa.reshape %1531, %12 : (tensor<1x12x1x128xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1533 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1532, %arg266 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1534 = tosa.reshape %1533, %13 : (tensor<1x1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %1535 = tosa.add %1477, %1534 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %1536 = tensor.empty() : tensor<1x1x1536xf32>
    %1537 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1535 : tensor<1x1x1536xf32>) outs(%1536 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2290 = math.fpowi %in, %c2_i32 : f32, i32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1536xf32>
    %1538 = tosa.reduce_sum %1537 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %1539 = tosa.mul %1538, %0, %15 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1xf32>
    %1540 = tosa.add %1539, %14 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1541 = tosa.rsqrt %1540 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1542 = tosa.mul %1535, %1541, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %1543 = tosa.reshape %arg267, %13 : (tensor<1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %1544 = tosa.mul %1543, %1542, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %1545 = tosa.reshape %1544, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1546 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1545, %arg268 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_3 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %1547 = tosa.reshape %1546, %4 : (tensor<1x8960xf32>, !tosa.shape<3>) -> tensor<1x1x8960xf32>
    %1548 = tosa.sigmoid %1547 : (tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %1549 = tosa.mul %1547, %1548, %15 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>, tensor<1xi8>) -> tensor<1x1x8960xf32>
    %1550 = tosa.reshape %1544, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1551 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1550, %arg269 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_3 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %1552 = tosa.reshape %1551, %4 : (tensor<1x8960xf32>, !tosa.shape<3>) -> tensor<1x1x8960xf32>
    %1553 = tosa.mul %1549, %1552, %15 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>, tensor<1xi8>) -> tensor<1x1x8960xf32>
    %1554 = tosa.reshape %1553, %3 : (tensor<1x1x8960xf32>, !tosa.shape<2>) -> tensor<1x8960xf32>
    %1555 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1554, %arg270 : tensor<1x8960xf32>, tensor<8960x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1556 = tosa.reshape %1555, %13 : (tensor<1x1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %1557 = tosa.add %1535, %1556 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %1558 = tensor.empty() : tensor<1x1x1536xf32>
    %1559 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1557 : tensor<1x1x1536xf32>) outs(%1558 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2290 = math.fpowi %in, %c2_i32 : f32, i32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1536xf32>
    %1560 = tosa.reduce_sum %1559 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %1561 = tosa.mul %1560, %0, %15 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1xf32>
    %1562 = tosa.add %1561, %14 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1563 = tosa.rsqrt %1562 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1564 = tosa.mul %1557, %1563, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %1565 = tosa.reshape %arg271, %13 : (tensor<1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %1566 = tosa.mul %1565, %1564, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %1567 = tosa.reshape %1566, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1568 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1567, %arg273 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1569 = tosa.reshape %arg272, %12 : (tensor<1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1570 = tosa.add %1569, %1568 : (tensor<1x1536xf32>, tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1571 = tosa.reshape %1570, %11 : (tensor<1x1536xf32>, !tosa.shape<4>) -> tensor<1x12x1x128xf32>
    %1572 = tosa.reshape %1566, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1573 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1572, %arg275 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_8 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %1574 = tosa.reshape %arg274, %10 : (tensor<256xf32>, !tosa.shape<2>) -> tensor<1x256xf32>
    %1575 = tosa.add %1574, %1573 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %1576 = tosa.reshape %1575, %9 : (tensor<1x256xf32>, !tosa.shape<4>) -> tensor<1x2x1x128xf32>
    %1577 = tosa.reshape %1566, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1578 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1577, %arg277 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_8 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %1579 = tosa.reshape %arg276, %10 : (tensor<256xf32>, !tosa.shape<2>) -> tensor<1x256xf32>
    %1580 = tosa.add %1579, %1578 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %1581 = tosa.reshape %1580, %9 : (tensor<1x256xf32>, !tosa.shape<4>) -> tensor<1x2x1x128xf32>
    %1582 = tosa.reshape %36, %8 : (tensor<1x1x128xf32>, !tosa.shape<4>) -> tensor<1x1x1x128xf32>
    %1583 = tosa.reshape %37, %8 : (tensor<1x1x128xf32>, !tosa.shape<4>) -> tensor<1x1x1x128xf32>
    %1584 = tosa.mul %1571, %1582, %15 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x12x1x128xf32>
    %extracted_slice_216 = tensor.extract_slice %1571[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %extracted_slice_217 = tensor.extract_slice %1571[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %1585 = tosa.negate %extracted_slice_217, %19, %19 : (tensor<1x12x1x64xf32>, tensor<1xf32>, tensor<1xf32>) -> tensor<1x12x1x64xf32>
    %1586 = tensor.empty() : tensor<1x12x1x128xf32>
    %inserted_slice_218 = tensor.insert_slice %1585 into %1586[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %inserted_slice_219 = tensor.insert_slice %extracted_slice_216 into %inserted_slice_218[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %1587 = tosa.mul %inserted_slice_219, %1583, %15 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x12x1x128xf32>
    %1588 = tosa.add %1584, %1587 : (tensor<1x12x1x128xf32>, tensor<1x12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %1589 = tosa.mul %1576, %1582, %15 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x2x1x128xf32>
    %extracted_slice_220 = tensor.extract_slice %1576[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %extracted_slice_221 = tensor.extract_slice %1576[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %1590 = tosa.negate %extracted_slice_221, %19, %19 : (tensor<1x2x1x64xf32>, tensor<1xf32>, tensor<1xf32>) -> tensor<1x2x1x64xf32>
    %1591 = tensor.empty() : tensor<1x2x1x128xf32>
    %inserted_slice_222 = tensor.insert_slice %1590 into %1591[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %inserted_slice_223 = tensor.insert_slice %extracted_slice_220 into %inserted_slice_222[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %1592 = tosa.mul %inserted_slice_223, %1583, %15 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x2x1x128xf32>
    %1593 = tosa.add %1589, %1592 : (tensor<1x2x1x128xf32>, tensor<1x2x1x128xf32>) -> tensor<1x2x1x128xf32>
    %1594 = bufferization.to_buffer %arg278 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %1595 = tosa.reshape %arg3, %7 : (tensor<1xi64>, !tosa.shape<4>) -> tensor<1x1x1x1xi64>
    %1596 = tosa.add %1595, %6 : (tensor<1x1x1x1xi64>, tensor<1x2x1x128xi64>) -> tensor<1x2x1x128xi64>
    %1597 = bufferization.to_buffer %1596 : tensor<1x2x1x128xi64> to memref<1x2x1x128xi64>
    %1598 = bufferization.to_buffer %1593 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    scf.for %arg399 = %c0 to %c1 step %c1 {
      scf.for %arg400 = %c0 to %c2 step %c1 {
        scf.for %arg401 = %c0 to %c1 step %c1 {
          scf.for %arg402 = %c0 to %c128 step %c1 {
            %2290 = memref.load %1598[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            %2291 = memref.load %1597[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xi64>
            %2292 = arith.index_cast %2291 : i64 to index
            memref.store %2290, %1594[%arg399, %arg400, %2292, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %1599 = bufferization.to_tensor %1594 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %1600 = bufferization.to_buffer %arg279 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %1601 = tosa.reshape %arg3, %7 : (tensor<1xi64>, !tosa.shape<4>) -> tensor<1x1x1x1xi64>
    %1602 = tosa.add %1601, %6 : (tensor<1x1x1x1xi64>, tensor<1x2x1x128xi64>) -> tensor<1x2x1x128xi64>
    %1603 = bufferization.to_buffer %1602 : tensor<1x2x1x128xi64> to memref<1x2x1x128xi64>
    %1604 = bufferization.to_buffer %1581 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    scf.for %arg399 = %c0 to %c1 step %c1 {
      scf.for %arg400 = %c0 to %c2 step %c1 {
        scf.for %arg401 = %c0 to %c1 step %c1 {
          scf.for %arg402 = %c0 to %c128 step %c1 {
            %2290 = memref.load %1604[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            %2291 = memref.load %1603[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xi64>
            %2292 = arith.index_cast %2291 : i64 to index
            memref.store %2290, %1600[%arg399, %arg400, %2292, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %1605 = bufferization.to_tensor %1600 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %1606 = tosa.reshape %28, %5 : (tensor<1x1024xi1>, !tosa.shape<4>) -> tensor<1x1x1x1024xi1>
    %1607 = tensor.empty() : tensor<1x1x1x1024xf32>
    %1608 = linalg.generic {indexing_maps = [#map1, #map1, #map1, #map1], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1606, %cst_1, %cst_0 : tensor<1x1x1x1024xi1>, tensor<1x1x1x1024xf32>, tensor<1x1x1x1024xf32>) outs(%1607 : tensor<1x1x1x1024xf32>) {
    ^bb0(%in: i1, %in_315: f32, %in_316: f32, %out: f32):
      %2290 = arith.select %in, %in_315, %in_316 : f32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1x1024xf32>
    %1609 = bufferization.to_buffer %1588 : tensor<1x12x1x128xf32> to memref<1x12x1x128xf32>
    %1610 = bufferization.to_buffer %1608 : tensor<1x1x1x1024xf32> to memref<1x1x1x1024xf32>
    %alloc_224 = memref.alloc() : memref<1x12x1x128xf32>
    %alloc_225 = memref.alloc() : memref<1x12x1xf32>
    %alloc_226 = memref.alloc() : memref<128xf32>
    affine.for %arg399 = 0 to 1 {
      affine.for %arg400 = 0 to 12 {
        %2290 = arith.divsi %arg400, %c6 : index
        affine.for %arg401 = 0 to 1 {
          affine.for %arg402 = 0 to 128 {
            memref.store %cst_7, %alloc_226[%arg402] : memref<128xf32>
          }
          %2291:2 = affine.for %arg402 = 0 to 1024 iter_args(%arg403 = %cst_4, %arg404 = %cst_7) -> (f32, f32) {
            %2292 = affine.for %arg405 = 0 to 128 step 16 iter_args(%arg406 = %cst) -> (vector<16xf32>) {
              %2307 = vector.load %1609[%arg399, %arg400, %arg401, %arg405] : memref<1x12x1x128xf32>, vector<16xf32>
              %2308 = vector.load %1594[%arg399, %2290, %arg402, %arg405] : memref<1x2x1024x128xf32>, vector<16xf32>
              %2309 = vector.fma %2307, %2308, %arg406 : vector<16xf32>
              affine.yield %2309 : vector<16xf32>
            }
            %2293 = vector.reduction <add>, %2292 : vector<16xf32> into f32
            %2294 = arith.mulf %2293, %cst_5 : f32
            %2295 = memref.load %1610[%arg399, %c0, %arg401, %arg402] : memref<1x1x1x1024xf32>
            %2296 = arith.addf %2294, %2295 : f32
            %2297 = arith.cmpf ogt, %2296, %arg403 : f32
            %2298 = arith.select %2297, %2296, %arg403 : f32
            %2299 = arith.subf %arg403, %2296 : f32
            %2300 = math.exp %2299 : f32
            %2301 = arith.mulf %2300, %arg404 : f32
            %2302 = arith.addf %2301, %cst_6 : f32
            %2303 = arith.subf %2296, %arg403 : f32
            %2304 = math.exp %2303 : f32
            %2305 = arith.addf %arg404, %2304 : f32
            %2306 = arith.select %2297, %2302, %2305 : f32
            affine.for %arg405 = 0 to 128 {
              %2307 = memref.load %1600[%arg399, %2290, %arg402, %arg405] : memref<1x2x1024x128xf32>
              %2308 = memref.load %alloc_226[%arg405] : memref<128xf32>
              %2309 = arith.mulf %2308, %2300 : f32
              %2310 = arith.addf %2309, %2307 : f32
              %2311 = arith.mulf %2304, %2307 : f32
              %2312 = arith.addf %2311, %2308 : f32
              %2313 = arith.select %2297, %2310, %2312 : f32
              memref.store %2313, %alloc_226[%arg405] : memref<128xf32>
            }
            affine.yield %2298, %2306 : f32, f32
          }
          memref.store %2291#1, %alloc_225[%arg399, %arg400, %arg401] : memref<1x12x1xf32>
          affine.for %arg402 = 0 to 128 {
            %2292 = memref.load %alloc_226[%arg402] : memref<128xf32>
            %2293 = arith.divf %2292, %2291#1 : f32
            memref.store %2293, %alloc_224[%arg399, %arg400, %arg401, %arg402] : memref<1x12x1x128xf32>
          }
        }
      }
    }
    %1611 = bufferization.to_tensor %alloc_224 restrict : memref<1x12x1x128xf32> to tensor<1x12x1x128xf32>
    %1612 = tosa.reshape %1611, %12 : (tensor<1x12x1x128xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1613 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1612, %arg280 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1614 = tosa.reshape %1613, %13 : (tensor<1x1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %1615 = tosa.add %1557, %1614 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %1616 = tensor.empty() : tensor<1x1x1536xf32>
    %1617 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1615 : tensor<1x1x1536xf32>) outs(%1616 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2290 = math.fpowi %in, %c2_i32 : f32, i32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1536xf32>
    %1618 = tosa.reduce_sum %1617 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %1619 = tosa.mul %1618, %0, %15 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1xf32>
    %1620 = tosa.add %1619, %14 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1621 = tosa.rsqrt %1620 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1622 = tosa.mul %1615, %1621, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %1623 = tosa.reshape %arg281, %13 : (tensor<1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %1624 = tosa.mul %1623, %1622, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %1625 = tosa.reshape %1624, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1626 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1625, %arg282 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_3 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %1627 = tosa.reshape %1626, %4 : (tensor<1x8960xf32>, !tosa.shape<3>) -> tensor<1x1x8960xf32>
    %1628 = tosa.sigmoid %1627 : (tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %1629 = tosa.mul %1627, %1628, %15 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>, tensor<1xi8>) -> tensor<1x1x8960xf32>
    %1630 = tosa.reshape %1624, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1631 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1630, %arg283 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_3 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %1632 = tosa.reshape %1631, %4 : (tensor<1x8960xf32>, !tosa.shape<3>) -> tensor<1x1x8960xf32>
    %1633 = tosa.mul %1629, %1632, %15 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>, tensor<1xi8>) -> tensor<1x1x8960xf32>
    %1634 = tosa.reshape %1633, %3 : (tensor<1x1x8960xf32>, !tosa.shape<2>) -> tensor<1x8960xf32>
    %1635 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1634, %arg284 : tensor<1x8960xf32>, tensor<8960x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1636 = tosa.reshape %1635, %13 : (tensor<1x1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %1637 = tosa.add %1615, %1636 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %1638 = tensor.empty() : tensor<1x1x1536xf32>
    %1639 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1637 : tensor<1x1x1536xf32>) outs(%1638 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2290 = math.fpowi %in, %c2_i32 : f32, i32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1536xf32>
    %1640 = tosa.reduce_sum %1639 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %1641 = tosa.mul %1640, %0, %15 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1xf32>
    %1642 = tosa.add %1641, %14 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1643 = tosa.rsqrt %1642 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1644 = tosa.mul %1637, %1643, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %1645 = tosa.reshape %arg285, %13 : (tensor<1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %1646 = tosa.mul %1645, %1644, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %1647 = tosa.reshape %1646, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1648 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1647, %arg287 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1649 = tosa.reshape %arg286, %12 : (tensor<1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1650 = tosa.add %1649, %1648 : (tensor<1x1536xf32>, tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1651 = tosa.reshape %1650, %11 : (tensor<1x1536xf32>, !tosa.shape<4>) -> tensor<1x12x1x128xf32>
    %1652 = tosa.reshape %1646, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1653 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1652, %arg289 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_8 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %1654 = tosa.reshape %arg288, %10 : (tensor<256xf32>, !tosa.shape<2>) -> tensor<1x256xf32>
    %1655 = tosa.add %1654, %1653 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %1656 = tosa.reshape %1655, %9 : (tensor<1x256xf32>, !tosa.shape<4>) -> tensor<1x2x1x128xf32>
    %1657 = tosa.reshape %1646, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1658 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1657, %arg291 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_8 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %1659 = tosa.reshape %arg290, %10 : (tensor<256xf32>, !tosa.shape<2>) -> tensor<1x256xf32>
    %1660 = tosa.add %1659, %1658 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %1661 = tosa.reshape %1660, %9 : (tensor<1x256xf32>, !tosa.shape<4>) -> tensor<1x2x1x128xf32>
    %1662 = tosa.reshape %36, %8 : (tensor<1x1x128xf32>, !tosa.shape<4>) -> tensor<1x1x1x128xf32>
    %1663 = tosa.reshape %37, %8 : (tensor<1x1x128xf32>, !tosa.shape<4>) -> tensor<1x1x1x128xf32>
    %1664 = tosa.mul %1651, %1662, %15 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x12x1x128xf32>
    %extracted_slice_227 = tensor.extract_slice %1651[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %extracted_slice_228 = tensor.extract_slice %1651[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %1665 = tosa.negate %extracted_slice_228, %19, %19 : (tensor<1x12x1x64xf32>, tensor<1xf32>, tensor<1xf32>) -> tensor<1x12x1x64xf32>
    %1666 = tensor.empty() : tensor<1x12x1x128xf32>
    %inserted_slice_229 = tensor.insert_slice %1665 into %1666[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %inserted_slice_230 = tensor.insert_slice %extracted_slice_227 into %inserted_slice_229[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %1667 = tosa.mul %inserted_slice_230, %1663, %15 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x12x1x128xf32>
    %1668 = tosa.add %1664, %1667 : (tensor<1x12x1x128xf32>, tensor<1x12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %1669 = tosa.mul %1656, %1662, %15 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x2x1x128xf32>
    %extracted_slice_231 = tensor.extract_slice %1656[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %extracted_slice_232 = tensor.extract_slice %1656[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %1670 = tosa.negate %extracted_slice_232, %19, %19 : (tensor<1x2x1x64xf32>, tensor<1xf32>, tensor<1xf32>) -> tensor<1x2x1x64xf32>
    %1671 = tensor.empty() : tensor<1x2x1x128xf32>
    %inserted_slice_233 = tensor.insert_slice %1670 into %1671[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %inserted_slice_234 = tensor.insert_slice %extracted_slice_231 into %inserted_slice_233[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %1672 = tosa.mul %inserted_slice_234, %1663, %15 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x2x1x128xf32>
    %1673 = tosa.add %1669, %1672 : (tensor<1x2x1x128xf32>, tensor<1x2x1x128xf32>) -> tensor<1x2x1x128xf32>
    %1674 = bufferization.to_buffer %arg292 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %1675 = tosa.reshape %arg3, %7 : (tensor<1xi64>, !tosa.shape<4>) -> tensor<1x1x1x1xi64>
    %1676 = tosa.add %1675, %6 : (tensor<1x1x1x1xi64>, tensor<1x2x1x128xi64>) -> tensor<1x2x1x128xi64>
    %1677 = bufferization.to_buffer %1676 : tensor<1x2x1x128xi64> to memref<1x2x1x128xi64>
    %1678 = bufferization.to_buffer %1673 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    scf.for %arg399 = %c0 to %c1 step %c1 {
      scf.for %arg400 = %c0 to %c2 step %c1 {
        scf.for %arg401 = %c0 to %c1 step %c1 {
          scf.for %arg402 = %c0 to %c128 step %c1 {
            %2290 = memref.load %1678[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            %2291 = memref.load %1677[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xi64>
            %2292 = arith.index_cast %2291 : i64 to index
            memref.store %2290, %1674[%arg399, %arg400, %2292, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %1679 = bufferization.to_tensor %1674 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %1680 = bufferization.to_buffer %arg293 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %1681 = tosa.reshape %arg3, %7 : (tensor<1xi64>, !tosa.shape<4>) -> tensor<1x1x1x1xi64>
    %1682 = tosa.add %1681, %6 : (tensor<1x1x1x1xi64>, tensor<1x2x1x128xi64>) -> tensor<1x2x1x128xi64>
    %1683 = bufferization.to_buffer %1682 : tensor<1x2x1x128xi64> to memref<1x2x1x128xi64>
    %1684 = bufferization.to_buffer %1661 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    scf.for %arg399 = %c0 to %c1 step %c1 {
      scf.for %arg400 = %c0 to %c2 step %c1 {
        scf.for %arg401 = %c0 to %c1 step %c1 {
          scf.for %arg402 = %c0 to %c128 step %c1 {
            %2290 = memref.load %1684[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            %2291 = memref.load %1683[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xi64>
            %2292 = arith.index_cast %2291 : i64 to index
            memref.store %2290, %1680[%arg399, %arg400, %2292, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %1685 = bufferization.to_tensor %1680 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %1686 = tosa.reshape %28, %5 : (tensor<1x1024xi1>, !tosa.shape<4>) -> tensor<1x1x1x1024xi1>
    %1687 = tensor.empty() : tensor<1x1x1x1024xf32>
    %1688 = linalg.generic {indexing_maps = [#map1, #map1, #map1, #map1], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1686, %cst_1, %cst_0 : tensor<1x1x1x1024xi1>, tensor<1x1x1x1024xf32>, tensor<1x1x1x1024xf32>) outs(%1687 : tensor<1x1x1x1024xf32>) {
    ^bb0(%in: i1, %in_315: f32, %in_316: f32, %out: f32):
      %2290 = arith.select %in, %in_315, %in_316 : f32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1x1024xf32>
    %1689 = bufferization.to_buffer %1668 : tensor<1x12x1x128xf32> to memref<1x12x1x128xf32>
    %1690 = bufferization.to_buffer %1688 : tensor<1x1x1x1024xf32> to memref<1x1x1x1024xf32>
    %alloc_235 = memref.alloc() : memref<1x12x1x128xf32>
    %alloc_236 = memref.alloc() : memref<1x12x1xf32>
    %alloc_237 = memref.alloc() : memref<128xf32>
    affine.for %arg399 = 0 to 1 {
      affine.for %arg400 = 0 to 12 {
        %2290 = arith.divsi %arg400, %c6 : index
        affine.for %arg401 = 0 to 1 {
          affine.for %arg402 = 0 to 128 {
            memref.store %cst_7, %alloc_237[%arg402] : memref<128xf32>
          }
          %2291:2 = affine.for %arg402 = 0 to 1024 iter_args(%arg403 = %cst_4, %arg404 = %cst_7) -> (f32, f32) {
            %2292 = affine.for %arg405 = 0 to 128 step 16 iter_args(%arg406 = %cst) -> (vector<16xf32>) {
              %2307 = vector.load %1689[%arg399, %arg400, %arg401, %arg405] : memref<1x12x1x128xf32>, vector<16xf32>
              %2308 = vector.load %1674[%arg399, %2290, %arg402, %arg405] : memref<1x2x1024x128xf32>, vector<16xf32>
              %2309 = vector.fma %2307, %2308, %arg406 : vector<16xf32>
              affine.yield %2309 : vector<16xf32>
            }
            %2293 = vector.reduction <add>, %2292 : vector<16xf32> into f32
            %2294 = arith.mulf %2293, %cst_5 : f32
            %2295 = memref.load %1690[%arg399, %c0, %arg401, %arg402] : memref<1x1x1x1024xf32>
            %2296 = arith.addf %2294, %2295 : f32
            %2297 = arith.cmpf ogt, %2296, %arg403 : f32
            %2298 = arith.select %2297, %2296, %arg403 : f32
            %2299 = arith.subf %arg403, %2296 : f32
            %2300 = math.exp %2299 : f32
            %2301 = arith.mulf %2300, %arg404 : f32
            %2302 = arith.addf %2301, %cst_6 : f32
            %2303 = arith.subf %2296, %arg403 : f32
            %2304 = math.exp %2303 : f32
            %2305 = arith.addf %arg404, %2304 : f32
            %2306 = arith.select %2297, %2302, %2305 : f32
            affine.for %arg405 = 0 to 128 {
              %2307 = memref.load %1680[%arg399, %2290, %arg402, %arg405] : memref<1x2x1024x128xf32>
              %2308 = memref.load %alloc_237[%arg405] : memref<128xf32>
              %2309 = arith.mulf %2308, %2300 : f32
              %2310 = arith.addf %2309, %2307 : f32
              %2311 = arith.mulf %2304, %2307 : f32
              %2312 = arith.addf %2311, %2308 : f32
              %2313 = arith.select %2297, %2310, %2312 : f32
              memref.store %2313, %alloc_237[%arg405] : memref<128xf32>
            }
            affine.yield %2298, %2306 : f32, f32
          }
          memref.store %2291#1, %alloc_236[%arg399, %arg400, %arg401] : memref<1x12x1xf32>
          affine.for %arg402 = 0 to 128 {
            %2292 = memref.load %alloc_237[%arg402] : memref<128xf32>
            %2293 = arith.divf %2292, %2291#1 : f32
            memref.store %2293, %alloc_235[%arg399, %arg400, %arg401, %arg402] : memref<1x12x1x128xf32>
          }
        }
      }
    }
    %1691 = bufferization.to_tensor %alloc_235 restrict : memref<1x12x1x128xf32> to tensor<1x12x1x128xf32>
    %1692 = tosa.reshape %1691, %12 : (tensor<1x12x1x128xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1693 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1692, %arg294 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1694 = tosa.reshape %1693, %13 : (tensor<1x1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %1695 = tosa.add %1637, %1694 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %1696 = tensor.empty() : tensor<1x1x1536xf32>
    %1697 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1695 : tensor<1x1x1536xf32>) outs(%1696 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2290 = math.fpowi %in, %c2_i32 : f32, i32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1536xf32>
    %1698 = tosa.reduce_sum %1697 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %1699 = tosa.mul %1698, %0, %15 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1xf32>
    %1700 = tosa.add %1699, %14 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1701 = tosa.rsqrt %1700 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1702 = tosa.mul %1695, %1701, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %1703 = tosa.reshape %arg295, %13 : (tensor<1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %1704 = tosa.mul %1703, %1702, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %1705 = tosa.reshape %1704, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1706 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1705, %arg296 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_3 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %1707 = tosa.reshape %1706, %4 : (tensor<1x8960xf32>, !tosa.shape<3>) -> tensor<1x1x8960xf32>
    %1708 = tosa.sigmoid %1707 : (tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %1709 = tosa.mul %1707, %1708, %15 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>, tensor<1xi8>) -> tensor<1x1x8960xf32>
    %1710 = tosa.reshape %1704, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1711 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1710, %arg297 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_3 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %1712 = tosa.reshape %1711, %4 : (tensor<1x8960xf32>, !tosa.shape<3>) -> tensor<1x1x8960xf32>
    %1713 = tosa.mul %1709, %1712, %15 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>, tensor<1xi8>) -> tensor<1x1x8960xf32>
    %1714 = tosa.reshape %1713, %3 : (tensor<1x1x8960xf32>, !tosa.shape<2>) -> tensor<1x8960xf32>
    %1715 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1714, %arg298 : tensor<1x8960xf32>, tensor<8960x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1716 = tosa.reshape %1715, %13 : (tensor<1x1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %1717 = tosa.add %1695, %1716 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %1718 = tensor.empty() : tensor<1x1x1536xf32>
    %1719 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1717 : tensor<1x1x1536xf32>) outs(%1718 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2290 = math.fpowi %in, %c2_i32 : f32, i32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1536xf32>
    %1720 = tosa.reduce_sum %1719 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %1721 = tosa.mul %1720, %0, %15 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1xf32>
    %1722 = tosa.add %1721, %14 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1723 = tosa.rsqrt %1722 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1724 = tosa.mul %1717, %1723, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %1725 = tosa.reshape %arg299, %13 : (tensor<1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %1726 = tosa.mul %1725, %1724, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %1727 = tosa.reshape %1726, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1728 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1727, %arg301 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1729 = tosa.reshape %arg300, %12 : (tensor<1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1730 = tosa.add %1729, %1728 : (tensor<1x1536xf32>, tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1731 = tosa.reshape %1730, %11 : (tensor<1x1536xf32>, !tosa.shape<4>) -> tensor<1x12x1x128xf32>
    %1732 = tosa.reshape %1726, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1733 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1732, %arg303 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_8 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %1734 = tosa.reshape %arg302, %10 : (tensor<256xf32>, !tosa.shape<2>) -> tensor<1x256xf32>
    %1735 = tosa.add %1734, %1733 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %1736 = tosa.reshape %1735, %9 : (tensor<1x256xf32>, !tosa.shape<4>) -> tensor<1x2x1x128xf32>
    %1737 = tosa.reshape %1726, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1738 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1737, %arg305 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_8 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %1739 = tosa.reshape %arg304, %10 : (tensor<256xf32>, !tosa.shape<2>) -> tensor<1x256xf32>
    %1740 = tosa.add %1739, %1738 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %1741 = tosa.reshape %1740, %9 : (tensor<1x256xf32>, !tosa.shape<4>) -> tensor<1x2x1x128xf32>
    %1742 = tosa.reshape %36, %8 : (tensor<1x1x128xf32>, !tosa.shape<4>) -> tensor<1x1x1x128xf32>
    %1743 = tosa.reshape %37, %8 : (tensor<1x1x128xf32>, !tosa.shape<4>) -> tensor<1x1x1x128xf32>
    %1744 = tosa.mul %1731, %1742, %15 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x12x1x128xf32>
    %extracted_slice_238 = tensor.extract_slice %1731[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %extracted_slice_239 = tensor.extract_slice %1731[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %1745 = tosa.negate %extracted_slice_239, %19, %19 : (tensor<1x12x1x64xf32>, tensor<1xf32>, tensor<1xf32>) -> tensor<1x12x1x64xf32>
    %1746 = tensor.empty() : tensor<1x12x1x128xf32>
    %inserted_slice_240 = tensor.insert_slice %1745 into %1746[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %inserted_slice_241 = tensor.insert_slice %extracted_slice_238 into %inserted_slice_240[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %1747 = tosa.mul %inserted_slice_241, %1743, %15 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x12x1x128xf32>
    %1748 = tosa.add %1744, %1747 : (tensor<1x12x1x128xf32>, tensor<1x12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %1749 = tosa.mul %1736, %1742, %15 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x2x1x128xf32>
    %extracted_slice_242 = tensor.extract_slice %1736[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %extracted_slice_243 = tensor.extract_slice %1736[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %1750 = tosa.negate %extracted_slice_243, %19, %19 : (tensor<1x2x1x64xf32>, tensor<1xf32>, tensor<1xf32>) -> tensor<1x2x1x64xf32>
    %1751 = tensor.empty() : tensor<1x2x1x128xf32>
    %inserted_slice_244 = tensor.insert_slice %1750 into %1751[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %inserted_slice_245 = tensor.insert_slice %extracted_slice_242 into %inserted_slice_244[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %1752 = tosa.mul %inserted_slice_245, %1743, %15 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x2x1x128xf32>
    %1753 = tosa.add %1749, %1752 : (tensor<1x2x1x128xf32>, tensor<1x2x1x128xf32>) -> tensor<1x2x1x128xf32>
    %1754 = bufferization.to_buffer %arg306 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %1755 = tosa.reshape %arg3, %7 : (tensor<1xi64>, !tosa.shape<4>) -> tensor<1x1x1x1xi64>
    %1756 = tosa.add %1755, %6 : (tensor<1x1x1x1xi64>, tensor<1x2x1x128xi64>) -> tensor<1x2x1x128xi64>
    %1757 = bufferization.to_buffer %1756 : tensor<1x2x1x128xi64> to memref<1x2x1x128xi64>
    %1758 = bufferization.to_buffer %1753 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    scf.for %arg399 = %c0 to %c1 step %c1 {
      scf.for %arg400 = %c0 to %c2 step %c1 {
        scf.for %arg401 = %c0 to %c1 step %c1 {
          scf.for %arg402 = %c0 to %c128 step %c1 {
            %2290 = memref.load %1758[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            %2291 = memref.load %1757[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xi64>
            %2292 = arith.index_cast %2291 : i64 to index
            memref.store %2290, %1754[%arg399, %arg400, %2292, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %1759 = bufferization.to_tensor %1754 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %1760 = bufferization.to_buffer %arg307 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %1761 = tosa.reshape %arg3, %7 : (tensor<1xi64>, !tosa.shape<4>) -> tensor<1x1x1x1xi64>
    %1762 = tosa.add %1761, %6 : (tensor<1x1x1x1xi64>, tensor<1x2x1x128xi64>) -> tensor<1x2x1x128xi64>
    %1763 = bufferization.to_buffer %1762 : tensor<1x2x1x128xi64> to memref<1x2x1x128xi64>
    %1764 = bufferization.to_buffer %1741 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    scf.for %arg399 = %c0 to %c1 step %c1 {
      scf.for %arg400 = %c0 to %c2 step %c1 {
        scf.for %arg401 = %c0 to %c1 step %c1 {
          scf.for %arg402 = %c0 to %c128 step %c1 {
            %2290 = memref.load %1764[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            %2291 = memref.load %1763[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xi64>
            %2292 = arith.index_cast %2291 : i64 to index
            memref.store %2290, %1760[%arg399, %arg400, %2292, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %1765 = bufferization.to_tensor %1760 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %1766 = tosa.reshape %28, %5 : (tensor<1x1024xi1>, !tosa.shape<4>) -> tensor<1x1x1x1024xi1>
    %1767 = tensor.empty() : tensor<1x1x1x1024xf32>
    %1768 = linalg.generic {indexing_maps = [#map1, #map1, #map1, #map1], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1766, %cst_1, %cst_0 : tensor<1x1x1x1024xi1>, tensor<1x1x1x1024xf32>, tensor<1x1x1x1024xf32>) outs(%1767 : tensor<1x1x1x1024xf32>) {
    ^bb0(%in: i1, %in_315: f32, %in_316: f32, %out: f32):
      %2290 = arith.select %in, %in_315, %in_316 : f32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1x1024xf32>
    %1769 = bufferization.to_buffer %1748 : tensor<1x12x1x128xf32> to memref<1x12x1x128xf32>
    %1770 = bufferization.to_buffer %1768 : tensor<1x1x1x1024xf32> to memref<1x1x1x1024xf32>
    %alloc_246 = memref.alloc() : memref<1x12x1x128xf32>
    %alloc_247 = memref.alloc() : memref<1x12x1xf32>
    %alloc_248 = memref.alloc() : memref<128xf32>
    affine.for %arg399 = 0 to 1 {
      affine.for %arg400 = 0 to 12 {
        %2290 = arith.divsi %arg400, %c6 : index
        affine.for %arg401 = 0 to 1 {
          affine.for %arg402 = 0 to 128 {
            memref.store %cst_7, %alloc_248[%arg402] : memref<128xf32>
          }
          %2291:2 = affine.for %arg402 = 0 to 1024 iter_args(%arg403 = %cst_4, %arg404 = %cst_7) -> (f32, f32) {
            %2292 = affine.for %arg405 = 0 to 128 step 16 iter_args(%arg406 = %cst) -> (vector<16xf32>) {
              %2307 = vector.load %1769[%arg399, %arg400, %arg401, %arg405] : memref<1x12x1x128xf32>, vector<16xf32>
              %2308 = vector.load %1754[%arg399, %2290, %arg402, %arg405] : memref<1x2x1024x128xf32>, vector<16xf32>
              %2309 = vector.fma %2307, %2308, %arg406 : vector<16xf32>
              affine.yield %2309 : vector<16xf32>
            }
            %2293 = vector.reduction <add>, %2292 : vector<16xf32> into f32
            %2294 = arith.mulf %2293, %cst_5 : f32
            %2295 = memref.load %1770[%arg399, %c0, %arg401, %arg402] : memref<1x1x1x1024xf32>
            %2296 = arith.addf %2294, %2295 : f32
            %2297 = arith.cmpf ogt, %2296, %arg403 : f32
            %2298 = arith.select %2297, %2296, %arg403 : f32
            %2299 = arith.subf %arg403, %2296 : f32
            %2300 = math.exp %2299 : f32
            %2301 = arith.mulf %2300, %arg404 : f32
            %2302 = arith.addf %2301, %cst_6 : f32
            %2303 = arith.subf %2296, %arg403 : f32
            %2304 = math.exp %2303 : f32
            %2305 = arith.addf %arg404, %2304 : f32
            %2306 = arith.select %2297, %2302, %2305 : f32
            affine.for %arg405 = 0 to 128 {
              %2307 = memref.load %1760[%arg399, %2290, %arg402, %arg405] : memref<1x2x1024x128xf32>
              %2308 = memref.load %alloc_248[%arg405] : memref<128xf32>
              %2309 = arith.mulf %2308, %2300 : f32
              %2310 = arith.addf %2309, %2307 : f32
              %2311 = arith.mulf %2304, %2307 : f32
              %2312 = arith.addf %2311, %2308 : f32
              %2313 = arith.select %2297, %2310, %2312 : f32
              memref.store %2313, %alloc_248[%arg405] : memref<128xf32>
            }
            affine.yield %2298, %2306 : f32, f32
          }
          memref.store %2291#1, %alloc_247[%arg399, %arg400, %arg401] : memref<1x12x1xf32>
          affine.for %arg402 = 0 to 128 {
            %2292 = memref.load %alloc_248[%arg402] : memref<128xf32>
            %2293 = arith.divf %2292, %2291#1 : f32
            memref.store %2293, %alloc_246[%arg399, %arg400, %arg401, %arg402] : memref<1x12x1x128xf32>
          }
        }
      }
    }
    %1771 = bufferization.to_tensor %alloc_246 restrict : memref<1x12x1x128xf32> to tensor<1x12x1x128xf32>
    %1772 = tosa.reshape %1771, %12 : (tensor<1x12x1x128xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1773 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1772, %arg308 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1774 = tosa.reshape %1773, %13 : (tensor<1x1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %1775 = tosa.add %1717, %1774 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %1776 = tensor.empty() : tensor<1x1x1536xf32>
    %1777 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1775 : tensor<1x1x1536xf32>) outs(%1776 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2290 = math.fpowi %in, %c2_i32 : f32, i32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1536xf32>
    %1778 = tosa.reduce_sum %1777 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %1779 = tosa.mul %1778, %0, %15 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1xf32>
    %1780 = tosa.add %1779, %14 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1781 = tosa.rsqrt %1780 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1782 = tosa.mul %1775, %1781, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %1783 = tosa.reshape %arg309, %13 : (tensor<1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %1784 = tosa.mul %1783, %1782, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %1785 = tosa.reshape %1784, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1786 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1785, %arg310 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_3 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %1787 = tosa.reshape %1786, %4 : (tensor<1x8960xf32>, !tosa.shape<3>) -> tensor<1x1x8960xf32>
    %1788 = tosa.sigmoid %1787 : (tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %1789 = tosa.mul %1787, %1788, %15 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>, tensor<1xi8>) -> tensor<1x1x8960xf32>
    %1790 = tosa.reshape %1784, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1791 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1790, %arg311 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_3 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %1792 = tosa.reshape %1791, %4 : (tensor<1x8960xf32>, !tosa.shape<3>) -> tensor<1x1x8960xf32>
    %1793 = tosa.mul %1789, %1792, %15 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>, tensor<1xi8>) -> tensor<1x1x8960xf32>
    %1794 = tosa.reshape %1793, %3 : (tensor<1x1x8960xf32>, !tosa.shape<2>) -> tensor<1x8960xf32>
    %1795 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1794, %arg312 : tensor<1x8960xf32>, tensor<8960x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1796 = tosa.reshape %1795, %13 : (tensor<1x1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %1797 = tosa.add %1775, %1796 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %1798 = tensor.empty() : tensor<1x1x1536xf32>
    %1799 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1797 : tensor<1x1x1536xf32>) outs(%1798 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2290 = math.fpowi %in, %c2_i32 : f32, i32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1536xf32>
    %1800 = tosa.reduce_sum %1799 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %1801 = tosa.mul %1800, %0, %15 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1xf32>
    %1802 = tosa.add %1801, %14 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1803 = tosa.rsqrt %1802 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1804 = tosa.mul %1797, %1803, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %1805 = tosa.reshape %arg313, %13 : (tensor<1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %1806 = tosa.mul %1805, %1804, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %1807 = tosa.reshape %1806, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1808 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1807, %arg315 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1809 = tosa.reshape %arg314, %12 : (tensor<1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1810 = tosa.add %1809, %1808 : (tensor<1x1536xf32>, tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1811 = tosa.reshape %1810, %11 : (tensor<1x1536xf32>, !tosa.shape<4>) -> tensor<1x12x1x128xf32>
    %1812 = tosa.reshape %1806, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1813 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1812, %arg317 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_8 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %1814 = tosa.reshape %arg316, %10 : (tensor<256xf32>, !tosa.shape<2>) -> tensor<1x256xf32>
    %1815 = tosa.add %1814, %1813 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %1816 = tosa.reshape %1815, %9 : (tensor<1x256xf32>, !tosa.shape<4>) -> tensor<1x2x1x128xf32>
    %1817 = tosa.reshape %1806, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1818 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1817, %arg319 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_8 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %1819 = tosa.reshape %arg318, %10 : (tensor<256xf32>, !tosa.shape<2>) -> tensor<1x256xf32>
    %1820 = tosa.add %1819, %1818 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %1821 = tosa.reshape %1820, %9 : (tensor<1x256xf32>, !tosa.shape<4>) -> tensor<1x2x1x128xf32>
    %1822 = tosa.reshape %36, %8 : (tensor<1x1x128xf32>, !tosa.shape<4>) -> tensor<1x1x1x128xf32>
    %1823 = tosa.reshape %37, %8 : (tensor<1x1x128xf32>, !tosa.shape<4>) -> tensor<1x1x1x128xf32>
    %1824 = tosa.mul %1811, %1822, %15 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x12x1x128xf32>
    %extracted_slice_249 = tensor.extract_slice %1811[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %extracted_slice_250 = tensor.extract_slice %1811[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %1825 = tosa.negate %extracted_slice_250, %19, %19 : (tensor<1x12x1x64xf32>, tensor<1xf32>, tensor<1xf32>) -> tensor<1x12x1x64xf32>
    %1826 = tensor.empty() : tensor<1x12x1x128xf32>
    %inserted_slice_251 = tensor.insert_slice %1825 into %1826[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %inserted_slice_252 = tensor.insert_slice %extracted_slice_249 into %inserted_slice_251[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %1827 = tosa.mul %inserted_slice_252, %1823, %15 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x12x1x128xf32>
    %1828 = tosa.add %1824, %1827 : (tensor<1x12x1x128xf32>, tensor<1x12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %1829 = tosa.mul %1816, %1822, %15 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x2x1x128xf32>
    %extracted_slice_253 = tensor.extract_slice %1816[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %extracted_slice_254 = tensor.extract_slice %1816[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %1830 = tosa.negate %extracted_slice_254, %19, %19 : (tensor<1x2x1x64xf32>, tensor<1xf32>, tensor<1xf32>) -> tensor<1x2x1x64xf32>
    %1831 = tensor.empty() : tensor<1x2x1x128xf32>
    %inserted_slice_255 = tensor.insert_slice %1830 into %1831[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %inserted_slice_256 = tensor.insert_slice %extracted_slice_253 into %inserted_slice_255[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %1832 = tosa.mul %inserted_slice_256, %1823, %15 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x2x1x128xf32>
    %1833 = tosa.add %1829, %1832 : (tensor<1x2x1x128xf32>, tensor<1x2x1x128xf32>) -> tensor<1x2x1x128xf32>
    %1834 = bufferization.to_buffer %arg320 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %1835 = tosa.reshape %arg3, %7 : (tensor<1xi64>, !tosa.shape<4>) -> tensor<1x1x1x1xi64>
    %1836 = tosa.add %1835, %6 : (tensor<1x1x1x1xi64>, tensor<1x2x1x128xi64>) -> tensor<1x2x1x128xi64>
    %1837 = bufferization.to_buffer %1836 : tensor<1x2x1x128xi64> to memref<1x2x1x128xi64>
    %1838 = bufferization.to_buffer %1833 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    scf.for %arg399 = %c0 to %c1 step %c1 {
      scf.for %arg400 = %c0 to %c2 step %c1 {
        scf.for %arg401 = %c0 to %c1 step %c1 {
          scf.for %arg402 = %c0 to %c128 step %c1 {
            %2290 = memref.load %1838[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            %2291 = memref.load %1837[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xi64>
            %2292 = arith.index_cast %2291 : i64 to index
            memref.store %2290, %1834[%arg399, %arg400, %2292, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %1839 = bufferization.to_tensor %1834 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %1840 = bufferization.to_buffer %arg321 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %1841 = tosa.reshape %arg3, %7 : (tensor<1xi64>, !tosa.shape<4>) -> tensor<1x1x1x1xi64>
    %1842 = tosa.add %1841, %6 : (tensor<1x1x1x1xi64>, tensor<1x2x1x128xi64>) -> tensor<1x2x1x128xi64>
    %1843 = bufferization.to_buffer %1842 : tensor<1x2x1x128xi64> to memref<1x2x1x128xi64>
    %1844 = bufferization.to_buffer %1821 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    scf.for %arg399 = %c0 to %c1 step %c1 {
      scf.for %arg400 = %c0 to %c2 step %c1 {
        scf.for %arg401 = %c0 to %c1 step %c1 {
          scf.for %arg402 = %c0 to %c128 step %c1 {
            %2290 = memref.load %1844[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            %2291 = memref.load %1843[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xi64>
            %2292 = arith.index_cast %2291 : i64 to index
            memref.store %2290, %1840[%arg399, %arg400, %2292, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %1845 = bufferization.to_tensor %1840 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %1846 = tosa.reshape %28, %5 : (tensor<1x1024xi1>, !tosa.shape<4>) -> tensor<1x1x1x1024xi1>
    %1847 = tensor.empty() : tensor<1x1x1x1024xf32>
    %1848 = linalg.generic {indexing_maps = [#map1, #map1, #map1, #map1], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1846, %cst_1, %cst_0 : tensor<1x1x1x1024xi1>, tensor<1x1x1x1024xf32>, tensor<1x1x1x1024xf32>) outs(%1847 : tensor<1x1x1x1024xf32>) {
    ^bb0(%in: i1, %in_315: f32, %in_316: f32, %out: f32):
      %2290 = arith.select %in, %in_315, %in_316 : f32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1x1024xf32>
    %1849 = bufferization.to_buffer %1828 : tensor<1x12x1x128xf32> to memref<1x12x1x128xf32>
    %1850 = bufferization.to_buffer %1848 : tensor<1x1x1x1024xf32> to memref<1x1x1x1024xf32>
    %alloc_257 = memref.alloc() : memref<1x12x1x128xf32>
    %alloc_258 = memref.alloc() : memref<1x12x1xf32>
    %alloc_259 = memref.alloc() : memref<128xf32>
    affine.for %arg399 = 0 to 1 {
      affine.for %arg400 = 0 to 12 {
        %2290 = arith.divsi %arg400, %c6 : index
        affine.for %arg401 = 0 to 1 {
          affine.for %arg402 = 0 to 128 {
            memref.store %cst_7, %alloc_259[%arg402] : memref<128xf32>
          }
          %2291:2 = affine.for %arg402 = 0 to 1024 iter_args(%arg403 = %cst_4, %arg404 = %cst_7) -> (f32, f32) {
            %2292 = affine.for %arg405 = 0 to 128 step 16 iter_args(%arg406 = %cst) -> (vector<16xf32>) {
              %2307 = vector.load %1849[%arg399, %arg400, %arg401, %arg405] : memref<1x12x1x128xf32>, vector<16xf32>
              %2308 = vector.load %1834[%arg399, %2290, %arg402, %arg405] : memref<1x2x1024x128xf32>, vector<16xf32>
              %2309 = vector.fma %2307, %2308, %arg406 : vector<16xf32>
              affine.yield %2309 : vector<16xf32>
            }
            %2293 = vector.reduction <add>, %2292 : vector<16xf32> into f32
            %2294 = arith.mulf %2293, %cst_5 : f32
            %2295 = memref.load %1850[%arg399, %c0, %arg401, %arg402] : memref<1x1x1x1024xf32>
            %2296 = arith.addf %2294, %2295 : f32
            %2297 = arith.cmpf ogt, %2296, %arg403 : f32
            %2298 = arith.select %2297, %2296, %arg403 : f32
            %2299 = arith.subf %arg403, %2296 : f32
            %2300 = math.exp %2299 : f32
            %2301 = arith.mulf %2300, %arg404 : f32
            %2302 = arith.addf %2301, %cst_6 : f32
            %2303 = arith.subf %2296, %arg403 : f32
            %2304 = math.exp %2303 : f32
            %2305 = arith.addf %arg404, %2304 : f32
            %2306 = arith.select %2297, %2302, %2305 : f32
            affine.for %arg405 = 0 to 128 {
              %2307 = memref.load %1840[%arg399, %2290, %arg402, %arg405] : memref<1x2x1024x128xf32>
              %2308 = memref.load %alloc_259[%arg405] : memref<128xf32>
              %2309 = arith.mulf %2308, %2300 : f32
              %2310 = arith.addf %2309, %2307 : f32
              %2311 = arith.mulf %2304, %2307 : f32
              %2312 = arith.addf %2311, %2308 : f32
              %2313 = arith.select %2297, %2310, %2312 : f32
              memref.store %2313, %alloc_259[%arg405] : memref<128xf32>
            }
            affine.yield %2298, %2306 : f32, f32
          }
          memref.store %2291#1, %alloc_258[%arg399, %arg400, %arg401] : memref<1x12x1xf32>
          affine.for %arg402 = 0 to 128 {
            %2292 = memref.load %alloc_259[%arg402] : memref<128xf32>
            %2293 = arith.divf %2292, %2291#1 : f32
            memref.store %2293, %alloc_257[%arg399, %arg400, %arg401, %arg402] : memref<1x12x1x128xf32>
          }
        }
      }
    }
    %1851 = bufferization.to_tensor %alloc_257 restrict : memref<1x12x1x128xf32> to tensor<1x12x1x128xf32>
    %1852 = tosa.reshape %1851, %12 : (tensor<1x12x1x128xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1853 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1852, %arg322 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1854 = tosa.reshape %1853, %13 : (tensor<1x1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %1855 = tosa.add %1797, %1854 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %1856 = tensor.empty() : tensor<1x1x1536xf32>
    %1857 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1855 : tensor<1x1x1536xf32>) outs(%1856 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2290 = math.fpowi %in, %c2_i32 : f32, i32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1536xf32>
    %1858 = tosa.reduce_sum %1857 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %1859 = tosa.mul %1858, %0, %15 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1xf32>
    %1860 = tosa.add %1859, %14 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1861 = tosa.rsqrt %1860 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1862 = tosa.mul %1855, %1861, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %1863 = tosa.reshape %arg323, %13 : (tensor<1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %1864 = tosa.mul %1863, %1862, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %1865 = tosa.reshape %1864, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1866 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1865, %arg324 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_3 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %1867 = tosa.reshape %1866, %4 : (tensor<1x8960xf32>, !tosa.shape<3>) -> tensor<1x1x8960xf32>
    %1868 = tosa.sigmoid %1867 : (tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %1869 = tosa.mul %1867, %1868, %15 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>, tensor<1xi8>) -> tensor<1x1x8960xf32>
    %1870 = tosa.reshape %1864, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1871 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1870, %arg325 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_3 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %1872 = tosa.reshape %1871, %4 : (tensor<1x8960xf32>, !tosa.shape<3>) -> tensor<1x1x8960xf32>
    %1873 = tosa.mul %1869, %1872, %15 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>, tensor<1xi8>) -> tensor<1x1x8960xf32>
    %1874 = tosa.reshape %1873, %3 : (tensor<1x1x8960xf32>, !tosa.shape<2>) -> tensor<1x8960xf32>
    %1875 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1874, %arg326 : tensor<1x8960xf32>, tensor<8960x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1876 = tosa.reshape %1875, %13 : (tensor<1x1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %1877 = tosa.add %1855, %1876 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %1878 = tensor.empty() : tensor<1x1x1536xf32>
    %1879 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1877 : tensor<1x1x1536xf32>) outs(%1878 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2290 = math.fpowi %in, %c2_i32 : f32, i32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1536xf32>
    %1880 = tosa.reduce_sum %1879 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %1881 = tosa.mul %1880, %0, %15 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1xf32>
    %1882 = tosa.add %1881, %14 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1883 = tosa.rsqrt %1882 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1884 = tosa.mul %1877, %1883, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %1885 = tosa.reshape %arg327, %13 : (tensor<1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %1886 = tosa.mul %1885, %1884, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %1887 = tosa.reshape %1886, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1888 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1887, %arg329 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1889 = tosa.reshape %arg328, %12 : (tensor<1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1890 = tosa.add %1889, %1888 : (tensor<1x1536xf32>, tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1891 = tosa.reshape %1890, %11 : (tensor<1x1536xf32>, !tosa.shape<4>) -> tensor<1x12x1x128xf32>
    %1892 = tosa.reshape %1886, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1893 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1892, %arg331 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_8 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %1894 = tosa.reshape %arg330, %10 : (tensor<256xf32>, !tosa.shape<2>) -> tensor<1x256xf32>
    %1895 = tosa.add %1894, %1893 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %1896 = tosa.reshape %1895, %9 : (tensor<1x256xf32>, !tosa.shape<4>) -> tensor<1x2x1x128xf32>
    %1897 = tosa.reshape %1886, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1898 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1897, %arg333 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_8 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %1899 = tosa.reshape %arg332, %10 : (tensor<256xf32>, !tosa.shape<2>) -> tensor<1x256xf32>
    %1900 = tosa.add %1899, %1898 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %1901 = tosa.reshape %1900, %9 : (tensor<1x256xf32>, !tosa.shape<4>) -> tensor<1x2x1x128xf32>
    %1902 = tosa.reshape %36, %8 : (tensor<1x1x128xf32>, !tosa.shape<4>) -> tensor<1x1x1x128xf32>
    %1903 = tosa.reshape %37, %8 : (tensor<1x1x128xf32>, !tosa.shape<4>) -> tensor<1x1x1x128xf32>
    %1904 = tosa.mul %1891, %1902, %15 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x12x1x128xf32>
    %extracted_slice_260 = tensor.extract_slice %1891[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %extracted_slice_261 = tensor.extract_slice %1891[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %1905 = tosa.negate %extracted_slice_261, %19, %19 : (tensor<1x12x1x64xf32>, tensor<1xf32>, tensor<1xf32>) -> tensor<1x12x1x64xf32>
    %1906 = tensor.empty() : tensor<1x12x1x128xf32>
    %inserted_slice_262 = tensor.insert_slice %1905 into %1906[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %inserted_slice_263 = tensor.insert_slice %extracted_slice_260 into %inserted_slice_262[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %1907 = tosa.mul %inserted_slice_263, %1903, %15 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x12x1x128xf32>
    %1908 = tosa.add %1904, %1907 : (tensor<1x12x1x128xf32>, tensor<1x12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %1909 = tosa.mul %1896, %1902, %15 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x2x1x128xf32>
    %extracted_slice_264 = tensor.extract_slice %1896[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %extracted_slice_265 = tensor.extract_slice %1896[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %1910 = tosa.negate %extracted_slice_265, %19, %19 : (tensor<1x2x1x64xf32>, tensor<1xf32>, tensor<1xf32>) -> tensor<1x2x1x64xf32>
    %1911 = tensor.empty() : tensor<1x2x1x128xf32>
    %inserted_slice_266 = tensor.insert_slice %1910 into %1911[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %inserted_slice_267 = tensor.insert_slice %extracted_slice_264 into %inserted_slice_266[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %1912 = tosa.mul %inserted_slice_267, %1903, %15 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x2x1x128xf32>
    %1913 = tosa.add %1909, %1912 : (tensor<1x2x1x128xf32>, tensor<1x2x1x128xf32>) -> tensor<1x2x1x128xf32>
    %1914 = bufferization.to_buffer %arg334 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %1915 = tosa.reshape %arg3, %7 : (tensor<1xi64>, !tosa.shape<4>) -> tensor<1x1x1x1xi64>
    %1916 = tosa.add %1915, %6 : (tensor<1x1x1x1xi64>, tensor<1x2x1x128xi64>) -> tensor<1x2x1x128xi64>
    %1917 = bufferization.to_buffer %1916 : tensor<1x2x1x128xi64> to memref<1x2x1x128xi64>
    %1918 = bufferization.to_buffer %1913 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    scf.for %arg399 = %c0 to %c1 step %c1 {
      scf.for %arg400 = %c0 to %c2 step %c1 {
        scf.for %arg401 = %c0 to %c1 step %c1 {
          scf.for %arg402 = %c0 to %c128 step %c1 {
            %2290 = memref.load %1918[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            %2291 = memref.load %1917[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xi64>
            %2292 = arith.index_cast %2291 : i64 to index
            memref.store %2290, %1914[%arg399, %arg400, %2292, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %1919 = bufferization.to_tensor %1914 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %1920 = bufferization.to_buffer %arg335 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %1921 = tosa.reshape %arg3, %7 : (tensor<1xi64>, !tosa.shape<4>) -> tensor<1x1x1x1xi64>
    %1922 = tosa.add %1921, %6 : (tensor<1x1x1x1xi64>, tensor<1x2x1x128xi64>) -> tensor<1x2x1x128xi64>
    %1923 = bufferization.to_buffer %1922 : tensor<1x2x1x128xi64> to memref<1x2x1x128xi64>
    %1924 = bufferization.to_buffer %1901 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    scf.for %arg399 = %c0 to %c1 step %c1 {
      scf.for %arg400 = %c0 to %c2 step %c1 {
        scf.for %arg401 = %c0 to %c1 step %c1 {
          scf.for %arg402 = %c0 to %c128 step %c1 {
            %2290 = memref.load %1924[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            %2291 = memref.load %1923[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xi64>
            %2292 = arith.index_cast %2291 : i64 to index
            memref.store %2290, %1920[%arg399, %arg400, %2292, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %1925 = bufferization.to_tensor %1920 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %1926 = tosa.reshape %28, %5 : (tensor<1x1024xi1>, !tosa.shape<4>) -> tensor<1x1x1x1024xi1>
    %1927 = tensor.empty() : tensor<1x1x1x1024xf32>
    %1928 = linalg.generic {indexing_maps = [#map1, #map1, #map1, #map1], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1926, %cst_1, %cst_0 : tensor<1x1x1x1024xi1>, tensor<1x1x1x1024xf32>, tensor<1x1x1x1024xf32>) outs(%1927 : tensor<1x1x1x1024xf32>) {
    ^bb0(%in: i1, %in_315: f32, %in_316: f32, %out: f32):
      %2290 = arith.select %in, %in_315, %in_316 : f32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1x1024xf32>
    %1929 = bufferization.to_buffer %1908 : tensor<1x12x1x128xf32> to memref<1x12x1x128xf32>
    %1930 = bufferization.to_buffer %1928 : tensor<1x1x1x1024xf32> to memref<1x1x1x1024xf32>
    %alloc_268 = memref.alloc() : memref<1x12x1x128xf32>
    %alloc_269 = memref.alloc() : memref<1x12x1xf32>
    %alloc_270 = memref.alloc() : memref<128xf32>
    affine.for %arg399 = 0 to 1 {
      affine.for %arg400 = 0 to 12 {
        %2290 = arith.divsi %arg400, %c6 : index
        affine.for %arg401 = 0 to 1 {
          affine.for %arg402 = 0 to 128 {
            memref.store %cst_7, %alloc_270[%arg402] : memref<128xf32>
          }
          %2291:2 = affine.for %arg402 = 0 to 1024 iter_args(%arg403 = %cst_4, %arg404 = %cst_7) -> (f32, f32) {
            %2292 = affine.for %arg405 = 0 to 128 step 16 iter_args(%arg406 = %cst) -> (vector<16xf32>) {
              %2307 = vector.load %1929[%arg399, %arg400, %arg401, %arg405] : memref<1x12x1x128xf32>, vector<16xf32>
              %2308 = vector.load %1914[%arg399, %2290, %arg402, %arg405] : memref<1x2x1024x128xf32>, vector<16xf32>
              %2309 = vector.fma %2307, %2308, %arg406 : vector<16xf32>
              affine.yield %2309 : vector<16xf32>
            }
            %2293 = vector.reduction <add>, %2292 : vector<16xf32> into f32
            %2294 = arith.mulf %2293, %cst_5 : f32
            %2295 = memref.load %1930[%arg399, %c0, %arg401, %arg402] : memref<1x1x1x1024xf32>
            %2296 = arith.addf %2294, %2295 : f32
            %2297 = arith.cmpf ogt, %2296, %arg403 : f32
            %2298 = arith.select %2297, %2296, %arg403 : f32
            %2299 = arith.subf %arg403, %2296 : f32
            %2300 = math.exp %2299 : f32
            %2301 = arith.mulf %2300, %arg404 : f32
            %2302 = arith.addf %2301, %cst_6 : f32
            %2303 = arith.subf %2296, %arg403 : f32
            %2304 = math.exp %2303 : f32
            %2305 = arith.addf %arg404, %2304 : f32
            %2306 = arith.select %2297, %2302, %2305 : f32
            affine.for %arg405 = 0 to 128 {
              %2307 = memref.load %1920[%arg399, %2290, %arg402, %arg405] : memref<1x2x1024x128xf32>
              %2308 = memref.load %alloc_270[%arg405] : memref<128xf32>
              %2309 = arith.mulf %2308, %2300 : f32
              %2310 = arith.addf %2309, %2307 : f32
              %2311 = arith.mulf %2304, %2307 : f32
              %2312 = arith.addf %2311, %2308 : f32
              %2313 = arith.select %2297, %2310, %2312 : f32
              memref.store %2313, %alloc_270[%arg405] : memref<128xf32>
            }
            affine.yield %2298, %2306 : f32, f32
          }
          memref.store %2291#1, %alloc_269[%arg399, %arg400, %arg401] : memref<1x12x1xf32>
          affine.for %arg402 = 0 to 128 {
            %2292 = memref.load %alloc_270[%arg402] : memref<128xf32>
            %2293 = arith.divf %2292, %2291#1 : f32
            memref.store %2293, %alloc_268[%arg399, %arg400, %arg401, %arg402] : memref<1x12x1x128xf32>
          }
        }
      }
    }
    %1931 = bufferization.to_tensor %alloc_268 restrict : memref<1x12x1x128xf32> to tensor<1x12x1x128xf32>
    %1932 = tosa.reshape %1931, %12 : (tensor<1x12x1x128xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1933 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1932, %arg336 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1934 = tosa.reshape %1933, %13 : (tensor<1x1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %1935 = tosa.add %1877, %1934 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %1936 = tensor.empty() : tensor<1x1x1536xf32>
    %1937 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1935 : tensor<1x1x1536xf32>) outs(%1936 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2290 = math.fpowi %in, %c2_i32 : f32, i32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1536xf32>
    %1938 = tosa.reduce_sum %1937 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %1939 = tosa.mul %1938, %0, %15 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1xf32>
    %1940 = tosa.add %1939, %14 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1941 = tosa.rsqrt %1940 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1942 = tosa.mul %1935, %1941, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %1943 = tosa.reshape %arg337, %13 : (tensor<1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %1944 = tosa.mul %1943, %1942, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %1945 = tosa.reshape %1944, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1946 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1945, %arg338 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_3 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %1947 = tosa.reshape %1946, %4 : (tensor<1x8960xf32>, !tosa.shape<3>) -> tensor<1x1x8960xf32>
    %1948 = tosa.sigmoid %1947 : (tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %1949 = tosa.mul %1947, %1948, %15 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>, tensor<1xi8>) -> tensor<1x1x8960xf32>
    %1950 = tosa.reshape %1944, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1951 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1950, %arg339 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_3 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %1952 = tosa.reshape %1951, %4 : (tensor<1x8960xf32>, !tosa.shape<3>) -> tensor<1x1x8960xf32>
    %1953 = tosa.mul %1949, %1952, %15 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>, tensor<1xi8>) -> tensor<1x1x8960xf32>
    %1954 = tosa.reshape %1953, %3 : (tensor<1x1x8960xf32>, !tosa.shape<2>) -> tensor<1x8960xf32>
    %1955 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1954, %arg340 : tensor<1x8960xf32>, tensor<8960x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1956 = tosa.reshape %1955, %13 : (tensor<1x1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %1957 = tosa.add %1935, %1956 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %1958 = tensor.empty() : tensor<1x1x1536xf32>
    %1959 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1957 : tensor<1x1x1536xf32>) outs(%1958 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2290 = math.fpowi %in, %c2_i32 : f32, i32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1536xf32>
    %1960 = tosa.reduce_sum %1959 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %1961 = tosa.mul %1960, %0, %15 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1xf32>
    %1962 = tosa.add %1961, %14 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1963 = tosa.rsqrt %1962 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %1964 = tosa.mul %1957, %1963, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %1965 = tosa.reshape %arg341, %13 : (tensor<1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %1966 = tosa.mul %1965, %1964, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %1967 = tosa.reshape %1966, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1968 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1967, %arg343 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1969 = tosa.reshape %arg342, %12 : (tensor<1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1970 = tosa.add %1969, %1968 : (tensor<1x1536xf32>, tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %1971 = tosa.reshape %1970, %11 : (tensor<1x1536xf32>, !tosa.shape<4>) -> tensor<1x12x1x128xf32>
    %1972 = tosa.reshape %1966, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1973 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1972, %arg345 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_8 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %1974 = tosa.reshape %arg344, %10 : (tensor<256xf32>, !tosa.shape<2>) -> tensor<1x256xf32>
    %1975 = tosa.add %1974, %1973 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %1976 = tosa.reshape %1975, %9 : (tensor<1x256xf32>, !tosa.shape<4>) -> tensor<1x2x1x128xf32>
    %1977 = tosa.reshape %1966, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %1978 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%1977, %arg347 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_8 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %1979 = tosa.reshape %arg346, %10 : (tensor<256xf32>, !tosa.shape<2>) -> tensor<1x256xf32>
    %1980 = tosa.add %1979, %1978 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %1981 = tosa.reshape %1980, %9 : (tensor<1x256xf32>, !tosa.shape<4>) -> tensor<1x2x1x128xf32>
    %1982 = tosa.reshape %36, %8 : (tensor<1x1x128xf32>, !tosa.shape<4>) -> tensor<1x1x1x128xf32>
    %1983 = tosa.reshape %37, %8 : (tensor<1x1x128xf32>, !tosa.shape<4>) -> tensor<1x1x1x128xf32>
    %1984 = tosa.mul %1971, %1982, %15 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x12x1x128xf32>
    %extracted_slice_271 = tensor.extract_slice %1971[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %extracted_slice_272 = tensor.extract_slice %1971[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %1985 = tosa.negate %extracted_slice_272, %19, %19 : (tensor<1x12x1x64xf32>, tensor<1xf32>, tensor<1xf32>) -> tensor<1x12x1x64xf32>
    %1986 = tensor.empty() : tensor<1x12x1x128xf32>
    %inserted_slice_273 = tensor.insert_slice %1985 into %1986[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %inserted_slice_274 = tensor.insert_slice %extracted_slice_271 into %inserted_slice_273[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %1987 = tosa.mul %inserted_slice_274, %1983, %15 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x12x1x128xf32>
    %1988 = tosa.add %1984, %1987 : (tensor<1x12x1x128xf32>, tensor<1x12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %1989 = tosa.mul %1976, %1982, %15 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x2x1x128xf32>
    %extracted_slice_275 = tensor.extract_slice %1976[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %extracted_slice_276 = tensor.extract_slice %1976[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %1990 = tosa.negate %extracted_slice_276, %19, %19 : (tensor<1x2x1x64xf32>, tensor<1xf32>, tensor<1xf32>) -> tensor<1x2x1x64xf32>
    %1991 = tensor.empty() : tensor<1x2x1x128xf32>
    %inserted_slice_277 = tensor.insert_slice %1990 into %1991[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %inserted_slice_278 = tensor.insert_slice %extracted_slice_275 into %inserted_slice_277[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %1992 = tosa.mul %inserted_slice_278, %1983, %15 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x2x1x128xf32>
    %1993 = tosa.add %1989, %1992 : (tensor<1x2x1x128xf32>, tensor<1x2x1x128xf32>) -> tensor<1x2x1x128xf32>
    %1994 = bufferization.to_buffer %arg348 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %1995 = tosa.reshape %arg3, %7 : (tensor<1xi64>, !tosa.shape<4>) -> tensor<1x1x1x1xi64>
    %1996 = tosa.add %1995, %6 : (tensor<1x1x1x1xi64>, tensor<1x2x1x128xi64>) -> tensor<1x2x1x128xi64>
    %1997 = bufferization.to_buffer %1996 : tensor<1x2x1x128xi64> to memref<1x2x1x128xi64>
    %1998 = bufferization.to_buffer %1993 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    scf.for %arg399 = %c0 to %c1 step %c1 {
      scf.for %arg400 = %c0 to %c2 step %c1 {
        scf.for %arg401 = %c0 to %c1 step %c1 {
          scf.for %arg402 = %c0 to %c128 step %c1 {
            %2290 = memref.load %1998[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            %2291 = memref.load %1997[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xi64>
            %2292 = arith.index_cast %2291 : i64 to index
            memref.store %2290, %1994[%arg399, %arg400, %2292, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %1999 = bufferization.to_tensor %1994 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %2000 = bufferization.to_buffer %arg349 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %2001 = tosa.reshape %arg3, %7 : (tensor<1xi64>, !tosa.shape<4>) -> tensor<1x1x1x1xi64>
    %2002 = tosa.add %2001, %6 : (tensor<1x1x1x1xi64>, tensor<1x2x1x128xi64>) -> tensor<1x2x1x128xi64>
    %2003 = bufferization.to_buffer %2002 : tensor<1x2x1x128xi64> to memref<1x2x1x128xi64>
    %2004 = bufferization.to_buffer %1981 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    scf.for %arg399 = %c0 to %c1 step %c1 {
      scf.for %arg400 = %c0 to %c2 step %c1 {
        scf.for %arg401 = %c0 to %c1 step %c1 {
          scf.for %arg402 = %c0 to %c128 step %c1 {
            %2290 = memref.load %2004[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            %2291 = memref.load %2003[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xi64>
            %2292 = arith.index_cast %2291 : i64 to index
            memref.store %2290, %2000[%arg399, %arg400, %2292, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %2005 = bufferization.to_tensor %2000 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %2006 = tosa.reshape %28, %5 : (tensor<1x1024xi1>, !tosa.shape<4>) -> tensor<1x1x1x1024xi1>
    %2007 = tensor.empty() : tensor<1x1x1x1024xf32>
    %2008 = linalg.generic {indexing_maps = [#map1, #map1, #map1, #map1], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2006, %cst_1, %cst_0 : tensor<1x1x1x1024xi1>, tensor<1x1x1x1024xf32>, tensor<1x1x1x1024xf32>) outs(%2007 : tensor<1x1x1x1024xf32>) {
    ^bb0(%in: i1, %in_315: f32, %in_316: f32, %out: f32):
      %2290 = arith.select %in, %in_315, %in_316 : f32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1x1024xf32>
    %2009 = bufferization.to_buffer %1988 : tensor<1x12x1x128xf32> to memref<1x12x1x128xf32>
    %2010 = bufferization.to_buffer %2008 : tensor<1x1x1x1024xf32> to memref<1x1x1x1024xf32>
    %alloc_279 = memref.alloc() : memref<1x12x1x128xf32>
    %alloc_280 = memref.alloc() : memref<1x12x1xf32>
    %alloc_281 = memref.alloc() : memref<128xf32>
    affine.for %arg399 = 0 to 1 {
      affine.for %arg400 = 0 to 12 {
        %2290 = arith.divsi %arg400, %c6 : index
        affine.for %arg401 = 0 to 1 {
          affine.for %arg402 = 0 to 128 {
            memref.store %cst_7, %alloc_281[%arg402] : memref<128xf32>
          }
          %2291:2 = affine.for %arg402 = 0 to 1024 iter_args(%arg403 = %cst_4, %arg404 = %cst_7) -> (f32, f32) {
            %2292 = affine.for %arg405 = 0 to 128 step 16 iter_args(%arg406 = %cst) -> (vector<16xf32>) {
              %2307 = vector.load %2009[%arg399, %arg400, %arg401, %arg405] : memref<1x12x1x128xf32>, vector<16xf32>
              %2308 = vector.load %1994[%arg399, %2290, %arg402, %arg405] : memref<1x2x1024x128xf32>, vector<16xf32>
              %2309 = vector.fma %2307, %2308, %arg406 : vector<16xf32>
              affine.yield %2309 : vector<16xf32>
            }
            %2293 = vector.reduction <add>, %2292 : vector<16xf32> into f32
            %2294 = arith.mulf %2293, %cst_5 : f32
            %2295 = memref.load %2010[%arg399, %c0, %arg401, %arg402] : memref<1x1x1x1024xf32>
            %2296 = arith.addf %2294, %2295 : f32
            %2297 = arith.cmpf ogt, %2296, %arg403 : f32
            %2298 = arith.select %2297, %2296, %arg403 : f32
            %2299 = arith.subf %arg403, %2296 : f32
            %2300 = math.exp %2299 : f32
            %2301 = arith.mulf %2300, %arg404 : f32
            %2302 = arith.addf %2301, %cst_6 : f32
            %2303 = arith.subf %2296, %arg403 : f32
            %2304 = math.exp %2303 : f32
            %2305 = arith.addf %arg404, %2304 : f32
            %2306 = arith.select %2297, %2302, %2305 : f32
            affine.for %arg405 = 0 to 128 {
              %2307 = memref.load %2000[%arg399, %2290, %arg402, %arg405] : memref<1x2x1024x128xf32>
              %2308 = memref.load %alloc_281[%arg405] : memref<128xf32>
              %2309 = arith.mulf %2308, %2300 : f32
              %2310 = arith.addf %2309, %2307 : f32
              %2311 = arith.mulf %2304, %2307 : f32
              %2312 = arith.addf %2311, %2308 : f32
              %2313 = arith.select %2297, %2310, %2312 : f32
              memref.store %2313, %alloc_281[%arg405] : memref<128xf32>
            }
            affine.yield %2298, %2306 : f32, f32
          }
          memref.store %2291#1, %alloc_280[%arg399, %arg400, %arg401] : memref<1x12x1xf32>
          affine.for %arg402 = 0 to 128 {
            %2292 = memref.load %alloc_281[%arg402] : memref<128xf32>
            %2293 = arith.divf %2292, %2291#1 : f32
            memref.store %2293, %alloc_279[%arg399, %arg400, %arg401, %arg402] : memref<1x12x1x128xf32>
          }
        }
      }
    }
    %2011 = bufferization.to_tensor %alloc_279 restrict : memref<1x12x1x128xf32> to tensor<1x12x1x128xf32>
    %2012 = tosa.reshape %2011, %12 : (tensor<1x12x1x128xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %2013 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%2012, %arg350 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %2014 = tosa.reshape %2013, %13 : (tensor<1x1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %2015 = tosa.add %1957, %2014 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %2016 = tensor.empty() : tensor<1x1x1536xf32>
    %2017 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2015 : tensor<1x1x1536xf32>) outs(%2016 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2290 = math.fpowi %in, %c2_i32 : f32, i32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1536xf32>
    %2018 = tosa.reduce_sum %2017 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %2019 = tosa.mul %2018, %0, %15 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1xf32>
    %2020 = tosa.add %2019, %14 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %2021 = tosa.rsqrt %2020 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %2022 = tosa.mul %2015, %2021, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %2023 = tosa.reshape %arg351, %13 : (tensor<1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %2024 = tosa.mul %2023, %2022, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %2025 = tosa.reshape %2024, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %2026 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%2025, %arg352 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_3 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %2027 = tosa.reshape %2026, %4 : (tensor<1x8960xf32>, !tosa.shape<3>) -> tensor<1x1x8960xf32>
    %2028 = tosa.sigmoid %2027 : (tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %2029 = tosa.mul %2027, %2028, %15 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>, tensor<1xi8>) -> tensor<1x1x8960xf32>
    %2030 = tosa.reshape %2024, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %2031 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%2030, %arg353 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_3 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %2032 = tosa.reshape %2031, %4 : (tensor<1x8960xf32>, !tosa.shape<3>) -> tensor<1x1x8960xf32>
    %2033 = tosa.mul %2029, %2032, %15 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>, tensor<1xi8>) -> tensor<1x1x8960xf32>
    %2034 = tosa.reshape %2033, %3 : (tensor<1x1x8960xf32>, !tosa.shape<2>) -> tensor<1x8960xf32>
    %2035 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%2034, %arg354 : tensor<1x8960xf32>, tensor<8960x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %2036 = tosa.reshape %2035, %13 : (tensor<1x1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %2037 = tosa.add %2015, %2036 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %2038 = tensor.empty() : tensor<1x1x1536xf32>
    %2039 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2037 : tensor<1x1x1536xf32>) outs(%2038 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2290 = math.fpowi %in, %c2_i32 : f32, i32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1536xf32>
    %2040 = tosa.reduce_sum %2039 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %2041 = tosa.mul %2040, %0, %15 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1xf32>
    %2042 = tosa.add %2041, %14 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %2043 = tosa.rsqrt %2042 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %2044 = tosa.mul %2037, %2043, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %2045 = tosa.reshape %arg355, %13 : (tensor<1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %2046 = tosa.mul %2045, %2044, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %2047 = tosa.reshape %2046, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %2048 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%2047, %arg357 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %2049 = tosa.reshape %arg356, %12 : (tensor<1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %2050 = tosa.add %2049, %2048 : (tensor<1x1536xf32>, tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %2051 = tosa.reshape %2050, %11 : (tensor<1x1536xf32>, !tosa.shape<4>) -> tensor<1x12x1x128xf32>
    %2052 = tosa.reshape %2046, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %2053 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%2052, %arg359 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_8 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %2054 = tosa.reshape %arg358, %10 : (tensor<256xf32>, !tosa.shape<2>) -> tensor<1x256xf32>
    %2055 = tosa.add %2054, %2053 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %2056 = tosa.reshape %2055, %9 : (tensor<1x256xf32>, !tosa.shape<4>) -> tensor<1x2x1x128xf32>
    %2057 = tosa.reshape %2046, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %2058 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%2057, %arg361 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_8 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %2059 = tosa.reshape %arg360, %10 : (tensor<256xf32>, !tosa.shape<2>) -> tensor<1x256xf32>
    %2060 = tosa.add %2059, %2058 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %2061 = tosa.reshape %2060, %9 : (tensor<1x256xf32>, !tosa.shape<4>) -> tensor<1x2x1x128xf32>
    %2062 = tosa.reshape %36, %8 : (tensor<1x1x128xf32>, !tosa.shape<4>) -> tensor<1x1x1x128xf32>
    %2063 = tosa.reshape %37, %8 : (tensor<1x1x128xf32>, !tosa.shape<4>) -> tensor<1x1x1x128xf32>
    %2064 = tosa.mul %2051, %2062, %15 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x12x1x128xf32>
    %extracted_slice_282 = tensor.extract_slice %2051[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %extracted_slice_283 = tensor.extract_slice %2051[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %2065 = tosa.negate %extracted_slice_283, %19, %19 : (tensor<1x12x1x64xf32>, tensor<1xf32>, tensor<1xf32>) -> tensor<1x12x1x64xf32>
    %2066 = tensor.empty() : tensor<1x12x1x128xf32>
    %inserted_slice_284 = tensor.insert_slice %2065 into %2066[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %inserted_slice_285 = tensor.insert_slice %extracted_slice_282 into %inserted_slice_284[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %2067 = tosa.mul %inserted_slice_285, %2063, %15 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x12x1x128xf32>
    %2068 = tosa.add %2064, %2067 : (tensor<1x12x1x128xf32>, tensor<1x12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %2069 = tosa.mul %2056, %2062, %15 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x2x1x128xf32>
    %extracted_slice_286 = tensor.extract_slice %2056[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %extracted_slice_287 = tensor.extract_slice %2056[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %2070 = tosa.negate %extracted_slice_287, %19, %19 : (tensor<1x2x1x64xf32>, tensor<1xf32>, tensor<1xf32>) -> tensor<1x2x1x64xf32>
    %2071 = tensor.empty() : tensor<1x2x1x128xf32>
    %inserted_slice_288 = tensor.insert_slice %2070 into %2071[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %inserted_slice_289 = tensor.insert_slice %extracted_slice_286 into %inserted_slice_288[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %2072 = tosa.mul %inserted_slice_289, %2063, %15 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x2x1x128xf32>
    %2073 = tosa.add %2069, %2072 : (tensor<1x2x1x128xf32>, tensor<1x2x1x128xf32>) -> tensor<1x2x1x128xf32>
    %2074 = bufferization.to_buffer %arg362 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %2075 = tosa.reshape %arg3, %7 : (tensor<1xi64>, !tosa.shape<4>) -> tensor<1x1x1x1xi64>
    %2076 = tosa.add %2075, %6 : (tensor<1x1x1x1xi64>, tensor<1x2x1x128xi64>) -> tensor<1x2x1x128xi64>
    %2077 = bufferization.to_buffer %2076 : tensor<1x2x1x128xi64> to memref<1x2x1x128xi64>
    %2078 = bufferization.to_buffer %2073 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    scf.for %arg399 = %c0 to %c1 step %c1 {
      scf.for %arg400 = %c0 to %c2 step %c1 {
        scf.for %arg401 = %c0 to %c1 step %c1 {
          scf.for %arg402 = %c0 to %c128 step %c1 {
            %2290 = memref.load %2078[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            %2291 = memref.load %2077[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xi64>
            %2292 = arith.index_cast %2291 : i64 to index
            memref.store %2290, %2074[%arg399, %arg400, %2292, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %2079 = bufferization.to_tensor %2074 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %2080 = bufferization.to_buffer %arg363 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %2081 = tosa.reshape %arg3, %7 : (tensor<1xi64>, !tosa.shape<4>) -> tensor<1x1x1x1xi64>
    %2082 = tosa.add %2081, %6 : (tensor<1x1x1x1xi64>, tensor<1x2x1x128xi64>) -> tensor<1x2x1x128xi64>
    %2083 = bufferization.to_buffer %2082 : tensor<1x2x1x128xi64> to memref<1x2x1x128xi64>
    %2084 = bufferization.to_buffer %2061 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    scf.for %arg399 = %c0 to %c1 step %c1 {
      scf.for %arg400 = %c0 to %c2 step %c1 {
        scf.for %arg401 = %c0 to %c1 step %c1 {
          scf.for %arg402 = %c0 to %c128 step %c1 {
            %2290 = memref.load %2084[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            %2291 = memref.load %2083[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xi64>
            %2292 = arith.index_cast %2291 : i64 to index
            memref.store %2290, %2080[%arg399, %arg400, %2292, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %2085 = bufferization.to_tensor %2080 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %2086 = tosa.reshape %28, %5 : (tensor<1x1024xi1>, !tosa.shape<4>) -> tensor<1x1x1x1024xi1>
    %2087 = tensor.empty() : tensor<1x1x1x1024xf32>
    %2088 = linalg.generic {indexing_maps = [#map1, #map1, #map1, #map1], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2086, %cst_1, %cst_0 : tensor<1x1x1x1024xi1>, tensor<1x1x1x1024xf32>, tensor<1x1x1x1024xf32>) outs(%2087 : tensor<1x1x1x1024xf32>) {
    ^bb0(%in: i1, %in_315: f32, %in_316: f32, %out: f32):
      %2290 = arith.select %in, %in_315, %in_316 : f32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1x1024xf32>
    %2089 = bufferization.to_buffer %2068 : tensor<1x12x1x128xf32> to memref<1x12x1x128xf32>
    %2090 = bufferization.to_buffer %2088 : tensor<1x1x1x1024xf32> to memref<1x1x1x1024xf32>
    %alloc_290 = memref.alloc() : memref<1x12x1x128xf32>
    %alloc_291 = memref.alloc() : memref<1x12x1xf32>
    %alloc_292 = memref.alloc() : memref<128xf32>
    affine.for %arg399 = 0 to 1 {
      affine.for %arg400 = 0 to 12 {
        %2290 = arith.divsi %arg400, %c6 : index
        affine.for %arg401 = 0 to 1 {
          affine.for %arg402 = 0 to 128 {
            memref.store %cst_7, %alloc_292[%arg402] : memref<128xf32>
          }
          %2291:2 = affine.for %arg402 = 0 to 1024 iter_args(%arg403 = %cst_4, %arg404 = %cst_7) -> (f32, f32) {
            %2292 = affine.for %arg405 = 0 to 128 step 16 iter_args(%arg406 = %cst) -> (vector<16xf32>) {
              %2307 = vector.load %2089[%arg399, %arg400, %arg401, %arg405] : memref<1x12x1x128xf32>, vector<16xf32>
              %2308 = vector.load %2074[%arg399, %2290, %arg402, %arg405] : memref<1x2x1024x128xf32>, vector<16xf32>
              %2309 = vector.fma %2307, %2308, %arg406 : vector<16xf32>
              affine.yield %2309 : vector<16xf32>
            }
            %2293 = vector.reduction <add>, %2292 : vector<16xf32> into f32
            %2294 = arith.mulf %2293, %cst_5 : f32
            %2295 = memref.load %2090[%arg399, %c0, %arg401, %arg402] : memref<1x1x1x1024xf32>
            %2296 = arith.addf %2294, %2295 : f32
            %2297 = arith.cmpf ogt, %2296, %arg403 : f32
            %2298 = arith.select %2297, %2296, %arg403 : f32
            %2299 = arith.subf %arg403, %2296 : f32
            %2300 = math.exp %2299 : f32
            %2301 = arith.mulf %2300, %arg404 : f32
            %2302 = arith.addf %2301, %cst_6 : f32
            %2303 = arith.subf %2296, %arg403 : f32
            %2304 = math.exp %2303 : f32
            %2305 = arith.addf %arg404, %2304 : f32
            %2306 = arith.select %2297, %2302, %2305 : f32
            affine.for %arg405 = 0 to 128 {
              %2307 = memref.load %2080[%arg399, %2290, %arg402, %arg405] : memref<1x2x1024x128xf32>
              %2308 = memref.load %alloc_292[%arg405] : memref<128xf32>
              %2309 = arith.mulf %2308, %2300 : f32
              %2310 = arith.addf %2309, %2307 : f32
              %2311 = arith.mulf %2304, %2307 : f32
              %2312 = arith.addf %2311, %2308 : f32
              %2313 = arith.select %2297, %2310, %2312 : f32
              memref.store %2313, %alloc_292[%arg405] : memref<128xf32>
            }
            affine.yield %2298, %2306 : f32, f32
          }
          memref.store %2291#1, %alloc_291[%arg399, %arg400, %arg401] : memref<1x12x1xf32>
          affine.for %arg402 = 0 to 128 {
            %2292 = memref.load %alloc_292[%arg402] : memref<128xf32>
            %2293 = arith.divf %2292, %2291#1 : f32
            memref.store %2293, %alloc_290[%arg399, %arg400, %arg401, %arg402] : memref<1x12x1x128xf32>
          }
        }
      }
    }
    %2091 = bufferization.to_tensor %alloc_290 restrict : memref<1x12x1x128xf32> to tensor<1x12x1x128xf32>
    %2092 = tosa.reshape %2091, %12 : (tensor<1x12x1x128xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %2093 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%2092, %arg364 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %2094 = tosa.reshape %2093, %13 : (tensor<1x1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %2095 = tosa.add %2037, %2094 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %2096 = tensor.empty() : tensor<1x1x1536xf32>
    %2097 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2095 : tensor<1x1x1536xf32>) outs(%2096 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2290 = math.fpowi %in, %c2_i32 : f32, i32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1536xf32>
    %2098 = tosa.reduce_sum %2097 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %2099 = tosa.mul %2098, %0, %15 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1xf32>
    %2100 = tosa.add %2099, %14 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %2101 = tosa.rsqrt %2100 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %2102 = tosa.mul %2095, %2101, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %2103 = tosa.reshape %arg365, %13 : (tensor<1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %2104 = tosa.mul %2103, %2102, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %2105 = tosa.reshape %2104, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %2106 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%2105, %arg366 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_3 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %2107 = tosa.reshape %2106, %4 : (tensor<1x8960xf32>, !tosa.shape<3>) -> tensor<1x1x8960xf32>
    %2108 = tosa.sigmoid %2107 : (tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %2109 = tosa.mul %2107, %2108, %15 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>, tensor<1xi8>) -> tensor<1x1x8960xf32>
    %2110 = tosa.reshape %2104, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %2111 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%2110, %arg367 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_3 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %2112 = tosa.reshape %2111, %4 : (tensor<1x8960xf32>, !tosa.shape<3>) -> tensor<1x1x8960xf32>
    %2113 = tosa.mul %2109, %2112, %15 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>, tensor<1xi8>) -> tensor<1x1x8960xf32>
    %2114 = tosa.reshape %2113, %3 : (tensor<1x1x8960xf32>, !tosa.shape<2>) -> tensor<1x8960xf32>
    %2115 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%2114, %arg368 : tensor<1x8960xf32>, tensor<8960x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %2116 = tosa.reshape %2115, %13 : (tensor<1x1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %2117 = tosa.add %2095, %2116 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %2118 = tensor.empty() : tensor<1x1x1536xf32>
    %2119 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2117 : tensor<1x1x1536xf32>) outs(%2118 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2290 = math.fpowi %in, %c2_i32 : f32, i32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1536xf32>
    %2120 = tosa.reduce_sum %2119 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %2121 = tosa.mul %2120, %0, %15 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1xf32>
    %2122 = tosa.add %2121, %14 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %2123 = tosa.rsqrt %2122 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %2124 = tosa.mul %2117, %2123, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %2125 = tosa.reshape %arg369, %13 : (tensor<1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %2126 = tosa.mul %2125, %2124, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %2127 = tosa.reshape %2126, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %2128 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%2127, %arg371 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %2129 = tosa.reshape %arg370, %12 : (tensor<1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %2130 = tosa.add %2129, %2128 : (tensor<1x1536xf32>, tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %2131 = tosa.reshape %2130, %11 : (tensor<1x1536xf32>, !tosa.shape<4>) -> tensor<1x12x1x128xf32>
    %2132 = tosa.reshape %2126, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %2133 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%2132, %arg373 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_8 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %2134 = tosa.reshape %arg372, %10 : (tensor<256xf32>, !tosa.shape<2>) -> tensor<1x256xf32>
    %2135 = tosa.add %2134, %2133 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %2136 = tosa.reshape %2135, %9 : (tensor<1x256xf32>, !tosa.shape<4>) -> tensor<1x2x1x128xf32>
    %2137 = tosa.reshape %2126, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %2138 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%2137, %arg375 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_8 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %2139 = tosa.reshape %arg374, %10 : (tensor<256xf32>, !tosa.shape<2>) -> tensor<1x256xf32>
    %2140 = tosa.add %2139, %2138 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %2141 = tosa.reshape %2140, %9 : (tensor<1x256xf32>, !tosa.shape<4>) -> tensor<1x2x1x128xf32>
    %2142 = tosa.reshape %36, %8 : (tensor<1x1x128xf32>, !tosa.shape<4>) -> tensor<1x1x1x128xf32>
    %2143 = tosa.reshape %37, %8 : (tensor<1x1x128xf32>, !tosa.shape<4>) -> tensor<1x1x1x128xf32>
    %2144 = tosa.mul %2131, %2142, %15 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x12x1x128xf32>
    %extracted_slice_293 = tensor.extract_slice %2131[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %extracted_slice_294 = tensor.extract_slice %2131[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %2145 = tosa.negate %extracted_slice_294, %19, %19 : (tensor<1x12x1x64xf32>, tensor<1xf32>, tensor<1xf32>) -> tensor<1x12x1x64xf32>
    %2146 = tensor.empty() : tensor<1x12x1x128xf32>
    %inserted_slice_295 = tensor.insert_slice %2145 into %2146[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %inserted_slice_296 = tensor.insert_slice %extracted_slice_293 into %inserted_slice_295[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %2147 = tosa.mul %inserted_slice_296, %2143, %15 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x12x1x128xf32>
    %2148 = tosa.add %2144, %2147 : (tensor<1x12x1x128xf32>, tensor<1x12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %2149 = tosa.mul %2136, %2142, %15 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x2x1x128xf32>
    %extracted_slice_297 = tensor.extract_slice %2136[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %extracted_slice_298 = tensor.extract_slice %2136[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %2150 = tosa.negate %extracted_slice_298, %19, %19 : (tensor<1x2x1x64xf32>, tensor<1xf32>, tensor<1xf32>) -> tensor<1x2x1x64xf32>
    %2151 = tensor.empty() : tensor<1x2x1x128xf32>
    %inserted_slice_299 = tensor.insert_slice %2150 into %2151[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %inserted_slice_300 = tensor.insert_slice %extracted_slice_297 into %inserted_slice_299[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %2152 = tosa.mul %inserted_slice_300, %2143, %15 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x2x1x128xf32>
    %2153 = tosa.add %2149, %2152 : (tensor<1x2x1x128xf32>, tensor<1x2x1x128xf32>) -> tensor<1x2x1x128xf32>
    %2154 = bufferization.to_buffer %arg376 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %2155 = tosa.reshape %arg3, %7 : (tensor<1xi64>, !tosa.shape<4>) -> tensor<1x1x1x1xi64>
    %2156 = tosa.add %2155, %6 : (tensor<1x1x1x1xi64>, tensor<1x2x1x128xi64>) -> tensor<1x2x1x128xi64>
    %2157 = bufferization.to_buffer %2156 : tensor<1x2x1x128xi64> to memref<1x2x1x128xi64>
    %2158 = bufferization.to_buffer %2153 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    scf.for %arg399 = %c0 to %c1 step %c1 {
      scf.for %arg400 = %c0 to %c2 step %c1 {
        scf.for %arg401 = %c0 to %c1 step %c1 {
          scf.for %arg402 = %c0 to %c128 step %c1 {
            %2290 = memref.load %2158[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            %2291 = memref.load %2157[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xi64>
            %2292 = arith.index_cast %2291 : i64 to index
            memref.store %2290, %2154[%arg399, %arg400, %2292, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %2159 = bufferization.to_tensor %2154 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %2160 = bufferization.to_buffer %arg377 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %2161 = tosa.reshape %arg3, %7 : (tensor<1xi64>, !tosa.shape<4>) -> tensor<1x1x1x1xi64>
    %2162 = tosa.add %2161, %6 : (tensor<1x1x1x1xi64>, tensor<1x2x1x128xi64>) -> tensor<1x2x1x128xi64>
    %2163 = bufferization.to_buffer %2162 : tensor<1x2x1x128xi64> to memref<1x2x1x128xi64>
    %2164 = bufferization.to_buffer %2141 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    scf.for %arg399 = %c0 to %c1 step %c1 {
      scf.for %arg400 = %c0 to %c2 step %c1 {
        scf.for %arg401 = %c0 to %c1 step %c1 {
          scf.for %arg402 = %c0 to %c128 step %c1 {
            %2290 = memref.load %2164[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            %2291 = memref.load %2163[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xi64>
            %2292 = arith.index_cast %2291 : i64 to index
            memref.store %2290, %2160[%arg399, %arg400, %2292, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %2165 = bufferization.to_tensor %2160 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %2166 = tosa.reshape %28, %5 : (tensor<1x1024xi1>, !tosa.shape<4>) -> tensor<1x1x1x1024xi1>
    %2167 = tensor.empty() : tensor<1x1x1x1024xf32>
    %2168 = linalg.generic {indexing_maps = [#map1, #map1, #map1, #map1], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2166, %cst_1, %cst_0 : tensor<1x1x1x1024xi1>, tensor<1x1x1x1024xf32>, tensor<1x1x1x1024xf32>) outs(%2167 : tensor<1x1x1x1024xf32>) {
    ^bb0(%in: i1, %in_315: f32, %in_316: f32, %out: f32):
      %2290 = arith.select %in, %in_315, %in_316 : f32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1x1024xf32>
    %2169 = bufferization.to_buffer %2148 : tensor<1x12x1x128xf32> to memref<1x12x1x128xf32>
    %2170 = bufferization.to_buffer %2168 : tensor<1x1x1x1024xf32> to memref<1x1x1x1024xf32>
    %alloc_301 = memref.alloc() : memref<1x12x1x128xf32>
    %alloc_302 = memref.alloc() : memref<1x12x1xf32>
    %alloc_303 = memref.alloc() : memref<128xf32>
    affine.for %arg399 = 0 to 1 {
      affine.for %arg400 = 0 to 12 {
        %2290 = arith.divsi %arg400, %c6 : index
        affine.for %arg401 = 0 to 1 {
          affine.for %arg402 = 0 to 128 {
            memref.store %cst_7, %alloc_303[%arg402] : memref<128xf32>
          }
          %2291:2 = affine.for %arg402 = 0 to 1024 iter_args(%arg403 = %cst_4, %arg404 = %cst_7) -> (f32, f32) {
            %2292 = affine.for %arg405 = 0 to 128 step 16 iter_args(%arg406 = %cst) -> (vector<16xf32>) {
              %2307 = vector.load %2169[%arg399, %arg400, %arg401, %arg405] : memref<1x12x1x128xf32>, vector<16xf32>
              %2308 = vector.load %2154[%arg399, %2290, %arg402, %arg405] : memref<1x2x1024x128xf32>, vector<16xf32>
              %2309 = vector.fma %2307, %2308, %arg406 : vector<16xf32>
              affine.yield %2309 : vector<16xf32>
            }
            %2293 = vector.reduction <add>, %2292 : vector<16xf32> into f32
            %2294 = arith.mulf %2293, %cst_5 : f32
            %2295 = memref.load %2170[%arg399, %c0, %arg401, %arg402] : memref<1x1x1x1024xf32>
            %2296 = arith.addf %2294, %2295 : f32
            %2297 = arith.cmpf ogt, %2296, %arg403 : f32
            %2298 = arith.select %2297, %2296, %arg403 : f32
            %2299 = arith.subf %arg403, %2296 : f32
            %2300 = math.exp %2299 : f32
            %2301 = arith.mulf %2300, %arg404 : f32
            %2302 = arith.addf %2301, %cst_6 : f32
            %2303 = arith.subf %2296, %arg403 : f32
            %2304 = math.exp %2303 : f32
            %2305 = arith.addf %arg404, %2304 : f32
            %2306 = arith.select %2297, %2302, %2305 : f32
            affine.for %arg405 = 0 to 128 {
              %2307 = memref.load %2160[%arg399, %2290, %arg402, %arg405] : memref<1x2x1024x128xf32>
              %2308 = memref.load %alloc_303[%arg405] : memref<128xf32>
              %2309 = arith.mulf %2308, %2300 : f32
              %2310 = arith.addf %2309, %2307 : f32
              %2311 = arith.mulf %2304, %2307 : f32
              %2312 = arith.addf %2311, %2308 : f32
              %2313 = arith.select %2297, %2310, %2312 : f32
              memref.store %2313, %alloc_303[%arg405] : memref<128xf32>
            }
            affine.yield %2298, %2306 : f32, f32
          }
          memref.store %2291#1, %alloc_302[%arg399, %arg400, %arg401] : memref<1x12x1xf32>
          affine.for %arg402 = 0 to 128 {
            %2292 = memref.load %alloc_303[%arg402] : memref<128xf32>
            %2293 = arith.divf %2292, %2291#1 : f32
            memref.store %2293, %alloc_301[%arg399, %arg400, %arg401, %arg402] : memref<1x12x1x128xf32>
          }
        }
      }
    }
    %2171 = bufferization.to_tensor %alloc_301 restrict : memref<1x12x1x128xf32> to tensor<1x12x1x128xf32>
    %2172 = tosa.reshape %2171, %12 : (tensor<1x12x1x128xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %2173 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%2172, %arg378 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %2174 = tosa.reshape %2173, %13 : (tensor<1x1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %2175 = tosa.add %2117, %2174 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %2176 = tensor.empty() : tensor<1x1x1536xf32>
    %2177 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2175 : tensor<1x1x1536xf32>) outs(%2176 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2290 = math.fpowi %in, %c2_i32 : f32, i32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1536xf32>
    %2178 = tosa.reduce_sum %2177 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %2179 = tosa.mul %2178, %0, %15 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1xf32>
    %2180 = tosa.add %2179, %14 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %2181 = tosa.rsqrt %2180 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %2182 = tosa.mul %2175, %2181, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %2183 = tosa.reshape %arg379, %13 : (tensor<1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %2184 = tosa.mul %2183, %2182, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %2185 = tosa.reshape %2184, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %2186 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%2185, %arg380 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_3 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %2187 = tosa.reshape %2186, %4 : (tensor<1x8960xf32>, !tosa.shape<3>) -> tensor<1x1x8960xf32>
    %2188 = tosa.sigmoid %2187 : (tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %2189 = tosa.mul %2187, %2188, %15 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>, tensor<1xi8>) -> tensor<1x1x8960xf32>
    %2190 = tosa.reshape %2184, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %2191 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%2190, %arg381 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_3 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %2192 = tosa.reshape %2191, %4 : (tensor<1x8960xf32>, !tosa.shape<3>) -> tensor<1x1x8960xf32>
    %2193 = tosa.mul %2189, %2192, %15 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>, tensor<1xi8>) -> tensor<1x1x8960xf32>
    %2194 = tosa.reshape %2193, %3 : (tensor<1x1x8960xf32>, !tosa.shape<2>) -> tensor<1x8960xf32>
    %2195 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%2194, %arg382 : tensor<1x8960xf32>, tensor<8960x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %2196 = tosa.reshape %2195, %13 : (tensor<1x1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %2197 = tosa.add %2175, %2196 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %2198 = tensor.empty() : tensor<1x1x1536xf32>
    %2199 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2197 : tensor<1x1x1536xf32>) outs(%2198 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2290 = math.fpowi %in, %c2_i32 : f32, i32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1536xf32>
    %2200 = tosa.reduce_sum %2199 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %2201 = tosa.mul %2200, %0, %15 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1xf32>
    %2202 = tosa.add %2201, %14 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %2203 = tosa.rsqrt %2202 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %2204 = tosa.mul %2197, %2203, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %2205 = tosa.reshape %arg383, %13 : (tensor<1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %2206 = tosa.mul %2205, %2204, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %2207 = tosa.reshape %2206, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %2208 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%2207, %arg385 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %2209 = tosa.reshape %arg384, %12 : (tensor<1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %2210 = tosa.add %2209, %2208 : (tensor<1x1536xf32>, tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %2211 = tosa.reshape %2210, %11 : (tensor<1x1536xf32>, !tosa.shape<4>) -> tensor<1x12x1x128xf32>
    %2212 = tosa.reshape %2206, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %2213 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%2212, %arg387 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_8 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %2214 = tosa.reshape %arg386, %10 : (tensor<256xf32>, !tosa.shape<2>) -> tensor<1x256xf32>
    %2215 = tosa.add %2214, %2213 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %2216 = tosa.reshape %2215, %9 : (tensor<1x256xf32>, !tosa.shape<4>) -> tensor<1x2x1x128xf32>
    %2217 = tosa.reshape %2206, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %2218 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%2217, %arg389 : tensor<1x1536xf32>, tensor<1536x256xf32>) outs(%cst_8 : tensor<1x256xf32>) -> tensor<1x256xf32>
    %2219 = tosa.reshape %arg388, %10 : (tensor<256xf32>, !tosa.shape<2>) -> tensor<1x256xf32>
    %2220 = tosa.add %2219, %2218 : (tensor<1x256xf32>, tensor<1x256xf32>) -> tensor<1x256xf32>
    %2221 = tosa.reshape %2220, %9 : (tensor<1x256xf32>, !tosa.shape<4>) -> tensor<1x2x1x128xf32>
    %2222 = tosa.reshape %36, %8 : (tensor<1x1x128xf32>, !tosa.shape<4>) -> tensor<1x1x1x128xf32>
    %2223 = tosa.reshape %37, %8 : (tensor<1x1x128xf32>, !tosa.shape<4>) -> tensor<1x1x1x128xf32>
    %2224 = tosa.mul %2211, %2222, %15 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x12x1x128xf32>
    %extracted_slice_304 = tensor.extract_slice %2211[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %extracted_slice_305 = tensor.extract_slice %2211[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x128xf32> to tensor<1x12x1x64xf32>
    %2225 = tosa.negate %extracted_slice_305, %19, %19 : (tensor<1x12x1x64xf32>, tensor<1xf32>, tensor<1xf32>) -> tensor<1x12x1x64xf32>
    %2226 = tensor.empty() : tensor<1x12x1x128xf32>
    %inserted_slice_306 = tensor.insert_slice %2225 into %2226[0, 0, 0, 0] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %inserted_slice_307 = tensor.insert_slice %extracted_slice_304 into %inserted_slice_306[0, 0, 0, 64] [1, 12, 1, 64] [1, 1, 1, 1] : tensor<1x12x1x64xf32> into tensor<1x12x1x128xf32>
    %2227 = tosa.mul %inserted_slice_307, %2223, %15 : (tensor<1x12x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x12x1x128xf32>
    %2228 = tosa.add %2224, %2227 : (tensor<1x12x1x128xf32>, tensor<1x12x1x128xf32>) -> tensor<1x12x1x128xf32>
    %2229 = tosa.mul %2216, %2222, %15 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x2x1x128xf32>
    %extracted_slice_308 = tensor.extract_slice %2216[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %extracted_slice_309 = tensor.extract_slice %2216[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x128xf32> to tensor<1x2x1x64xf32>
    %2230 = tosa.negate %extracted_slice_309, %19, %19 : (tensor<1x2x1x64xf32>, tensor<1xf32>, tensor<1xf32>) -> tensor<1x2x1x64xf32>
    %2231 = tensor.empty() : tensor<1x2x1x128xf32>
    %inserted_slice_310 = tensor.insert_slice %2230 into %2231[0, 0, 0, 0] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %inserted_slice_311 = tensor.insert_slice %extracted_slice_308 into %inserted_slice_310[0, 0, 0, 64] [1, 2, 1, 64] [1, 1, 1, 1] : tensor<1x2x1x64xf32> into tensor<1x2x1x128xf32>
    %2232 = tosa.mul %inserted_slice_311, %2223, %15 : (tensor<1x2x1x128xf32>, tensor<1x1x1x128xf32>, tensor<1xi8>) -> tensor<1x2x1x128xf32>
    %2233 = tosa.add %2229, %2232 : (tensor<1x2x1x128xf32>, tensor<1x2x1x128xf32>) -> tensor<1x2x1x128xf32>
    %2234 = bufferization.to_buffer %arg390 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %2235 = tosa.reshape %arg3, %7 : (tensor<1xi64>, !tosa.shape<4>) -> tensor<1x1x1x1xi64>
    %2236 = tosa.add %2235, %6 : (tensor<1x1x1x1xi64>, tensor<1x2x1x128xi64>) -> tensor<1x2x1x128xi64>
    %2237 = bufferization.to_buffer %2236 : tensor<1x2x1x128xi64> to memref<1x2x1x128xi64>
    %2238 = bufferization.to_buffer %2233 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    scf.for %arg399 = %c0 to %c1 step %c1 {
      scf.for %arg400 = %c0 to %c2 step %c1 {
        scf.for %arg401 = %c0 to %c1 step %c1 {
          scf.for %arg402 = %c0 to %c128 step %c1 {
            %2290 = memref.load %2238[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            %2291 = memref.load %2237[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xi64>
            %2292 = arith.index_cast %2291 : i64 to index
            memref.store %2290, %2234[%arg399, %arg400, %2292, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %2239 = bufferization.to_tensor %2234 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %2240 = bufferization.to_buffer %arg391 : tensor<1x2x1024x128xf32> to memref<1x2x1024x128xf32>
    %2241 = tosa.reshape %arg3, %7 : (tensor<1xi64>, !tosa.shape<4>) -> tensor<1x1x1x1xi64>
    %2242 = tosa.add %2241, %6 : (tensor<1x1x1x1xi64>, tensor<1x2x1x128xi64>) -> tensor<1x2x1x128xi64>
    %2243 = bufferization.to_buffer %2242 : tensor<1x2x1x128xi64> to memref<1x2x1x128xi64>
    %2244 = bufferization.to_buffer %2221 : tensor<1x2x1x128xf32> to memref<1x2x1x128xf32>
    scf.for %arg399 = %c0 to %c1 step %c1 {
      scf.for %arg400 = %c0 to %c2 step %c1 {
        scf.for %arg401 = %c0 to %c1 step %c1 {
          scf.for %arg402 = %c0 to %c128 step %c1 {
            %2290 = memref.load %2244[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xf32>
            %2291 = memref.load %2243[%arg399, %arg400, %arg401, %arg402] : memref<1x2x1x128xi64>
            %2292 = arith.index_cast %2291 : i64 to index
            memref.store %2290, %2240[%arg399, %arg400, %2292, %arg402] : memref<1x2x1024x128xf32>
          }
        }
      }
    }
    %2245 = bufferization.to_tensor %2240 restrict : memref<1x2x1024x128xf32> to tensor<1x2x1024x128xf32>
    %2246 = tosa.reshape %28, %5 : (tensor<1x1024xi1>, !tosa.shape<4>) -> tensor<1x1x1x1024xi1>
    %2247 = tensor.empty() : tensor<1x1x1x1024xf32>
    %2248 = linalg.generic {indexing_maps = [#map1, #map1, #map1, #map1], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2246, %cst_1, %cst_0 : tensor<1x1x1x1024xi1>, tensor<1x1x1x1024xf32>, tensor<1x1x1x1024xf32>) outs(%2247 : tensor<1x1x1x1024xf32>) {
    ^bb0(%in: i1, %in_315: f32, %in_316: f32, %out: f32):
      %2290 = arith.select %in, %in_315, %in_316 : f32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1x1024xf32>
    %2249 = bufferization.to_buffer %2228 : tensor<1x12x1x128xf32> to memref<1x12x1x128xf32>
    %2250 = bufferization.to_buffer %2248 : tensor<1x1x1x1024xf32> to memref<1x1x1x1024xf32>
    %alloc_312 = memref.alloc() : memref<1x12x1x128xf32>
    %alloc_313 = memref.alloc() : memref<1x12x1xf32>
    %alloc_314 = memref.alloc() : memref<128xf32>
    affine.for %arg399 = 0 to 1 {
      affine.for %arg400 = 0 to 12 {
        %2290 = arith.divsi %arg400, %c6 : index
        affine.for %arg401 = 0 to 1 {
          affine.for %arg402 = 0 to 128 {
            memref.store %cst_7, %alloc_314[%arg402] : memref<128xf32>
          }
          %2291:2 = affine.for %arg402 = 0 to 1024 iter_args(%arg403 = %cst_4, %arg404 = %cst_7) -> (f32, f32) {
            %2292 = affine.for %arg405 = 0 to 128 step 16 iter_args(%arg406 = %cst) -> (vector<16xf32>) {
              %2307 = vector.load %2249[%arg399, %arg400, %arg401, %arg405] : memref<1x12x1x128xf32>, vector<16xf32>
              %2308 = vector.load %2234[%arg399, %2290, %arg402, %arg405] : memref<1x2x1024x128xf32>, vector<16xf32>
              %2309 = vector.fma %2307, %2308, %arg406 : vector<16xf32>
              affine.yield %2309 : vector<16xf32>
            }
            %2293 = vector.reduction <add>, %2292 : vector<16xf32> into f32
            %2294 = arith.mulf %2293, %cst_5 : f32
            %2295 = memref.load %2250[%arg399, %c0, %arg401, %arg402] : memref<1x1x1x1024xf32>
            %2296 = arith.addf %2294, %2295 : f32
            %2297 = arith.cmpf ogt, %2296, %arg403 : f32
            %2298 = arith.select %2297, %2296, %arg403 : f32
            %2299 = arith.subf %arg403, %2296 : f32
            %2300 = math.exp %2299 : f32
            %2301 = arith.mulf %2300, %arg404 : f32
            %2302 = arith.addf %2301, %cst_6 : f32
            %2303 = arith.subf %2296, %arg403 : f32
            %2304 = math.exp %2303 : f32
            %2305 = arith.addf %arg404, %2304 : f32
            %2306 = arith.select %2297, %2302, %2305 : f32
            affine.for %arg405 = 0 to 128 {
              %2307 = memref.load %2240[%arg399, %2290, %arg402, %arg405] : memref<1x2x1024x128xf32>
              %2308 = memref.load %alloc_314[%arg405] : memref<128xf32>
              %2309 = arith.mulf %2308, %2300 : f32
              %2310 = arith.addf %2309, %2307 : f32
              %2311 = arith.mulf %2304, %2307 : f32
              %2312 = arith.addf %2311, %2308 : f32
              %2313 = arith.select %2297, %2310, %2312 : f32
              memref.store %2313, %alloc_314[%arg405] : memref<128xf32>
            }
            affine.yield %2298, %2306 : f32, f32
          }
          memref.store %2291#1, %alloc_313[%arg399, %arg400, %arg401] : memref<1x12x1xf32>
          affine.for %arg402 = 0 to 128 {
            %2292 = memref.load %alloc_314[%arg402] : memref<128xf32>
            %2293 = arith.divf %2292, %2291#1 : f32
            memref.store %2293, %alloc_312[%arg399, %arg400, %arg401, %arg402] : memref<1x12x1x128xf32>
          }
        }
      }
    }
    %2251 = bufferization.to_tensor %alloc_312 restrict : memref<1x12x1x128xf32> to tensor<1x12x1x128xf32>
    %2252 = tosa.reshape %2251, %12 : (tensor<1x12x1x128xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %2253 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%2252, %arg392 : tensor<1x1536xf32>, tensor<1536x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %2254 = tosa.reshape %2253, %13 : (tensor<1x1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %2255 = tosa.add %2197, %2254 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %2256 = tensor.empty() : tensor<1x1x1536xf32>
    %2257 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2255 : tensor<1x1x1536xf32>) outs(%2256 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2290 = math.fpowi %in, %c2_i32 : f32, i32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1536xf32>
    %2258 = tosa.reduce_sum %2257 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %2259 = tosa.mul %2258, %0, %15 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1xf32>
    %2260 = tosa.add %2259, %14 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %2261 = tosa.rsqrt %2260 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %2262 = tosa.mul %2255, %2261, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %2263 = tosa.reshape %arg393, %13 : (tensor<1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %2264 = tosa.mul %2263, %2262, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %2265 = tosa.reshape %2264, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %2266 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%2265, %arg394 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_3 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %2267 = tosa.reshape %2266, %4 : (tensor<1x8960xf32>, !tosa.shape<3>) -> tensor<1x1x8960xf32>
    %2268 = tosa.sigmoid %2267 : (tensor<1x1x8960xf32>) -> tensor<1x1x8960xf32>
    %2269 = tosa.mul %2267, %2268, %15 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>, tensor<1xi8>) -> tensor<1x1x8960xf32>
    %2270 = tosa.reshape %2264, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %2271 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%2270, %arg395 : tensor<1x1536xf32>, tensor<1536x8960xf32>) outs(%cst_3 : tensor<1x8960xf32>) -> tensor<1x8960xf32>
    %2272 = tosa.reshape %2271, %4 : (tensor<1x8960xf32>, !tosa.shape<3>) -> tensor<1x1x8960xf32>
    %2273 = tosa.mul %2269, %2272, %15 : (tensor<1x1x8960xf32>, tensor<1x1x8960xf32>, tensor<1xi8>) -> tensor<1x1x8960xf32>
    %2274 = tosa.reshape %2273, %3 : (tensor<1x1x8960xf32>, !tosa.shape<2>) -> tensor<1x8960xf32>
    %2275 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%2274, %arg396 : tensor<1x8960xf32>, tensor<8960x1536xf32>) outs(%cst_9 : tensor<1x1536xf32>) -> tensor<1x1536xf32>
    %2276 = tosa.reshape %2275, %13 : (tensor<1x1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %2277 = tosa.add %2255, %2276 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>) -> tensor<1x1x1536xf32>
    %2278 = tensor.empty() : tensor<1x1x1536xf32>
    %2279 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2277 : tensor<1x1x1536xf32>) outs(%2278 : tensor<1x1x1536xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2290 = math.fpowi %in, %c2_i32 : f32, i32
      linalg.yield %2290 : f32
    } -> tensor<1x1x1536xf32>
    %2280 = tosa.reduce_sum %2279 {axis = 2 : i32} : (tensor<1x1x1536xf32>) -> tensor<1x1x1xf32>
    %2281 = tosa.mul %2280, %0, %15 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1xf32>
    %2282 = tosa.add %2281, %14 : (tensor<1x1x1xf32>, tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %2283 = tosa.rsqrt %2282 : (tensor<1x1x1xf32>) -> tensor<1x1x1xf32>
    %2284 = tosa.mul %2277, %2283, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %2285 = tosa.reshape %arg397, %13 : (tensor<1536xf32>, !tosa.shape<3>) -> tensor<1x1x1536xf32>
    %2286 = tosa.mul %2285, %2284, %15 : (tensor<1x1x1536xf32>, tensor<1x1x1536xf32>, tensor<1xi8>) -> tensor<1x1x1536xf32>
    %2287 = tosa.reshape %2286, %12 : (tensor<1x1x1536xf32>, !tosa.shape<2>) -> tensor<1x1536xf32>
    %2288 = linalg.matmul {cast = #linalg.type_fn<cast_signed>} ins(%2287, %arg398 : tensor<1x1536xf32>, tensor<1536x151936xf32>) outs(%cst_2 : tensor<1x151936xf32>) -> tensor<1x151936xf32>
    %2289 = tosa.reshape %2288, %2 : (tensor<1x151936xf32>, !tosa.shape<3>) -> tensor<1x1x151936xf32>
    return %79, %85, %159, %165, %239, %245, %319, %325, %399, %405, %479, %485, %559, %565, %639, %645, %719, %725, %799, %805, %879, %885, %959, %965, %1039, %1045, %1119, %1125, %1199, %1205, %1279, %1285, %1359, %1365, %1439, %1445, %1519, %1525, %1599, %1605, %1679, %1685, %1759, %1765, %1839, %1845, %1919, %1925, %1999, %2005, %2079, %2085, %2159, %2165, %2239, %2245, %2289 : tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x2x1024x128xf32>, tensor<1x1x151936xf32>
  }
}
